     1^I[37m// -------------------------------------------------------------------------------------------------[39;49;00m$
     2^I[37m// Rick, a Rust intercal compiler.  Save your souls![39;49;00m$
     3^I[37m//[39;49;00m$
     4^I[37m// Copyright (c) 2015 Georg Brandl[39;49;00m$
     5^I[37m//[39;49;00m$
     6^I[37m// This program is free software; you can redistribute it and/or modify it under the terms of the[39;49;00m$
     7^I[37m// GNU General Public License as published by the Free Software Foundation; either version 2 of the[39;49;00m$
     8^I[37m// License, or (at your option) any later version.[39;49;00m$
     9^I[37m//[39;49;00m$
    10^I[37m// This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without[39;49;00m$
    11^I[37m// even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[39;49;00m$
    12^I[37m// General Public License for more details.[39;49;00m$
    13^I[37m//[39;49;00m$
    14^I[37m// You should have received a copy of the GNU General Public License along with this program;[39;49;00m$
    15^I[37m// if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.[39;49;00m$
    16^I[37m// -------------------------------------------------------------------------------------------------[39;49;00m$
    17^I[37m[39;49;00m$
    18^I[33m/// Interprets INTERCAL source.[39;49;00m$
    19^I[33m///[39;49;00m$
    20^I[33m/// The evaluator is used when rick is called with `-i`, or when the compiler generates[39;49;00m$
    21^I[33m/// the output while compiling (in the constant-output case).[39;49;00m$
    22^I[37m[39;49;00m$
    23^I[34muse[39;49;00m[37m [39;49;00mstd::fmt::{[37m [39;49;00mDebug,[37m [39;49;00mDisplay[37m [39;49;00m};[37m[39;49;00m$
    24^I[34muse[39;49;00m[37m [39;49;00mstd::io::Write;[37m[39;49;00m$
    25^I[34muse[39;49;00m[37m [39;49;00mstd::[36mu16[39;49;00m;[37m[39;49;00m$
    26^I[37m[39;49;00m$
    27^I[34muse[39;49;00m[37m [39;49;00merr::{[37m [39;49;00mRes,[37m [39;49;00mIE123,[37m [39;49;00mIE129,[37m [39;49;00mIE252,[37m [39;49;00mIE275,[37m [39;49;00mIE555,[37m [39;49;00mIE633,[37m [39;49;00mIE774,[37m [39;49;00mIE994[37m [39;49;00m};[37m[39;49;00m$
    28^I[34muse[39;49;00m[37m [39;49;00mast::{[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mProgram,[37m [39;49;00mStmt,[37m [39;49;00mStmtBody,[37m [39;49;00mComeFrom,[37m [39;49;00mExpr,[37m [39;49;00mVar,[37m [39;49;00mVType[37m [39;49;00m};[37m[39;49;00m$
    29^I[34muse[39;49;00m[37m [39;49;00mstdops::{[37m [39;49;00mBind,[37m [39;49;00mArray,[37m [39;49;00mwrite_number,[37m [39;49;00mread_number,[37m [39;49;00mcheck_chance,[37m [39;49;00mcheck_ovf,[37m [39;49;00mpop_jumps,[37m[39;49;00m$
    30^I[37m              [39;49;00mget_random_seed,[37m [39;49;00mmingle,[37m [39;49;00mselect,[37m [39;49;00mand_16,[37m [39;49;00mand_32,[37m [39;49;00mor_16,[37m [39;49;00mor_32,[37m [39;49;00mxor_16,[37m [39;49;00mxor_32[37m [39;49;00m};[37m[39;49;00m$
    31^I[37m[39;49;00m$
    32^I[37m[39;49;00m$
    33^I[33m/// Represents a value (either 16-bit or 32-bit) at runtime.[39;49;00m$
    34^I[36m#[[39;49;00m[36mderive(Clone, PartialEq, Eq, Debug)[39;49;00m[36m][39;49;00m[37m[39;49;00m$
    35^I[34mpub[39;49;00m[37m [39;49;00m[34menum[39;49;00m [04m[32mVal[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    36^I[37m    [39;49;00mI16([36mu16[39;49;00m),[37m[39;49;00m$
    37^I[37m    [39;49;00mI32([36mu32[39;49;00m),[37m[39;49;00m$
    38^I}[37m[39;49;00m$
    39^I[37m[39;49;00m$
    40^I[34mimpl[39;49;00m[37m [39;49;00mVal[37m [39;49;00m{[37m[39;49;00m$
    41^I[37m    [39;49;00m[33m/// Cast as a 16-bit value; returns an error if 32-bit and too big.[39;49;00m$
    42^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32mas_u16[39;49;00m(&[36mself[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<[36mu16[39;49;00m>[37m [39;49;00m{[37m[39;49;00m$
    43^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*[36mself[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    44^I[37m            [39;49;00mVal::I16(v)[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(v),[37m[39;49;00m$
    45^I[37m            [39;49;00mVal::I32(v)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
    46^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00mv[37m [39;49;00m>[37m [39;49;00m([36mu16[39;49;00m::MAX[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
    47^I[37m                    [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE275.err();[37m[39;49;00m$
    48^I[37m                [39;49;00m}[37m[39;49;00m$
    49^I[37m                [39;49;00m[36mOk[39;49;00m(v[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)[37m[39;49;00m$
    50^I[37m            [39;49;00m}[37m[39;49;00m$
    51^I[37m        [39;49;00m}[37m[39;49;00m$
    52^I[37m    [39;49;00m}[37m[39;49;00m$
    53^I[37m[39;49;00m$
    54^I[37m    [39;49;00m[33m/// Cast as a 32-bit value; always succeeds.[39;49;00m$
    55^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32mas_u32[39;49;00m(&[36mself[39;49;00m)[37m [39;49;00m-> [36mu32[39;49;00m {[37m[39;49;00m$
    56^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*[36mself[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    57^I[37m            [39;49;00mVal::I16(v)[37m [39;49;00m=>[37m [39;49;00mv[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m,[37m[39;49;00m$
    58^I[37m            [39;49;00mVal::I32(v)[37m [39;49;00m=>[37m [39;49;00mv[37m[39;49;00m$
    59^I[37m        [39;49;00m}[37m[39;49;00m$
    60^I[37m    [39;49;00m}[37m[39;49;00m$
    61^I[37m[39;49;00m$
    62^I[37m    [39;49;00m[33m/// Cast as an usize value; always succeeds.[39;49;00m$
    63^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32mas_usize[39;49;00m(&[36mself[39;49;00m)[37m [39;49;00m-> [36musize[39;49;00m {[37m[39;49;00m$
    64^I[37m        [39;49;00m[36mself[39;49;00m.as_u32()[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m[37m[39;49;00m$
    65^I[37m    [39;49;00m}[37m[39;49;00m$
    66^I[37m[39;49;00m$
    67^I[37m    [39;49;00m[33m/// Create from a 32-bit value; will select the smallest possible type.[39;49;00m$
    68^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32mfrom_u32[39;49;00m(v: [36mu32[39;49;00m)[37m [39;49;00m-> [04m[32mVal[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    69^I[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00mv[37m [39;49;00m&[37m [39;49;00m[34m0xFFFF[39;49;00m[37m [39;49;00m==[37m [39;49;00mv[37m [39;49;00m{[37m[39;49;00m$
    70^I[37m            [39;49;00mVal::I16(v[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)[37m[39;49;00m$
    71^I[37m        [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    72^I[37m            [39;49;00mVal::I32(v)[37m[39;49;00m$
    73^I[37m        [39;49;00m}[37m[39;49;00m$
    74^I[37m    [39;49;00m}[37m[39;49;00m$
    75^I}[37m[39;49;00m$
    76^I[37m[39;49;00m$
    77^I[33m/// The state of the interpreter's evaluator.[39;49;00m$
    78^I[34mpub[39;49;00m[37m [39;49;00m[34mstruct[39;49;00m [04m[32mEval[39;49;00m<'[36ma[39;49;00m>[37m [39;49;00m{[37m[39;49;00m$
    79^I[37m    [39;49;00m[33m/// Program to execute.[39;49;00m$
    80^I[37m    [39;49;00mprogram: [34m&[39;49;00m'[36ma[39;49;00m [04m[32mProgram[39;49;00m,[37m[39;49;00m$
    81^I[37m    [39;49;00m[33m/// Stream to use for printing output.[39;49;00m$
    82^I[37m    [39;49;00mstdout: [34m&[39;49;00m'[36ma[39;49;00m [04m[32mmut[39;49;00m[37m [39;49;00mWrite,[37m[39;49;00m$
    83^I[37m    [39;49;00m[33m/// Whether to print debugging output during execution.[39;49;00m$
    84^I[37m    [39;49;00mdebug: [36mbool[39;49;00m,[37m[39;49;00m$
    85^I[37m    [39;49;00m[33m/// Variable bindings for the four types of variables.[39;49;00m$
    86^I[37m    [39;49;00mspot: [36mVec[39;49;00m<Bind<[36mu16[39;49;00m>>,[37m[39;49;00m$
    87^I[37m    [39;49;00mtwospot: [36mVec[39;49;00m<Bind<[36mu32[39;49;00m>>,[37m[39;49;00m$
    88^I[37m    [39;49;00mtail: [36mVec[39;49;00m<Bind<Array<[36mu16[39;49;00m>>>,[37m[39;49;00m$
    89^I[37m    [39;49;00mhybrid: [36mVec[39;49;00m<Bind<Array<[36mu32[39;49;00m>>>,[37m[39;49;00m$
    90^I[37m    [39;49;00m[33m/// The infamous NEXT stack, capable of holding 80 elements.[39;49;00m$
    91^I[37m    [39;49;00mjumps: [36mVec[39;49;00m<ast::LogLine>,[37m[39;49;00m$
    92^I[37m    [39;49;00m[33m/// Abstain counter for each statement.[39;49;00m$
    93^I[37m    [39;49;00mabstain: [36mVec[39;49;00m<[36mu32[39;49;00m>,[37m[39;49;00m$
    94^I[37m    [39;49;00m[33m/// Binary I/O "tape" state.[39;49;00m$
    95^I[37m    [39;49;00mlast_in: [36mu8[39;49;00m,[37m[39;49;00m$
    96^I[37m    [39;49;00mlast_out: [36mu8[39;49;00m,[37m[39;49;00m$
    97^I[37m    [39;49;00m[33m/// Random number generator state.[39;49;00m$
    98^I[37m    [39;49;00mrand_st: [36mu32[39;49;00m,[37m[39;49;00m$
    99^I[37m    [39;49;00m[33m/// Counts the number of executed statements.[39;49;00m$
   100^I[37m    [39;49;00mstmt_ctr: [36musize[39;49;00m,[37m[39;49;00m$
   101^I}[37m[39;49;00m$
   102^I[37m[39;49;00m$
   103^I[33m/// Represents the control flow effect of an executed statement.[39;49;00m$
   104^I[34menum[39;49;00m [04m[32mStmtRes[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   105^I[37m    [39;49;00m[33m/// normal execution, next statement[39;49;00m$
   106^I[37m    [39;49;00mNext,[37m[39;49;00m$
   107^I[37m    [39;49;00m[33m/// jump around, from DO ... NEXT[39;49;00m$
   108^I[37m    [39;49;00mJump([36musize[39;49;00m),[37m[39;49;00m$
   109^I[37m    [39;49;00m[33m/// jump back, from RESUME[39;49;00m$
   110^I[37m    [39;49;00mBack([36musize[39;49;00m),[37m[39;49;00m$
   111^I[37m    [39;49;00m[33m/// start from the first statement, from TRY AGAIN[39;49;00m$
   112^I[37m    [39;49;00mFromTop,[37m[39;49;00m$
   113^I[37m    [39;49;00m[33m/// end the program, from GIVE UP[39;49;00m$
   114^I[37m    [39;49;00mEnd,[37m[39;49;00m$
   115^I}[37m[39;49;00m$
   116^I[37m[39;49;00m$
   117^I[34mimpl[39;49;00m<'[36ma[39;49;00m>[37m [39;49;00mEval<'[36ma[39;49;00m>[37m [39;49;00m{[37m[39;49;00m$
   118^I[37m    [39;49;00m[33m/// Construct a new evaluator.[39;49;00m$
   119^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32mnew[39;49;00m(program: [34m&[39;49;00m'[36ma[39;49;00m [04m[32mProgram[39;49;00m,[37m [39;49;00mstdout: [34m&[39;49;00m'[36ma[39;49;00m [04m[32mmut[39;49;00m[37m [39;49;00mWrite,[37m [39;49;00mdebug: [36mbool[39;49;00m,[37m[39;49;00m$
   120^I[37m               [39;49;00mrandom: [36mbool[39;49;00m)[37m [39;49;00m-> [04m[32mEval[39;49;00m<'[36ma[39;49;00m>[37m [39;49;00m{[37m[39;49;00m$
   121^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mabs[37m [39;49;00m=[37m [39;49;00mprogram.stmts.iter().map(|stmt|[37m [39;49;00mstmt.props.disabled[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m).collect();[37m[39;49;00m$
   122^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mnvars[37m [39;49;00m=[37m [39;49;00m(program.var_info.[34m0.[39;49;00mlen(),[37m[39;49;00m$
   123^I[37m                     [39;49;00mprogram.var_info.[34m1.[39;49;00mlen(),[37m[39;49;00m$
   124^I[37m                     [39;49;00mprogram.var_info.[34m2.[39;49;00mlen(),[37m[39;49;00m$
   125^I[37m                     [39;49;00mprogram.var_info.[34m3.[39;49;00mlen());[37m[39;49;00m$
   126^I[37m        [39;49;00mEval[37m [39;49;00m{[37m[39;49;00m$
   127^I[37m            [39;49;00mprogram:  [04m[32mprogram[39;49;00m,[37m[39;49;00m$
   128^I[37m            [39;49;00mstdout:   [04m[32mstdout[39;49;00m,[37m[39;49;00m$
   129^I[37m            [39;49;00mdebug:    [04m[32mdebug[39;49;00m,[37m[39;49;00m$
   130^I[37m            [39;49;00mspot:     [04m[32mvec[39;49;00m![Bind::new([34m0[39;49;00m);[37m [39;49;00mnvars.[34m0[39;49;00m],[37m[39;49;00m$
   131^I[37m            [39;49;00mtwospot:  [04m[32mvec[39;49;00m![Bind::new([34m0[39;49;00m);[37m [39;49;00mnvars.[34m1[39;49;00m],[37m[39;49;00m$
   132^I[37m            [39;49;00mtail:     [04m[32mvec[39;49;00m![Bind::new(Array::empty());[37m [39;49;00mnvars.[34m2[39;49;00m],[37m[39;49;00m$
   133^I[37m            [39;49;00mhybrid:   [04m[32mvec[39;49;00m![Bind::new(Array::empty());[37m [39;49;00mnvars.[34m3[39;49;00m],[37m[39;49;00m$
   134^I[37m            [39;49;00mjumps:    [36mVec[39;49;00m::with_capacity([34m80[39;49;00m),[37m[39;49;00m$
   135^I[37m            [39;49;00mrand_st:  [04m[32mif[39;49;00m[37m [39;49;00mrandom[37m [39;49;00m{[37m [39;49;00mget_random_seed()[37m [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m},[37m[39;49;00m$
   136^I[37m            [39;49;00mabstain:  [04m[32mabs[39;49;00m,[37m[39;49;00m$
   137^I[37m            [39;49;00mlast_in:  [34m0[39;49;00m,[37m[39;49;00m$
   138^I[37m            [39;49;00mlast_out: [34m0[39;49;00m,[37m[39;49;00m$
   139^I[37m            [39;49;00mstmt_ctr: [34m0[39;49;00m,[37m[39;49;00m$
   140^I[37m        [39;49;00m}[37m[39;49;00m$
   141^I[37m    [39;49;00m}[37m[39;49;00m$
   142^I[37m[39;49;00m$
   143^I[37m    [39;49;00m[33m/// Interpret the program.  Returns either the number of executed statements,[39;49;00m$
   144^I[37m    [39;49;00m[33m/// or an error (RtError).[39;49;00m$
   145^I[37m    [39;49;00m[34mpub[39;49;00m[37m [39;49;00m[34mfn[39;49;00m [32meval[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<[36musize[39;49;00m>[37m [39;49;00m{[37m[39;49;00m$
   146^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[34mmut[39;49;00m[37m [39;49;00mpctr[37m [39;49;00m=[37m [39;49;00m[34m0[39;49;00m;[37m  [39;49;00m[37m// index of current statement[39;49;00m$
   147^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mprogram[37m [39;49;00m=[37m [39;49;00m[36mself[39;49;00m.program.clone();[37m[39;49;00m$
   148^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mnstmts[37m [39;49;00m=[37m [39;49;00mprogram.stmts.len();[37m[39;49;00m$
   149^I[37m        [39;49;00m[34mloop[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   150^I[37m            [39;49;00m[37m// check for falling off the end[39;49;00m$
   151^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00mpctr[37m [39;49;00m>=[37m [39;49;00mnstmts[37m [39;49;00m{[37m[39;49;00m$
   152^I[37m                [39;49;00m[37m// if the last statement was a TRY AGAIN, falling off the end is fine[39;49;00m$
   153^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00mStmtBody::TryAgain[37m [39;49;00m=[37m [39;49;00mprogram.stmts[program.stmts.len()[37m [39;49;00m-[37m [39;49;00m[34m1[39;49;00m].body[37m [39;49;00m{[37m[39;49;00m$
   154^I[37m                    [39;49;00m[34mbreak[39;49;00m;[37m[39;49;00m$
   155^I[37m                [39;49;00m}[37m[39;49;00m$
   156^I[37m                [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE633.err();[37m[39;49;00m$
   157^I[37m            [39;49;00m}[37m[39;49;00m$
   158^I[37m            [39;49;00m[36mself[39;49;00m.stmt_ctr[37m [39;49;00m+=[37m [39;49;00m[34m1[39;49;00m;[37m[39;49;00m$
   159^I[37m            [39;49;00m[34mlet[39;49;00m[37m [39;49;00mstmt[37m [39;49;00m=[37m [39;49;00m&program.stmts[pctr];[37m[39;49;00m$
   160^I[37m            [39;49;00m[37m// execute statement if not abstained[39;49;00m$
   161^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.abstain[pctr][37m [39;49;00m==[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   162^I[37m                [39;49;00m[37m// check execution chance[39;49;00m$
   163^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00m(passed,[37m [39;49;00mrand_st)[37m [39;49;00m=[37m [39;49;00mcheck_chance(stmt.props.chance,[37m [39;49;00m[36mself[39;49;00m.rand_st);[37m[39;49;00m$
   164^I[37m                [39;49;00m[36mself[39;49;00m.rand_st[37m [39;49;00m=[37m [39;49;00mrand_st;[37m[39;49;00m$
   165^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00mpassed[37m [39;49;00m{[37m[39;49;00m$
   166^I[37m                    [39;49;00m[37m// try to eval this statement[39;49;00m$
   167^I[37m                    [39;49;00m[34mlet[39;49;00m[37m [39;49;00mres[37m [39;49;00m=[37m [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m[36mself[39;49;00m.eval_stmt(stmt)[37m [39;49;00m{[37m[39;49;00m$
   168^I[37m                        [39;49;00m[37m// on error, set the correct line number and bubble up[39;49;00m$
   169^I[37m                        [39;49;00m[36mErr[39;49;00m([34mmut[39;49;00m[37m [39;49;00merr)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   170^I[37m                            [39;49;00merr.set_line(stmt.props.onthewayto);[37m[39;49;00m$
   171^I[37m                            [39;49;00m[37m// special treatment for NEXT[39;49;00m$
   172^I[37m                            [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00mStmtBody::DoNext(n)[37m [39;49;00m=[37m [39;49;00mstmt.body[37m [39;49;00m{[37m[39;49;00m$
   173^I[37m                                [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[36mSome[39;49;00m(i)[37m [39;49;00m=[37m [39;49;00mprogram.labels.get(&n)[37m [39;49;00m{[37m[39;49;00m$
   174^I[37m                                    [39;49;00merr.set_line(program.stmts[*i[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m].props.srcline);[37m[39;49;00m$
   175^I[37m                                [39;49;00m}[37m[39;49;00m$
   176^I[37m                            [39;49;00m}[37m[39;49;00m$
   177^I[37m                            [39;49;00m[34mreturn[39;49;00m[37m [39;49;00m[36mErr[39;49;00m(err);[37m[39;49;00m$
   178^I[37m                        [39;49;00m}[37m[39;49;00m$
   179^I[37m                        [39;49;00m[36mOk[39;49;00m(res)[37m  [39;49;00m=>[37m [39;49;00mres[37m[39;49;00m$
   180^I[37m                    [39;49;00m};[37m[39;49;00m$
   181^I[37m                    [39;49;00m[37m// handle control flow effects[39;49;00m$
   182^I[37m                    [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mres[37m [39;49;00m{[37m[39;49;00m$
   183^I[37m                        [39;49;00mStmtRes::Next[37m    [39;49;00m=>[37m [39;49;00m{[37m [39;49;00m}[37m[39;49;00m$
   184^I[37m                        [39;49;00mStmtRes::Jump(n)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   185^I[37m                            [39;49;00m[36mself[39;49;00m.jumps.push(pctr[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m);[37m  [39;49;00m[37m// push the line with the NEXT[39;49;00m$
   186^I[37m                            [39;49;00mpctr[37m [39;49;00m=[37m [39;49;00mn;[37m[39;49;00m$
   187^I[37m                            [39;49;00m[34mcontinue[39;49;00m;[37m  [39;49;00m[37m// do not increment or check for COME FROMs[39;49;00m$
   188^I[37m                        [39;49;00m}[37m[39;49;00m$
   189^I[37m                        [39;49;00mStmtRes::Back(n)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   190^I[37m                            [39;49;00mpctr[37m [39;49;00m=[37m [39;49;00mn;[37m  [39;49;00m[37m// will be incremented below after COME FROM check[39;49;00m$
   191^I[37m                        [39;49;00m}[37m[39;49;00m$
   192^I[37m                        [39;49;00mStmtRes::FromTop[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   193^I[37m                            [39;49;00mpctr[37m [39;49;00m=[37m [39;49;00m[34m0[39;49;00m;[37m  [39;49;00m[37m// start from the beginning, do not push any stack[39;49;00m$
   194^I[37m                            [39;49;00m[34mcontinue[39;49;00m;[37m[39;49;00m$
   195^I[37m                        [39;49;00m}[37m[39;49;00m$
   196^I[37m                        [39;49;00mStmtRes::End[37m     [39;49;00m=>[37m [39;49;00m[34mbreak[39;49;00m,[37m[39;49;00m$
   197^I[37m                    [39;49;00m}[37m[39;49;00m$
   198^I[37m                [39;49;00m}[37m[39;49;00m$
   199^I[37m            [39;49;00m}[37m[39;49;00m$
   200^I[37m            [39;49;00m[37m// if we are on the line with the compiler bug, error out[39;49;00m$
   201^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00mpctr[37m [39;49;00m==[37m [39;49;00m[36mself[39;49;00m.program.bugline[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   202^I[37m                [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE774.err_with([36mNone[39;49;00m,[37m [39;49;00mstmt.props.onthewayto);[37m[39;49;00m$
   203^I[37m            [39;49;00m}[37m[39;49;00m$
   204^I[37m            [39;49;00m[37m// try to determine if we have to go to a COME FROM statement[39;49;00m$
   205^I[37m            [39;49;00m[37m// (note: in general, program.stmts[pctr] != stmt)[39;49;00m$
   206^I[37m            [39;49;00m[37m//[39;49;00m$
   207^I[37m            [39;49;00m[37m// the static COME FROM is always a possibility[39;49;00m$
   208^I[37m            [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[34mmut[39;49;00m[37m [39;49;00mmaybe_next[37m [39;49;00m=[37m [39;49;00mprogram.stmts[pctr].comefrom;[37m[39;49;00m$
   209^I[37m            [39;49;00m[37m// the complicated case: evaluate all computed-come-from expressions[39;49;00m$
   210^I[37m            [39;49;00m[34mlet[39;49;00m[37m [39;49;00mmy_label[37m [39;49;00m=[37m [39;49;00mprogram.stmts[pctr].props.label;[37m[39;49;00m$
   211^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00mprogram.uses_complex_comefrom[37m [39;49;00m&&[37m [39;49;00mmy_label[37m [39;49;00m>[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   212^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00m(i,[37m [39;49;00mstmt)[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mprogram.stmts.iter().enumerate()[37m [39;49;00m{[37m[39;49;00m$
   213^I[37m                    [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00mStmtBody::ComeFrom(ComeFrom::Expr([34mref[39;49;00m[37m [39;49;00me))[37m [39;49;00m=[37m [39;49;00mstmt.body[37m [39;49;00m{[37m[39;49;00m$
   214^I[37m                        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(e)).as_u16());[37m[39;49;00m$
   215^I[37m                        [39;49;00m[34mif[39;49;00m[37m [39;49;00mv[37m [39;49;00m==[37m [39;49;00mmy_label[37m [39;49;00m{[37m[39;49;00m$
   216^I[37m                            [39;49;00m[37m// as soon as we have multiple candidates, we can bail out[39;49;00m$
   217^I[37m                            [39;49;00m[34mif[39;49;00m[37m [39;49;00mmaybe_next.is_some()[37m [39;49;00m{[37m[39;49;00m$
   218^I[37m                                [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE555.err();[37m[39;49;00m$
   219^I[37m                            [39;49;00m}[37m[39;49;00m$
   220^I[37m                            [39;49;00mmaybe_next[37m [39;49;00m=[37m [39;49;00m[36mSome[39;49;00m(i[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m);[37m[39;49;00m$
   221^I[37m                        [39;49;00m}[37m[39;49;00m$
   222^I[37m                    [39;49;00m}[37m[39;49;00m$
   223^I[37m                [39;49;00m}[37m[39;49;00m$
   224^I[37m            [39;49;00m}[37m[39;49;00m$
   225^I[37m            [39;49;00m[37m// check for COME FROMs from this line[39;49;00m$
   226^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[36mSome[39;49;00m(next)[37m [39;49;00m=[37m [39;49;00mmaybe_next[37m [39;49;00m{[37m[39;49;00m$
   227^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mnext[37m [39;49;00m=[37m [39;49;00mnext[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m;[37m[39;49;00m$
   228^I[37m                [39;49;00m[37m// check for abstained COME FROM[39;49;00m$
   229^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.abstain[next][37m [39;49;00m==[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   230^I[37m                    [39;49;00m[37m// the COME FROM can also have a % chance[39;49;00m$
   231^I[37m                    [39;49;00m[34mlet[39;49;00m[37m [39;49;00m(passed,[37m [39;49;00mrand_st)[37m [39;49;00m=[37m [39;49;00mcheck_chance(program.stmts[next].props.chance,[37m[39;49;00m$
   232^I[37m                                                         [39;49;00m[36mself[39;49;00m.rand_st);[37m[39;49;00m$
   233^I[37m                    [39;49;00m[36mself[39;49;00m.rand_st[37m [39;49;00m=[37m [39;49;00mrand_st;[37m[39;49;00m$
   234^I[37m                    [39;49;00m[34mif[39;49;00m[37m [39;49;00mpassed[37m [39;49;00m{[37m[39;49;00m$
   235^I[37m                        [39;49;00mpctr[37m [39;49;00m=[37m [39;49;00mnext;[37m[39;49;00m$
   236^I[37m                        [39;49;00m[34mcontinue[39;49;00m;[37m[39;49;00m$
   237^I[37m                    [39;49;00m}[37m[39;49;00m$
   238^I[37m                [39;49;00m}[37m[39;49;00m$
   239^I[37m            [39;49;00m}[37m[39;49;00m$
   240^I[37m            [39;49;00m[37m// no COME FROM, normal execution[39;49;00m$
   241^I[37m            [39;49;00mpctr[37m [39;49;00m+=[37m [39;49;00m[34m1[39;49;00m;[37m[39;49;00m$
   242^I[37m        [39;49;00m}[37m[39;49;00m$
   243^I[37m        [39;49;00m[36mOk[39;49;00m([36mself[39;49;00m.stmt_ctr)[37m[39;49;00m$
   244^I[37m    [39;49;00m}[37m[39;49;00m$
   245^I[37m[39;49;00m$
   246^I[37m    [39;49;00m[33m/// Interpret a single statement.[39;49;00m$
   247^I[37m    [39;49;00m[34mfn[39;49;00m [32meval_stmt[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mstmt: [34m&[39;49;00m[04m[32mStmt[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<StmtRes>[37m [39;49;00m{[37m[39;49;00m$
   248^I[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.debug[37m [39;49;00m{[37m[39;49;00m$
   249^I[37m            [39;49;00m[32mprintln![39;49;00m([33m"[39;49;00m[33m\n[39;49;00m[33mExecuting Stmt #{} (state before following)[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[36mself[39;49;00m.stmt_ctr);[37m[39;49;00m$
   250^I[37m            [39;49;00m[36mself[39;49;00m.dump_state();[37m[39;49;00m$
   251^I[37m            [39;49;00m[32mprintln![39;49;00m([33m"[39;49;00m[33m{}[39;49;00m[33m"[39;49;00m,[37m [39;49;00mstmt);[37m[39;49;00m$
   252^I[37m        [39;49;00m}[37m[39;49;00m$
   253^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mstmt.body[37m [39;49;00m{[37m[39;49;00m$
   254^I[37m            [39;49;00mStmtBody::Calc([34mref[39;49;00m[37m [39;49;00mvar,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mexpr)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   255^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mval[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(expr));[37m[39;49;00m$
   256^I[37m                [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.assign(var,[37m [39;49;00mval));[37m[39;49;00m$
   257^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   258^I[37m            [39;49;00m}[37m[39;49;00m$
   259^I[37m            [39;49;00mStmtBody::Dim([34mref[39;49;00m[37m [39;49;00mvar,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mexprs)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   260^I[37m                [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.array_dim(var,[37m [39;49;00mexprs));[37m[39;49;00m$
   261^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   262^I[37m            [39;49;00m}[37m[39;49;00m$
   263^I[37m            [39;49;00mStmtBody::DoNext(n)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   264^I[37m                [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m[36mself[39;49;00m.program.labels.get(&n)[37m [39;49;00m{[37m[39;49;00m$
   265^I[37m                    [39;49;00m[37m// too many jumps on stack already?[39;49;00m$
   266^I[37m                    [39;49;00m[36mSome[39;49;00m(_)[37m [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.jumps.len()[37m [39;49;00m>=[37m [39;49;00m[34m80[39;49;00m[37m [39;49;00m=>[37m [39;49;00mIE123.err(),[37m[39;49;00m$
   267^I[37m                    [39;49;00m[36mSome[39;49;00m(i)[37m                           [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(StmtRes::Jump(*i[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m)),[37m[39;49;00m$
   268^I[37m                    [39;49;00m[36mNone[39;49;00m[37m                              [39;49;00m=>[37m [39;49;00mIE129.err(),[37m[39;49;00m$
   269^I[37m                [39;49;00m}[37m[39;49;00m$
   270^I[37m            [39;49;00m}[37m[39;49;00m$
   271^I[37m            [39;49;00mStmtBody::ComeFrom(_)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   272^I[37m                [39;49;00m[37m// nothing to do here at runtime[39;49;00m$
   273^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   274^I[37m            [39;49;00m}[37m[39;49;00m$
   275^I[37m            [39;49;00mStmtBody::Resume([34mref[39;49;00m[37m [39;49;00mexpr)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   276^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mn[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(expr)).as_u32();[37m[39;49;00m$
   277^I[37m                [39;49;00m[37m// this expect() is safe: if the third arg is true, there will[39;49;00m$
   278^I[37m                [39;49;00m[37m// be no Ok(None) returns[39;49;00m$
   279^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mnext[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!(pop_jumps(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m.jumps,[37m [39;49;00mn,[37m [39;49;00m[34mtrue[39;49;00m,[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m$
   280^I[37m                    [39;49;00m.expect([33m"[39;49;00m[33mhttps://xkcd.com/378/ ?![39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   281^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Back(next[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m))[37m[39;49;00m$
   282^I[37m            [39;49;00m}[37m[39;49;00m$
   283^I[37m            [39;49;00mStmtBody::Forget([34mref[39;49;00m[37m [39;49;00mexpr)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   284^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mn[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(expr)).as_u32();[37m[39;49;00m$
   285^I[37m                [39;49;00m[34mtry[39;49;00m!(pop_jumps(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m.jumps,[37m [39;49;00mn,[37m [39;49;00m[34mfalse[39;49;00m,[37m [39;49;00m[34m0[39;49;00m));[37m[39;49;00m$
   286^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   287^I[37m            [39;49;00m}[37m[39;49;00m$
   288^I[37m            [39;49;00mStmtBody::Ignore([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   289^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   290^I[37m                    [39;49;00m[36mself[39;49;00m.set_rw(var,[37m [39;49;00m[34mfalse[39;49;00m);[37m[39;49;00m$
   291^I[37m                [39;49;00m}[37m[39;49;00m$
   292^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   293^I[37m            [39;49;00m}[37m[39;49;00m$
   294^I[37m            [39;49;00mStmtBody::Remember([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   295^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   296^I[37m                    [39;49;00m[36mself[39;49;00m.set_rw(var,[37m [39;49;00m[34mtrue[39;49;00m);[37m[39;49;00m$
   297^I[37m                [39;49;00m}[37m[39;49;00m$
   298^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   299^I[37m            [39;49;00m}[37m[39;49;00m$
   300^I[37m            [39;49;00mStmtBody::Stash([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   301^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   302^I[37m                    [39;49;00m[36mself[39;49;00m.stash(var);[37m[39;49;00m$
   303^I[37m                [39;49;00m}[37m[39;49;00m$
   304^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   305^I[37m            [39;49;00m}[37m[39;49;00m$
   306^I[37m            [39;49;00mStmtBody::Retrieve([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   307^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   308^I[37m                    [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.retrieve(var));[37m[39;49;00m$
   309^I[37m                [39;49;00m}[37m[39;49;00m$
   310^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   311^I[37m            [39;49;00m}[37m[39;49;00m$
   312^I[37m            [39;49;00mStmtBody::Abstain([34mref[39;49;00m[37m [39;49;00mexpr,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwhats)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   313^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mf: [36mBox[39;49;00m<[36mFn[39;49;00m([36mu32[39;49;00m)[37m [39;49;00m-> [36mu32[39;49;00m>[37m [39;49;00m=[37m [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[36mSome[39;49;00m([34mref[39;49;00m[37m [39;49;00me)[37m [39;49;00m=[37m [39;49;00m*expr[37m [39;49;00m{[37m[39;49;00m$
   314^I[37m                    [39;49;00m[34mlet[39;49;00m[37m [39;49;00mn[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(e)).as_u32();[37m[39;49;00m$
   315^I[37m                    [39;49;00m[34mbox[39;49;00m[37m [39;49;00m[34mmove[39;49;00m[37m [39;49;00m|v: [36mu32[39;49;00m|[37m [39;49;00mv.saturating_add(n)[37m[39;49;00m$
   316^I[37m                [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   317^I[37m                    [39;49;00m[34mbox[39;49;00m[37m [39;49;00m|_|[37m [39;49;00m[34m1[39;49;00m[37m[39;49;00m$
   318^I[37m                [39;49;00m};[37m[39;49;00m$
   319^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mwhat[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mwhats[37m [39;49;00m{[37m[39;49;00m$
   320^I[37m                    [39;49;00m[36mself[39;49;00m.abstain(what,[37m [39;49;00m&*f);[37m[39;49;00m$
   321^I[37m                [39;49;00m}[37m[39;49;00m$
   322^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   323^I[37m            [39;49;00m}[37m[39;49;00m$
   324^I[37m            [39;49;00mStmtBody::Reinstate([34mref[39;49;00m[37m [39;49;00mwhats)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   325^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mwhat[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mwhats[37m [39;49;00m{[37m[39;49;00m$
   326^I[37m                    [39;49;00m[36mself[39;49;00m.abstain(what,[37m [39;49;00m&|v: [36mu32[39;49;00m|[37m [39;49;00mv.saturating_sub([34m1[39;49;00m));[37m[39;49;00m$
   327^I[37m                [39;49;00m}[37m[39;49;00m$
   328^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   329^I[37m            [39;49;00m}[37m[39;49;00m$
   330^I[37m            [39;49;00mStmtBody::ReadOut([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   331^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   332^I[37m                    [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   333^I[37m                        [39;49;00m[37m// read out whole array[39;49;00m$
   334^I[37m                        [39;49;00mExpr::Var([34mref[39;49;00m[37m [39;49;00mvar)[37m [39;49;00m[34mif[39;49;00m[37m [39;49;00mvar.is_dim()[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   335^I[37m                            [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.array_readout(var));[37m[39;49;00m$
   336^I[37m                        [39;49;00m}[37m[39;49;00m$
   337^I[37m                        [39;49;00m[37m// read out single var or array element[39;49;00m$
   338^I[37m                        [39;49;00mExpr::Var([34mref[39;49;00m[37m [39;49;00mvar)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   339^I[37m                            [39;49;00m[34mlet[39;49;00m[37m [39;49;00mvarval[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.lookup(var));[37m[39;49;00m$
   340^I[37m                            [39;49;00m[34mtry[39;49;00m!(write_number([36mself[39;49;00m.stdout,[37m [39;49;00mvarval.as_u32(),[37m [39;49;00m[34m0[39;49;00m));[37m[39;49;00m$
   341^I[37m                        [39;49;00m}[37m[39;49;00m$
   342^I[37m                        [39;49;00m[37m// read out constant[39;49;00m$
   343^I[37m                        [39;49;00mExpr::Num(_,[37m [39;49;00mv)[37m [39;49;00m=>[37m [39;49;00m[34mtry[39;49;00m!(write_number([36mself[39;49;00m.stdout,[37m [39;49;00mv,[37m [39;49;00m[34m0[39;49;00m)),[37m[39;49;00m$
   344^I[37m                        [39;49;00m[37m// others will not be generated[39;49;00m$
   345^I[37m                        [39;49;00m_[37m [39;49;00m=>[37m [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE994.err(),[37m[39;49;00m$
   346^I[37m                    [39;49;00m};[37m[39;49;00m$
   347^I[37m                [39;49;00m}[37m[39;49;00m$
   348^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   349^I[37m            [39;49;00m}[37m[39;49;00m$
   350^I[37m            [39;49;00mStmtBody::WriteIn([34mref[39;49;00m[37m [39;49;00mvars)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   351^I[37m                [39;49;00m[34mfor[39;49;00m[37m [39;49;00mvar[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvars[37m [39;49;00m{[37m[39;49;00m$
   352^I[37m                    [39;49;00m[34mif[39;49;00m[37m [39;49;00mvar.is_dim()[37m [39;49;00m{[37m[39;49;00m$
   353^I[37m                        [39;49;00m[37m// write in whole array[39;49;00m$
   354^I[37m                        [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.array_writein(var));[37m[39;49;00m$
   355^I[37m                    [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   356^I[37m                        [39;49;00m[37m// write in single var or array element[39;49;00m$
   357^I[37m                        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mn[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!(read_number([34m0[39;49;00m));[37m[39;49;00m$
   358^I[37m                        [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.assign(var,[37m [39;49;00mVal::from_u32(n)));[37m[39;49;00m$
   359^I[37m                    [39;49;00m}[37m[39;49;00m$
   360^I[37m                [39;49;00m}[37m[39;49;00m$
   361^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   362^I[37m            [39;49;00m}[37m[39;49;00m$
   363^I[37m            [39;49;00m[37m// this one is only generated by the constant-program optimizer[39;49;00m$
   364^I[37m            [39;49;00mStmtBody::Print([34mref[39;49;00m[37m [39;49;00ms)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   365^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00m[36mErr[39;49;00m(_)[37m [39;49;00m=[37m [39;49;00m[36mself[39;49;00m.stdout.write(&s)[37m [39;49;00m{[37m[39;49;00m$
   366^I[37m                    [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE252.err();[37m[39;49;00m$
   367^I[37m                [39;49;00m}[37m[39;49;00m$
   368^I[37m                [39;49;00m[36mOk[39;49;00m(StmtRes::Next)[37m[39;49;00m$
   369^I[37m            [39;49;00m}[37m[39;49;00m$
   370^I[37m            [39;49;00mStmtBody::TryAgain[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(StmtRes::FromTop),[37m[39;49;00m$
   371^I[37m            [39;49;00mStmtBody::GiveUp[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(StmtRes::End),[37m[39;49;00m$
   372^I[37m            [39;49;00mStmtBody::Error([34mref[39;49;00m[37m [39;49;00me)[37m [39;49;00m=>[37m [39;49;00m[36mErr[39;49;00m((*e).clone()),[37m[39;49;00m$
   373^I[37m        [39;49;00m}[37m[39;49;00m$
   374^I[37m    [39;49;00m}[37m[39;49;00m$
   375^I[37m[39;49;00m$
   376^I[37m    [39;49;00m[33m/// Evaluate an expression to a value.[39;49;00m$
   377^I[37m    [39;49;00m[34mfn[39;49;00m [32meval_expr[39;49;00m(&[36mself[39;49;00m,[37m [39;49;00mexpr: [34m&[39;49;00m[04m[32mExpr[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<Val>[37m [39;49;00m{[37m[39;49;00m$
   378^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*expr[37m [39;49;00m{[37m[39;49;00m$
   379^I[37m            [39;49;00mExpr::Num(vtype,[37m [39;49;00mv)[37m [39;49;00m=>[37m [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mvtype[37m [39;49;00m{[37m[39;49;00m$
   380^I[37m                [39;49;00mVType::I16[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I16(v[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)),[37m[39;49;00m$
   381^I[37m                [39;49;00mVType::I32[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I32(v)),[37m[39;49;00m$
   382^I[37m            [39;49;00m},[37m[39;49;00m$
   383^I[37m            [39;49;00mExpr::Var([34mref[39;49;00m[37m [39;49;00mvar)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.lookup(var),[37m[39;49;00m$
   384^I[37m            [39;49;00mExpr::Mingle([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   385^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx)).as_u32();[37m[39;49;00m$
   386^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx)).as_u32();[37m[39;49;00m$
   387^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!(check_ovf(v,[37m [39;49;00m[34m0[39;49;00m));[37m[39;49;00m$
   388^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!(check_ovf(w,[37m [39;49;00m[34m0[39;49;00m));[37m[39;49;00m$
   389^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(mingle(v,[37m [39;49;00mw)))[37m[39;49;00m$
   390^I[37m            [39;49;00m}[37m[39;49;00m$
   391^I[37m            [39;49;00mExpr::Select(vtype,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   392^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   393^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   394^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00mvtype[37m [39;49;00m==[37m [39;49;00mVType::I16[37m [39;49;00m{[37m[39;49;00m$
   395^I[37m                    [39;49;00m[36mOk[39;49;00m(Val::I16(select(v.as_u32(),[37m [39;49;00m[34mtry[39;49;00m!(w.as_u16())[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m)[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m))[37m[39;49;00m$
   396^I[37m                [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   397^I[37m                    [39;49;00m[36mOk[39;49;00m(Val::I32(select(v.as_u32(),[37m [39;49;00mw.as_u32())))[37m[39;49;00m$
   398^I[37m                [39;49;00m}[37m[39;49;00m$
   399^I[37m            [39;49;00m}[37m[39;49;00m$
   400^I[37m            [39;49;00mExpr::And(vtype,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mvx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   401^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   402^I[37m                [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mvtype[37m [39;49;00m{[37m[39;49;00m$
   403^I[37m                    [39;49;00mVType::I16[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I16(and_16([34mtry[39;49;00m!(v.as_u16())[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m)[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)),[37m[39;49;00m$
   404^I[37m                    [39;49;00mVType::I32[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I32(and_32(v.as_u32()))),[37m[39;49;00m$
   405^I[37m                [39;49;00m}[37m[39;49;00m$
   406^I[37m            [39;49;00m}[37m[39;49;00m$
   407^I[37m            [39;49;00mExpr::Or(vtype,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mvx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   408^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   409^I[37m                [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mvtype[37m [39;49;00m{[37m[39;49;00m$
   410^I[37m                    [39;49;00mVType::I16[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I16(or_16([34mtry[39;49;00m!(v.as_u16())[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m)[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)),[37m[39;49;00m$
   411^I[37m                    [39;49;00mVType::I32[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I32(or_32(v.as_u32()))),[37m[39;49;00m$
   412^I[37m                [39;49;00m}[37m[39;49;00m$
   413^I[37m            [39;49;00m}[37m[39;49;00m$
   414^I[37m            [39;49;00mExpr::Xor(vtype,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mvx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   415^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   416^I[37m                [39;49;00m[34mmatch[39;49;00m[37m [39;49;00mvtype[37m [39;49;00m{[37m[39;49;00m$
   417^I[37m                    [39;49;00mVType::I16[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I16(xor_16([34mtry[39;49;00m!(v.as_u16())[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m)[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu16[39;49;00m)),[37m[39;49;00m$
   418^I[37m                    [39;49;00mVType::I32[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I32(xor_32(v.as_u32()))),[37m[39;49;00m$
   419^I[37m                [39;49;00m}[37m[39;49;00m$
   420^I[37m            [39;49;00m}[37m[39;49;00m$
   421^I[37m            [39;49;00mExpr::RsNot([34mref[39;49;00m[37m [39;49;00mvx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   422^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   423^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(!v.as_u32()))[37m[39;49;00m$
   424^I[37m            [39;49;00m}[37m[39;49;00m$
   425^I[37m            [39;49;00mExpr::RsAnd([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   426^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   427^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   428^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m&[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   429^I[37m            [39;49;00m}[37m[39;49;00m$
   430^I[37m            [39;49;00mExpr::RsOr([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   431^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   432^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   433^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m|[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   434^I[37m            [39;49;00m}[37m[39;49;00m$
   435^I[37m            [39;49;00mExpr::RsXor([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   436^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   437^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   438^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m^[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   439^I[37m            [39;49;00m}[37m[39;49;00m$
   440^I[37m            [39;49;00mExpr::RsRshift([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   441^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   442^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   443^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m>>[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   444^I[37m            [39;49;00m}[37m[39;49;00m$
   445^I[37m            [39;49;00mExpr::RsLshift([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   446^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   447^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   448^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m<<[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   449^I[37m            [39;49;00m}[37m[39;49;00m$
   450^I[37m            [39;49;00m[37m// Expr::RsEqual(ref vx, ref wx) => {[39;49;00m$
   451^I[37m            [39;49;00m[37m//     let v = try!(self.eval_expr(vx));[39;49;00m$
   452^I[37m            [39;49;00m[37m//     let w = try!(self.eval_expr(wx));[39;49;00m$
   453^I[37m            [39;49;00m[37m//     Ok(Val::I32((v.as_u32() == w.as_u32()) as u32))[39;49;00m$
   454^I[37m            [39;49;00m[37m// }[39;49;00m$
   455^I[37m            [39;49;00mExpr::RsNotEqual([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   456^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   457^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   458^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32((v.as_u32()[37m [39;49;00m!=[37m [39;49;00mw.as_u32())[37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36mu32[39;49;00m))[37m[39;49;00m$
   459^I[37m            [39;49;00m}[37m[39;49;00m$
   460^I[37m            [39;49;00mExpr::RsPlus([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   461^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   462^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   463^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m+[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   464^I[37m            [39;49;00m}[37m[39;49;00m$
   465^I[37m            [39;49;00mExpr::RsMinus([34mref[39;49;00m[37m [39;49;00mvx,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00mwx)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   466^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mv[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(vx));[37m[39;49;00m$
   467^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00mw[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_expr(wx));[37m[39;49;00m$
   468^I[37m                [39;49;00m[36mOk[39;49;00m(Val::I32(v.as_u32()[37m [39;49;00m-[37m [39;49;00mw.as_u32()))[37m[39;49;00m$
   469^I[37m            [39;49;00m}[37m[39;49;00m$
   470^I[37m        [39;49;00m}[37m[39;49;00m$
   471^I[37m    [39;49;00m}[37m[39;49;00m$
   472^I[37m[39;49;00m$
   473^I[37m    [39;49;00m[36m#[[39;49;00m[36minline[39;49;00m[36m][39;49;00m[37m[39;49;00m$
   474^I[37m    [39;49;00m[34mfn[39;49;00m [32meval_subs[39;49;00m(&[36mself[39;49;00m,[37m [39;49;00msubs: [34m&[39;49;00m[36mVec[39;49;00m<Expr>)[37m [39;49;00m-> [04m[32mRes[39;49;00m<[36mVec[39;49;00m<[36musize[39;49;00m>>[37m [39;49;00m{[37m[39;49;00m$
   475^I[37m        [39;49;00msubs.iter().map(|v|[37m [39;49;00m[36mself[39;49;00m.eval_expr(v).map(|w|[37m [39;49;00mw.as_usize())).collect()[37m[39;49;00m$
   476^I[37m    [39;49;00m}[37m[39;49;00m$
   477^I[37m[39;49;00m$
   478^I[37m    [39;49;00m[33m/// Dimension an array.[39;49;00m$
   479^I[37m    [39;49;00m[34mfn[39;49;00m [32marray_dim[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m,[37m [39;49;00mdims: [34m&[39;49;00m[36mVec[39;49;00m<Expr>)[37m [39;49;00m-> [04m[32mRes[39;49;00m<()>[37m [39;49;00m{[37m[39;49;00m$
   480^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mdims[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_subs(dims));[37m[39;49;00m$
   481^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   482^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].dimension(dims,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   483^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].dimension(dims,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   484^I[37m            [39;49;00m_[37m [39;49;00m=>[37m [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE994.err(),[37m[39;49;00m$
   485^I[37m        [39;49;00m}[37m[39;49;00m$
   486^I[37m    [39;49;00m}[37m[39;49;00m$
   487^I[37m[39;49;00m$
   488^I[37m    [39;49;00m[33m/// Assign to a variable.[39;49;00m$
   489^I[37m    [39;49;00m[34mfn[39;49;00m [32massign[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m,[37m [39;49;00mval: [04m[32mVal[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<()>[37m [39;49;00m{[37m[39;49;00m$
   490^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   491^I[37m            [39;49;00mVar::I16(n)[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m([36mself[39;49;00m.spot[n].assign([34mtry[39;49;00m!(val.as_u16()))),[37m[39;49;00m$
   492^I[37m            [39;49;00mVar::I32(n)[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m([36mself[39;49;00m.twospot[n].assign(val.as_u32())),[37m[39;49;00m$
   493^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00msubs)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   494^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00msubs[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_subs(subs));[37m[39;49;00m$
   495^I[37m                [39;49;00m[36mself[39;49;00m.tail[n].set_md(subs,[37m [39;49;00m[34mtry[39;49;00m!(val.as_u16()),[37m [39;49;00m[34m0[39;49;00m)[37m[39;49;00m$
   496^I[37m            [39;49;00m}[37m[39;49;00m$
   497^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00msubs)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   498^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00msubs[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_subs(subs));[37m[39;49;00m$
   499^I[37m                [39;49;00m[36mself[39;49;00m.hybrid[n].set_md(subs,[37m [39;49;00mval.as_u32(),[37m [39;49;00m[34m0[39;49;00m)[37m[39;49;00m$
   500^I[37m            [39;49;00m}[37m[39;49;00m$
   501^I[37m        [39;49;00m}[37m[39;49;00m$
   502^I[37m    [39;49;00m}[37m[39;49;00m$
   503^I[37m[39;49;00m$
   504^I[37m    [39;49;00m[33m/// Look up the value of a variable.[39;49;00m$
   505^I[37m    [39;49;00m[34mfn[39;49;00m [32mlookup[39;49;00m(&[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<Val>[37m [39;49;00m{[37m[39;49;00m$
   506^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   507^I[37m            [39;49;00mVar::I16(n)[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I16([36mself[39;49;00m.spot[n].val)),[37m[39;49;00m$
   508^I[37m            [39;49;00mVar::I32(n)[37m [39;49;00m=>[37m [39;49;00m[36mOk[39;49;00m(Val::I32([36mself[39;49;00m.twospot[n].val)),[37m[39;49;00m$
   509^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00msubs)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   510^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00msubs[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_subs(subs));[37m[39;49;00m$
   511^I[37m                [39;49;00m[36mself[39;49;00m.tail[n].get_md(subs,[37m [39;49;00m[34m0[39;49;00m).map(Val::I16)[37m[39;49;00m$
   512^I[37m            [39;49;00m}[37m[39;49;00m$
   513^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m[34mref[39;49;00m[37m [39;49;00msubs)[37m [39;49;00m=>[37m [39;49;00m{[37m[39;49;00m$
   514^I[37m                [39;49;00m[34mlet[39;49;00m[37m [39;49;00msubs[37m [39;49;00m=[37m [39;49;00m[34mtry[39;49;00m!([36mself[39;49;00m.eval_subs(subs));[37m[39;49;00m$
   515^I[37m                [39;49;00m[36mself[39;49;00m.hybrid[n].get_md(subs,[37m [39;49;00m[34m0[39;49;00m).map(Val::I32)[37m[39;49;00m$
   516^I[37m            [39;49;00m}[37m[39;49;00m$
   517^I[37m        [39;49;00m}[37m[39;49;00m$
   518^I[37m    [39;49;00m}[37m[39;49;00m$
   519^I[37m[39;49;00m$
   520^I[37m    [39;49;00m[33m/// Process a STASH statement.[39;49;00m$
   521^I[37m    [39;49;00m[34mfn[39;49;00m [32mstash[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   522^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   523^I[37m            [39;49;00mVar::I16(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.spot[n].stash(),[37m[39;49;00m$
   524^I[37m            [39;49;00mVar::I32(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.twospot[n].stash(),[37m[39;49;00m$
   525^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].stash(),[37m[39;49;00m$
   526^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].stash(),[37m[39;49;00m$
   527^I[37m        [39;49;00m}[37m[39;49;00m$
   528^I[37m    [39;49;00m}[37m[39;49;00m$
   529^I[37m[39;49;00m$
   530^I[37m    [39;49;00m[33m/// Process a RETRIEVE statement.[39;49;00m$
   531^I[37m    [39;49;00m[34mfn[39;49;00m [32mretrieve[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<()>[37m [39;49;00m{[37m[39;49;00m$
   532^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   533^I[37m            [39;49;00mVar::I16(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.spot[n].retrieve([34m0[39;49;00m),[37m[39;49;00m$
   534^I[37m            [39;49;00mVar::I32(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.twospot[n].retrieve([34m0[39;49;00m),[37m[39;49;00m$
   535^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].retrieve([34m0[39;49;00m),[37m[39;49;00m$
   536^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].retrieve([34m0[39;49;00m),[37m[39;49;00m$
   537^I[37m        [39;49;00m}[37m[39;49;00m$
   538^I[37m    [39;49;00m}[37m[39;49;00m$
   539^I[37m[39;49;00m$
   540^I[37m    [39;49;00m[33m/// Process an IGNORE or REMEMBER statement.  Cannot fail.[39;49;00m$
   541^I[37m    [39;49;00m[34mfn[39;49;00m [32mset_rw[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m,[37m [39;49;00mrw: [36mbool[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   542^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   543^I[37m            [39;49;00mVar::I16(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.spot[n].rw[37m [39;49;00m=[37m [39;49;00mrw,[37m[39;49;00m$
   544^I[37m            [39;49;00mVar::I32(n)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.twospot[n].rw[37m [39;49;00m=[37m [39;49;00mrw,[37m[39;49;00m$
   545^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].rw[37m [39;49;00m=[37m [39;49;00mrw,[37m[39;49;00m$
   546^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].rw[37m [39;49;00m=[37m [39;49;00mrw,[37m[39;49;00m$
   547^I[37m        [39;49;00m}[37m[39;49;00m$
   548^I[37m    [39;49;00m}[37m[39;49;00m$
   549^I[37m[39;49;00m$
   550^I[37m    [39;49;00m[33m/// P()rocess an ABSTAIN or REINSTATE statement.  Cannot fail.[39;49;00m$
   551^I[37m    [39;49;00m[34mfn[39;49;00m [32mabstain[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mwhat: [34m&[39;49;00m[04m[32mast[39;49;00m::Abstain,[37m [39;49;00mf: [34m&[39;49;00m[36mFn[39;49;00m([36mu32[39;49;00m)[37m [39;49;00m-> [36mu32[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   552^I[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m[34mlet[39;49;00m[37m [39;49;00m&ast::Abstain::Label(lbl)[37m [39;49;00m=[37m [39;49;00mwhat[37m [39;49;00m{[37m[39;49;00m$
   553^I[37m            [39;49;00m[34mlet[39;49;00m[37m [39;49;00midx[37m [39;49;00m=[37m [39;49;00m[36mself[39;49;00m.program.labels[&lbl][37m [39;49;00m[34mas[39;49;00m[37m [39;49;00m[36musize[39;49;00m;[37m[39;49;00m$
   554^I[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.program.stmts[idx].body[37m [39;49;00m!=[37m [39;49;00mStmtBody::GiveUp[37m [39;49;00m{[37m[39;49;00m$
   555^I[37m                [39;49;00m[36mself[39;49;00m.abstain[idx][37m [39;49;00m=[37m [39;49;00mf([36mself[39;49;00m.abstain[idx]);[37m[39;49;00m$
   556^I[37m            [39;49;00m}[37m[39;49;00m$
   557^I[37m        [39;49;00m}[37m [39;49;00m[34melse[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   558^I[37m            [39;49;00m[34mfor[39;49;00m[37m [39;49;00m(i,[37m [39;49;00mstype)[37m [39;49;00m[34min[39;49;00m[37m [39;49;00m[36mself[39;49;00m.program.stmt_types.iter().enumerate()[37m [39;49;00m{[37m[39;49;00m$
   559^I[37m                [39;49;00m[34mif[39;49;00m[37m [39;49;00mstype[37m [39;49;00m==[37m [39;49;00mwhat[37m [39;49;00m{[37m[39;49;00m$
   560^I[37m                    [39;49;00m[36mself[39;49;00m.abstain[i][37m [39;49;00m=[37m [39;49;00mf([36mself[39;49;00m.abstain[i]);[37m[39;49;00m$
   561^I[37m                [39;49;00m}[37m[39;49;00m$
   562^I[37m            [39;49;00m}[37m[39;49;00m$
   563^I[37m        [39;49;00m}[37m[39;49;00m$
   564^I[37m    [39;49;00m}[37m[39;49;00m$
   565^I[37m[39;49;00m$
   566^I[37m    [39;49;00m[33m/// Array readout helper.[39;49;00m$
   567^I[37m    [39;49;00m[34mfn[39;49;00m [32marray_readout[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<()>[37m [39;49;00m{[37m[39;49;00m$
   568^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mstate[37m [39;49;00m=[37m [39;49;00m&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m.last_out;[37m[39;49;00m$
   569^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   570^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].readout([36mself[39;49;00m.stdout,[37m [39;49;00mstate,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   571^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].readout([36mself[39;49;00m.stdout,[37m [39;49;00mstate,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   572^I[37m            [39;49;00m_[37m [39;49;00m=>[37m [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE994.err(),[37m[39;49;00m$
   573^I[37m        [39;49;00m}[37m[39;49;00m$
   574^I[37m    [39;49;00m}[37m[39;49;00m$
   575^I[37m[39;49;00m$
   576^I[37m    [39;49;00m[33m/// Array writein helper.[39;49;00m$
   577^I[37m    [39;49;00m[34mfn[39;49;00m [32marray_writein[39;49;00m(&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m,[37m [39;49;00mvar: [34m&[39;49;00m[04m[32mVar[39;49;00m)[37m [39;49;00m-> [04m[32mRes[39;49;00m<()>[37m [39;49;00m{[37m[39;49;00m$
   578^I[37m        [39;49;00m[34mlet[39;49;00m[37m [39;49;00mstate[37m [39;49;00m=[37m [39;49;00m&[34mmut[39;49;00m[37m [39;49;00m[36mself[39;49;00m.last_in;[37m[39;49;00m$
   579^I[37m        [39;49;00m[34mmatch[39;49;00m[37m [39;49;00m*var[37m [39;49;00m{[37m[39;49;00m$
   580^I[37m            [39;49;00mVar::A16(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.tail[n].writein(state,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   581^I[37m            [39;49;00mVar::A32(n,[37m [39;49;00m_)[37m [39;49;00m=>[37m [39;49;00m[36mself[39;49;00m.hybrid[n].writein(state,[37m [39;49;00m[34m0[39;49;00m),[37m[39;49;00m$
   582^I[37m            [39;49;00m_[37m [39;49;00m=>[37m [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mIE994.err(),[37m[39;49;00m$
   583^I[37m        [39;49;00m}[37m[39;49;00m$
   584^I[37m    [39;49;00m}[37m[39;49;00m$
   585^I[37m[39;49;00m$
   586^I[37m    [39;49;00m[33m/// Debug helpers.[39;49;00m$
   587^I[37m    [39;49;00m[34mfn[39;49;00m [32mdump_state[39;49;00m(&[36mself[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   588^I[37m        [39;49;00m[36mself[39;49;00m.dump_state_one(&[36mself[39;49;00m.spot,[37m [39;49;00m[33m"[39;49;00m[33m.[39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   589^I[37m        [39;49;00m[36mself[39;49;00m.dump_state_one(&[36mself[39;49;00m.twospot,[37m [39;49;00m[33m"[39;49;00m[33m:[39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   590^I[37m        [39;49;00m[36mself[39;49;00m.dump_state_one(&[36mself[39;49;00m.tail,[37m [39;49;00m[33m"[39;49;00m[33m,[39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   591^I[37m        [39;49;00m[36mself[39;49;00m.dump_state_one(&[36mself[39;49;00m.hybrid,[37m [39;49;00m[33m"[39;49;00m[33m;[39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   592^I[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m[36mself[39;49;00m.jumps.len()[37m [39;49;00m>[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   593^I[37m            [39;49;00m[32mprintln![39;49;00m([33m"[39;49;00m[33mNext stack: {:?}[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[36mself[39;49;00m.jumps);[37m[39;49;00m$
   594^I[37m        [39;49;00m}[37m[39;49;00m$
   595^I[37m        [39;49;00m[37m//println!("Abstained: {:?}", self.abstain);[39;49;00m$
   596^I[37m    [39;49;00m}[37m[39;49;00m$
   597^I[37m[39;49;00m$
   598^I[37m    [39;49;00m[34mfn[39;49;00m [32mdump_state_one[39;49;00m<T: [04m[32mDebug[39;49;00m[37m [39;49;00m+[37m [39;49;00mDisplay>(&[36mself[39;49;00m,[37m [39;49;00mvec: [34m&[39;49;00m[36mVec[39;49;00m<Bind<T>>,[37m [39;49;00msigil: [34m&[39;49;00m[36mstr[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   599^I[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00mvec.len()[37m [39;49;00m>[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
   600^I[37m            [39;49;00m[34mfor[39;49;00m[37m [39;49;00m(i,[37m [39;49;00mv)[37m [39;49;00m[34min[39;49;00m[37m [39;49;00mvec.iter().enumerate()[37m [39;49;00m{[37m[39;49;00m$
   601^I[37m                [39;49;00m[32mprint![39;49;00m([33m"[39;49;00m[33m{}{} = {}, [39;49;00m[33m"[39;49;00m,[37m [39;49;00msigil,[37m [39;49;00mi,[37m [39;49;00mv);[37m[39;49;00m$
   602^I[37m            [39;49;00m}[37m[39;49;00m$
   603^I[37m            [39;49;00m[32mprintln![39;49;00m([33m"[39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
   604^I[37m        [39;49;00m}[37m[39;49;00m$
   605^I[37m    [39;49;00m}[37m[39;49;00m$
   606^I}$
