     1^I<[94mhtml[39;49;00m>$
     2^I<[94mhead[39;49;00m>$
     3^I<[94mscript[39;49;00m>[37m[39;49;00m$
     4^I[37m    [39;49;00m[34mfunction[39;49;00m[37m [39;49;00minitCodeBlock(id);[37m [39;49;00m{[37m[39;49;00m$
     5^I[37m        [39;49;00m[34mvar[39;49;00m[37m [39;49;00mel[37m [39;49;00m=[37m [39;49;00m[36mdocument[39;49;00m.getElementById(id);[37m[39;49;00m$
     6^I[37m    [39;49;00m}[37m[39;49;00m$
     7^I</[94mscript[39;49;00m>$
     8^I<[94mstyle[39;49;00m>[37m[39;49;00m$
     9^I.[04m[32msyntax[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mborder[39;49;00m:[37m [39;49;00m[34m1[39;49;00m[36mpx[39;49;00m[37m [39;49;00m[34msolid[39;49;00m[37m [39;49;00m[34m#d0d0d0[39;49;00m;[37m [39;49;00m[34mbackground-color[39;49;00m:[37m [39;49;00m[34m#f0f0f0[39;49;00m;[37m[39;49;00m$
    10^I[37m          [39;49;00m[34mmargin-left[39;49;00m:[37m [39;49;00m[34m10[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-right[39;49;00m:[37m [39;49;00m[34m10[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    11^I[37m[39;49;00m$
    12^I.[04m[32msyntaxheader[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mmargin-top[39;49;00m:[37m [39;49;00m[34m15[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-bottom[39;49;00m:[37m [39;49;00m[34m0[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    13^I[37m                [39;49;00m[34mtext-align[39;49;00m:[37m [39;49;00m[34mright[39;49;00m;[37m [39;49;00m[34mfont-size[39;49;00m:[37m [39;49;00m[34m11[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    14^I[37m                [39;49;00m[34mborder-bottom[39;49;00m:[37m [39;49;00m[34m0[39;49;00m;[37m [39;49;00m[34mpadding[39;49;00m:[37m [39;49;00m[34m3[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    15^I[37m[39;49;00m$
    16^I.[04m[32mlinenos[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfloat[39;49;00m:[37m [39;49;00m[34mleft[39;49;00m;[37m [39;49;00m[34mdisplay[39;49;00m:[37m [39;49;00m[34mblock[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    17^I.[04m[32mlinenos[39;49;00m[37m [39;49;00m[94mpre[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mpadding-right[39;49;00m:[37m [39;49;00m[34m7[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mpadding-left[39;49;00m:[37m [39;49;00m[34m7[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    18^I[37m               [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#666[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    19^I[37m[39;49;00m$
    20^I[94mpre[39;49;00m.[04m[32msyntax[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mpadding[39;49;00m:[37m [39;49;00m[34m5[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-top[39;49;00m:[37m [39;49;00m[34m0[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    21^I[37m[39;49;00m$
    22^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcm[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#60a0b0[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m              [39;49;00m[37m/* comments */[39;49;00m[37m[39;49;00m$
    23^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcm-proc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mnormal[39;49;00m;[37m [39;49;00m}[37m          [39;49;00m[37m/* preproc */[39;49;00m[37m[39;49;00m$
    24^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mkw[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m               [39;49;00m[37m/* keywords */[39;49;00m[37m[39;49;00m$
    25^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mkw-pseudo[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mnormal[39;49;00m;[37m [39;49;00m}[37m               [39;49;00m[37m/* pseudo keywords */[39;49;00m[37m[39;49;00m$
    26^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mop[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#666666[39;49;00m;[37m [39;49;00m}[37m                                 [39;49;00m[37m/* operators */[39;49;00m[37m[39;49;00m$
    27^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mop-word[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m    [39;49;00m[37m/* word operators */[39;49;00m[37m[39;49;00m$
    28^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mbn[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m}[37m                                  [39;49;00m[37m/* builtins */[39;49;00m[37m[39;49;00m$
    29^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mfun[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#06287e[39;49;00m;[37m [39;49;00m}[37m                                [39;49;00m[37m/* func name */[39;49;00m[37m[39;49;00m$
    30^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcls[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#0e84b5[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* class names */[39;49;00m[37m[39;49;00m$
    31^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mexc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m}[37m                               [39;49;00m[37m/* exceptions */[39;49;00m[37m[39;49;00m$
    32^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mvar[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#bb60d5[39;49;00m;[37m [39;49;00m}[37m                                [39;49;00m[37m/* variables */[39;49;00m[37m[39;49;00m$
    33^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mconst[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#60add5[39;49;00m;[37m [39;49;00m}[37m                              [39;49;00m[37m/* constants */[39;49;00m[37m[39;49;00m$
    34^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mentity[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#d55537[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* entities */[39;49;00m[37m[39;49;00m$
    35^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mattr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m}[37m                              [39;49;00m[37m/* attributes */[39;49;00m[37m[39;49;00m$
    36^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mtag[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#062873[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m             [39;49;00m[37m/* tag names */[39;49;00m[37m[39;49;00m$
    37^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mdeco[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#555555[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* decorators */[39;49;00m[37m[39;49;00m$
    38^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m}[37m                                   [39;49;00m[37m/* strings */[39;49;00m[37m[39;49;00m$
    39^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-int[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#70a0d0[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m  [39;49;00m[37m/* interpolated str */[39;49;00m[37m[39;49;00m$
    40^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-esc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m        [39;49;00m[37m/* escaped str */[39;49;00m[37m[39;49;00m$
    41^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-re[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#235388[39;49;00m;[37m [39;49;00m}[37m                           [39;49;00m[37m/* regular expr */[39;49;00m[37m[39;49;00m$
    42^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-sym[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#517918[39;49;00m;[37m [39;49;00m}[37m                               [39;49;00m[37m/* symbols */[39;49;00m[37m[39;49;00m$
    43^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-oth[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#c65d09[39;49;00m;[37m [39;49;00m}[37m                         [39;49;00m[37m/* other strings */[39;49;00m[37m[39;49;00m$
    44^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mnb[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#40a070[39;49;00m;[37m [39;49;00m}[37m                                   [39;49;00m[37m/* numbers */[39;49;00m[37m[39;49;00m$
    45^I[37m[39;49;00m$
    46^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-hd[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mblue[39;49;00m;[37m [39;49;00m}[37m              [39;49;00m[37m/* headings */[39;49;00m[37m[39;49;00m$
    47^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-sh[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mpurple[39;49;00m;[37m [39;49;00m}[37m         [39;49;00m[37m/* subheadings */[39;49;00m[37m[39;49;00m$
    48^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-del[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mred[39;49;00m;[37m [39;49;00m}[37m                             [39;49;00m[37m/* deleted text */[39;49;00m[37m[39;49;00m$
    49^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-ins[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mgreen[39;49;00m;[37m [39;49;00m}[37m                          [39;49;00m[37m/* inserted text */[39;49;00m[37m[39;49;00m$
    50^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-em[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m                   [39;49;00m[37m/* emphasized text */[39;49;00m[37m[39;49;00m$
    51^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-sr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m                  [39;49;00m[37m/* strong emph. text */[39;49;00m[37m[39;49;00m$
    52^I[37m[39;49;00m$
    53^I.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32merr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mborder[39;49;00m:[37m [39;49;00m[34m1[39;49;00m[36mpx[39;49;00m[37m [39;49;00m[34msolid[39;49;00m[37m [39;49;00m[34mred[39;49;00m;[37m [39;49;00m}[37m                     [39;49;00m[37m/* parser errors */[39;49;00m[37m[39;49;00m$
    54^I</[94mstyle[39;49;00m>$
    55^I</[94mhead[39;49;00m>$
    56^I<[94mbody[39;49;00m>$
    57^I<[94mpre[39;49;00m [36mid[39;49;00m=[33m"code-block"[39;49;00m [36mclass[39;49;00m=[33m"syntax"[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># -*- coding: utf-8 -*-</[94mspan[39;49;00m>$
    58^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>$
    59^I    pocoo.pkg.core.acl$
    60^I    ~~~~~~~~~~~~~~~~~~$
    61^I$
    62^I    Pocoo ACL System.$
    63^I$
    64^I</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
    65^I$
    66^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.db</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>$
    67^I$
    68^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>$
    69^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Group</[94mspan[39;49;00m>$
    70^I$
    71^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.db</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>, \$
    72^I     <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_subjects</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_objects</[94mspan[39;49;00m>$
    73^I$
    74^I$
    75^I<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>AclManager</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
    76^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>$
    77^I    Manager object to manage ALCs.$
    78^I    </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
    79^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m>$
    80^I$
    81^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>$
    82^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m>$
    83^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>2</[94mspan[39;49;00m>$
    84^I$
    85^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>__init__</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>):$
    86^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>$
    87^I$
    88^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>$
    89^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>):$
    90^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
    91^I$
    92^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Group</[94mspan[39;49;00m>):$
    93^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>group</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
    94^I$
    95^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
    96^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>ValueError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>neither user or group specified</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
    97^I$
    98^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>allow</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>False</[94mspan[39;49;00m>):$
    99^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Allows the subject privilege on obj.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   100^I$
   101^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>+</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>bool</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m>))$
   102^I$
   103^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>default</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   104^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Sets the state for privilege on obj back to weak yes.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   105^I$
   106^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>)$
   107^I$
   108^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>deny</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>False</[94mspan[39;49;00m>):$
   109^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Denies the subject privilege on obj.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   110^I$
   111^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>bool</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m>))$
   112^I$
   113^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>can_access</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   114^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Checks if the current subject with the required privilege$
   115^I        somehow. Either directly or when the subject is a user and$
   116^I        one of its groups can access it.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   117^I$
   118^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m>#XXX: maybe this could be one big query instead of 4</[94mspan[39;49;00m>$
   119^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m>#XXX: this currently does not work correctly, therefore return True</[94mspan[39;49;00m>$
   120^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>True</[94mspan[39;49;00m>$
   121^I$
   122^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>)):$
   123^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>TypeError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>obj must be a forum, thread or site</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
   124^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>upper</[94mspan[39;49;00m>()$
   125^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>s</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_subject_join</[94mspan[39;49;00m>().<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>$
   126^I$
   127^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>):$
   128^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>$
   129^I$
   130^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>o</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>$
   131^I$
   132^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># self check</[94mspan[39;49;00m>$
   133^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   134^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   135^I$
   136^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>s</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   137^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   138^I$
   139^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   140^I            ))$
   141^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   142^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   143^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>):$
   144^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>$
   145^I$
   146^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>]$
   147^I$
   148^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># if the controlled subject is a user check all groups</[94mspan[39;49;00m>$
   149^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>):$
   150^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   151^I                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   152^I$
   153^I                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   154^I$
   155^I                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   156^I$
   157^I                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>)$
   158^I                ))$
   159^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>while</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>True</[94mspan[39;49;00m>:$
   160^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   161^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   162^I                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>break</[94mspan[39;49;00m>$
   163^I$
   164^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   165^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m>):$
   166^I                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>$
   167^I$
   168^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   169^I                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>$
   170^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>and</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>:$
   171^I                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>$
   172^I$
   173^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># check related objects</[94mspan[39;49;00m>$
   174^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>):$
   175^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>)$
   176^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>):$
   177^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>)$
   178^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   179^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>$
   180^I$
   181^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>)$
   182^I$
   183^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>):$
   184^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Helper functions for settings privileges.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   185^I$
   186^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>upper</[94mspan[39;49;00m>()$
   187^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   188^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_bootstrap</[94mspan[39;49;00m>()$
   189^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   190^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_bootstrap_object</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   191^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># special state &quot;0&quot; which means delete</[94mspan[39;49;00m>$
   192^I$
   193^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>:$
   194^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>p</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>], <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   195^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>delete</[94mspan[39;49;00m>($
   196^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>p</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   197^I$
   198^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   199^I$
   200^I                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>)$
   201^I            ))$
   202^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m>$
   203^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># touch privilege and check existing mapping</[94mspan[39;49;00m>$
   204^I$
   205^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_fetch_privilege</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   206^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   207^I            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   208^I$
   209^I            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   210^I$
   211^I            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>)$
   212^I        ))$
   213^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   214^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   215^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># this rule exists already</[94mspan[39;49;00m>$
   216^I$
   217^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>:$
   218^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m>$
   219^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># goddamn, same rule - different state, delete old first</[94mspan[39;49;00m>$
   220^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>)$
   221^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># insert new rule</[94mspan[39;49;00m>$
   222^I$
   223^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   224^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>,$
   225^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>,$
   226^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>,$
   227^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>$
   228^I$
   229^I        )$
   230^I$
   231^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_bootstrap</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   232^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>This method is automatically called when subject_id is$
   233^I        None and an subject_id is required.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   234^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_subjects</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   235^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>$
   236^I$
   237^I        )$
   238^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   239^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>save</[94mspan[39;49;00m>()$
   240^I$
   241^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_bootstrap_object</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   242^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Like _bootstrap but works for objects.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   243^I$
   244^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>objtype</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   245^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_objects</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   246^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>objtype</[94mspan[39;49;00m>$
   247^I$
   248^I        )$
   249^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   250^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>save</[94mspan[39;49;00m>()$
   251^I$
   252^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   253^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>):$
   254^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   255^I$
   256^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>):$
   257^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   258^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>:$
   259^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>site</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   260^I$
   261^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>TypeError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>obj isn</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-esc"[39;49;00m>\&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>t a forum or thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
   262^I$
   263^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_object_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   264^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns a subjoin for the object id.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   265^I$
   266^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   267^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   268^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>],$
   269^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum_id</[94mspan[39;49;00m>$
   270^I$
   271^I            )$
   272^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   273^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>],$
   274^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>post_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>post_id</[94mspan[39;49;00m>$
   275^I$
   276^I            )$
   277^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   278^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># XXX: it works ^^</[94mspan[39;49;00m>$
   279^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># i really want something like meta.select(&#39;0 as group_id&#39;)</[94mspan[39;49;00m>$
   280^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>Fake</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   281^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>n</[94mspan[39;49;00m>):$
   282^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>_C</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   283^I                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>c</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   284^I                            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>$
   285^I$
   286^I                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_C</[94mspan[39;49;00m>$
   287^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Fake</[94mspan[39;49;00m>()$
   288^I$
   289^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_subject_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   290^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns a subjoin for the subject id.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   291^I$
   292^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   293^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>],$
   294^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>$
   295^I$
   296^I            )$
   297^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>],$
   298^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>$
   299^I$
   300^I        )$
   301^I$
   302^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_fetch_privilege</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>):$
   303^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns the priv_id for the given privilege. If it$
   304^I        doesn</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-esc"[39;49;00m>\&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>t exist by now the system will create a new$
   305^I        privilege.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   306^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>],$
   307^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>$
   308^I$
   309^I        ))$
   310^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   311^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   312^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   313^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   314^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>$
   315^I$
   316^I        )$
   317^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   318^I$
   319^I    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>__repr__</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   320^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   321^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>$
   322^I$
   323^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   324^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>$
   325^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   326^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&lt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>:</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> inactive&gt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>%</[94mspan[39;49;00m> ($
   327^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__name__</[94mspan[39;49;00m>,$
   328^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>,$
   329^I                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m>$
   330^I$
   331^I            )$
   332^I        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&lt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>:</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> active as </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&gt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>%</[94mspan[39;49;00m> ($
   333^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__name__</[94mspan[39;49;00m>,$
   334^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>,$
   335^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m>,$
   336^I            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>$
   337^I$
   338^I        )$
