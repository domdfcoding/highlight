[37m;;;; TYPEP und Verwandtes[39;49;00m[37m[39;49;00m
[37m;;;; Michael Stoll, 21. 10. 1988[39;49;00m[37m[39;49;00m
[37m;;;; Bruno Haible, 10.6.1989[39;49;00m[37m[39;49;00m
[37m;;;; Sam Steingold 2000-2005[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;;; Datenstrukturen f√ºr TYPEP:[39;49;00m[37m[39;49;00m
[37m;;; - Ein Type-Specifier-Symbol hat auf seiner Propertyliste unter dem[39;49;00m[37m[39;49;00m
[37m;;;   Indikator SYS::TYPE-SYMBOL eine Funktion von einem Argument, die[39;49;00m[37m[39;49;00m
[37m;;;   testet, ob ein Objekt vom richtigen Typ ist.[39;49;00m[37m[39;49;00m
[37m;;; - Ein Symbol, das eine Type-Specifier-Liste beginnen kann, hat auf seiner[39;49;00m[37m[39;49;00m
[37m;;;   Propertyliste unter dem Indikator SYS::TYPE-LIST eine Funktion von[39;49;00m[37m[39;49;00m
[37m;;;   einem Argument f√ºr das zu testende Objekt und zus√§tzlichen Argumenten[39;49;00m[37m[39;49;00m
[37m;;;   f√ºr die Listenelemente.[39;49;00m[37m[39;49;00m
[37m;;; - Ein Symbol, das als Typmacro definiert wurde, hat auf seiner Property-[39;49;00m[37m[39;49;00m
[37m;;;   liste unter dem Indikator SYSTEM::DEFTYPE-EXPANDER den zugeh√∂rigen[39;49;00m[37m[39;49;00m
[37m;;;   Expander: eine Funktion, die den zu expandierenden Type-Specifier (eine[39;49;00m[37m[39;49;00m
[37m;;;   mindestens einelementige Liste) als Argument bekommt.[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36min-package[39;49;00m[37m [39;49;00m[33m"EXT"[39;49;00m)[37m[39;49;00m
([36mexport[39;49;00m[37m [39;49;00m'([31mtype-expand[39;49;00m))[37m[39;49;00m
([36min-package[39;49;00m[37m [39;49;00m[33m"SYSTEM"[39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m; vorl√§ufig, solange bis clos.lisp geladen wird:[39;49;00m[37m[39;49;00m
([34meval-when[39;49;00m[37m [39;49;00m([36meval[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mpredefun[39;49;00m[37m [39;49;00m[31mclos::built-in-class-p[39;49;00m[37m [39;49;00m([31mobject[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mobject[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
([36munless[39;49;00m[37m [39;49;00m([36mfboundp[39;49;00m[37m [39;49;00m[33m'clos::class-name[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mdefun[39;49;00m[37m [39;49;00m[31mclos::class-name[39;49;00m[37m [39;49;00m([31mc[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mc[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mtypespec-error[39;49;00m[37m [39;49;00m([31mfun[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m
[37m    [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: invalid type specification ~S"[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m[31mfun[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m
)[37m [39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m;; ============================================================================[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; return the CLOS class named by TYPESPEC or NIL[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mclos-class[39;49;00m[37m [39;49;00m([31mtypespec[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mcc[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)))[37m[39;49;00m
[37m    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m[31mcc[39;49;00m[37m [39;49;00m([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31mcc[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[31mcc[39;49;00m)[37m [39;49;00m[31mtypespec[39;49;00m))[37m[39;49;00m
[37m      [39;49;00m[31mcc[39;49;00m)))[37m[39;49;00m
[37m[39;49;00m
[37m;;; TYPEP, CLTL S. 72, S. 42-51[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[36mtypep[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menv[39;49;00m[37m [39;49;00m[34m&aux[39;49;00m[37m [39;49;00m[31mf[39;49;00m)[37m [39;49;00m[37m; x = Objekt, y = Typ[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menv[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m[39;49;00m
[37m    [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'DEFSTRUCT-DESCRIPTION[39;49;00m))[37m [39;49;00m([31mds-typep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mf[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([31mclos-class[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m[37m; It's not worth handling structure classes specially here.[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([31mclos::typep-class[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mf[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m    [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m       [39;49;00m([36mcond[39;49;00m[37m[39;49;00m
[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'SATISFIES[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m
[37m                [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to SATISFIES must be a symbol: ~S"[39;49;00m)[37m[39;49;00m
[37m                [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m([36msymbol-function[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'MEMBER[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mmember[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'EQL[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'NOT[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m         [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'AND[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mt[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'OR[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m         [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m [39;49;00m([36mapply[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m         [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m    [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([31mclos::typep-class[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m    [39;49;00m(([31mencodingp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([31mcharset-typep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
)[37m [39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; UPGRADED-ARRAY-ELEMENT-TYPE is a lattice homomorphism, see[39;49;00m[37m[39;49;00m
[37m;; ANSI CL 15.1.2.1.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[36mupgraded-array-element-type[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m[37m;; see array.d[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m
[37m    [39;49;00m(([31mBIT[39;49;00m)[37m [39;49;00m[33m'BIT[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m(([31mCHARACTER[39;49;00m)[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m(([31mT[39;49;00m)[37m [39;49;00m[33m'T[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m(([31mNIL[39;49;00m)[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([31mt[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m[33m'NIL[39;49;00m[37m[39;49;00m
[37m         [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([31msys::subtype-integer[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m[37m; Es gilt (or (null low) (subtypep type `(INTEGER ,low ,high)))[39;49;00m[37m[39;49;00m
[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mminusp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ml[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m               [39;49;00m[37m; Es gilt (subtypep type `(UNSIGNED-BYTE ,l))[39;49;00m[37m[39;49;00m
[37m               [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m [39;49;00m[33m'BIT[39;49;00m)[37m[39;49;00m
[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m2[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m4[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m4[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m8[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m8[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m16[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m16[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m32[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m32[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m[39;49;00m
[37m               [39;49;00m[33m'CHARACTER[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[33m'T[39;49;00m)))))))[37m[39;49;00m
[37m[39;49;00m
[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; UPGRADED-COMPLEX-PART-TYPE is a lattice homomorphism, see[39;49;00m[37m[39;49;00m
[37m;; HyperSpec/Body/fun_complex.html and HyperSpec/Body/syscla_complex.html,[39;49;00m[37m[39;49;00m
[37m;; and an idempotent. Therefore[39;49;00m[37m[39;49;00m
[37m;;   (subtypep (upgraded-complex-part-type T1) (upgraded-complex-part-type T2))[39;49;00m[37m[39;49;00m
[37m;; is equivalent to[39;49;00m[37m[39;49;00m
[37m;;   (subtypep T1 (upgraded-complex-part-type T2))[39;49;00m[37m[39;49;00m
[37m;; (Proof: Let U T be an abbreviation for (upgraded-complex-part-type T).[39;49;00m[37m[39;49;00m
[37m;;  If U T1 <= U T2, then T1 <= U T1 <= U T2.[39;49;00m[37m[39;49;00m
[37m;;  If T1 <= U T2, then by homomorphism U T1 <= U U T2 = U T2.)[39;49;00m[37m[39;49;00m
[37m;;[39;49;00m[37m[39;49;00m
[37m;; For _any_ CL implementation, you could define[39;49;00m[37m[39;49;00m
[37m;;   (defun upgraded-complex-part-type (type) 'REAL)[39;49;00m[37m[39;49;00m
[37m;; Likewise for _any_ CL implementation, you could define[39;49;00m[37m[39;49;00m
[37m;;   (defun upgraded-complex-part-type (type) type)[39;49;00m[37m[39;49;00m
[37m;; or - again for _any_ CL implementation:[39;49;00m[37m[39;49;00m
[37m;;   (defun upgraded-complex-part-type (type)[39;49;00m[37m[39;49;00m
[37m;;     (cond ((subtypep type 'NIL) 'NIL)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'SHORT-FLOAT) 'SHORT-FLOAT)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'SINGLE-FLOAT) 'SINGLE-FLOAT)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'DOUBLE-FLOAT) 'DOUBLE-FLOAT)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'LONG-FLOAT) 'LONG-FLOAT)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'RATIONAL) 'RATIONAL)[39;49;00m[37m[39;49;00m
[37m;;           ((subtypep type 'REAL) 'REAL)[39;49;00m[37m[39;49;00m
[37m;;           (t (error ...))))[39;49;00m[37m[39;49;00m
[37m;; The reason is that a complex number is immutable: no setters for the[39;49;00m[37m[39;49;00m
[37m;; realpart and imagpart exist.[39;49;00m[37m[39;49;00m
[37m;;[39;49;00m[37m[39;49;00m
[37m;; We choose the second implementation because it allows the most precise[39;49;00m[37m[39;49;00m
[37m;; type inference.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m[34mtype[39;49;00m[37m[39;49;00m
[37m    [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m
[37m      [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: type ~S is not a subtype of ~S"[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m[33m'upgraded-complex-part-type[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'real[39;49;00m)))[37m[39;49;00m
[37m[39;49;00m
[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; Macros for defining the various built-in "atomic type specifier"s and[39;49;00m[37m[39;49;00m
[37m;; "compound type specifier"s. The following macros add information for both[39;49;00m[37m[39;49;00m
[37m;; the TYPEP function above and the c-TYPEP in the compiler.[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m; Alist symbol -> funname, used by the compiler.[39;49;00m[37m[39;49;00m
([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist1[39;49;00m[37m [39;49;00m'())[37m[39;49;00m
[37m; Alist symbol -> lambdabody, used by the compiler.[39;49;00m[37m[39;49;00m
([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist2[39;49;00m[37m [39;49;00m'())[37m[39;49;00m
[37m; Alist symbol -> expander function, used by the compiler.[39;49;00m[37m[39;49;00m
([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist3[39;49;00m[37m [39;49;00m'())[37m[39;49;00m
[37m[39;49;00m
[37m; (def-atomic-type symbol function-name)[39;49;00m[37m[39;49;00m
[37m; defines an atomic type. The function-name designates a function taking one[39;49;00m[37m[39;49;00m
[37m; argument and returning a generalized boolean value. It can be either a[39;49;00m[37m[39;49;00m
[37m; symbol or a lambda expression.[39;49;00m[37m[39;49;00m
([36mdefmacro[39;49;00m[37m [39;49;00m[31mdef-atomic-type[39;49;00m[37m [39;49;00m([04m[32msymbol[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlambdap[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m [39;49;00m[33m'LAMBDA[39;49;00m))))[37m[39;49;00m
[37m    [39;49;00m`([31mPROGN[39;49;00m[37m[39;49;00m
[37m       [39;49;00m([31mSETF[39;49;00m[37m [39;49;00m([31mGET[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m,([34mif[39;49;00m[37m [39;49;00m[31mlambdap[39;49;00m[37m[39;49;00m
[37m                [39;49;00m`([31mFUNCTION[39;49;00m[37m [39;49;00m,([31mconcat-pnames[39;49;00m[37m [39;49;00m[33m"TYPE-SYMBOL-"[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m [39;49;00m,[31mfunname[39;49;00m)[37m[39;49;00m
[37m                [39;49;00m`([31mFUNCTION[39;49;00m[37m [39;49;00m,[31mfunname[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m,([34mif[39;49;00m[37m [39;49;00m[31mlambdap[39;49;00m[37m[39;49;00m
[37m          [39;49;00m`([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST2[39;49;00m[37m[39;49;00m
[37m                 [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST2[39;49;00m[37m [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m',[39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m))))[37m[39;49;00m
[37m           [39;49;00m)[37m[39;49;00m
[37m          [39;49;00m`([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST1[39;49;00m[37m[39;49;00m
[37m                 [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST1[39;49;00m[37m [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m',funname[39;49;00m)))[37m[39;49;00m
[37m           [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m
[37m     [39;49;00m)[37m[39;49;00m
)[37m [39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m; (def-compound-type symbol lambda-list (x) check-form typep-form c-typep-form)[39;49;00m[37m[39;49;00m
[37m; defines a compound type. The lambda-list is of the form (&optional ...)[39;49;00m[37m[39;49;00m
[37m; where the arguments come from the CDR of the type specifier.[39;49;00m[37m[39;49;00m
[37m; For typep-form, x is an object.[39;49;00m[37m[39;49;00m
[37m; For c-typep-form, x is a multiply evaluatable form (actually a gensym).[39;49;00m[37m[39;49;00m
[37m; check-form is a form performing error checking, may call `error'.[39;49;00m[37m[39;49;00m
[37m; typep-form should return a generalized boolean value.[39;49;00m[37m[39;49;00m
[37m; c-typep-form should produce a form returning a generalized boolean value.[39;49;00m[37m[39;49;00m
([36mdefmacro[39;49;00m[37m [39;49;00m[31mdef-compound-type[39;49;00m[37m [39;49;00m([04m[32msymbol[39;49;00m[37m [39;49;00m[31mlambdalist[39;49;00m[37m [39;49;00m([31mvar[39;49;00m)[37m [39;49;00m[31mcheck-form[39;49;00m[37m [39;49;00m[31mtypep-form[39;49;00m[37m [39;49;00m[31mc-typep-form[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mPROGN[39;49;00m[37m[39;49;00m
[37m     [39;49;00m([31mSETF[39;49;00m[37m [39;49;00m([31mGET[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([31mFUNCTION[39;49;00m[37m [39;49;00m,([31mconcat-pnames[39;49;00m[37m [39;49;00m[33m"TYPE-LIST-"[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mLAMBDA[39;49;00m[37m [39;49;00m(,[31mvar[39;49;00m[37m [39;49;00m,@[31mlambdalist[39;49;00m)[37m[39;49;00m
[37m               [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m[31mcheck-form[39;49;00m[37m[39;49;00m
[37m                   [39;49;00m`(([31mMACROLET[39;49;00m[37m [39;49;00m(([31mERROR[39;49;00m[37m [39;49;00m([31m&REST[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m
[37m                                  [39;49;00m([31mLIST*[39;49;00m[37m [39;49;00m[33m'ERROR-OF-TYPE[39;49;00m[37m [39;49;00m'[33m'ERROR[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m
[37m                               [39;49;00m))[37m[39;49;00m
[37m                       [39;49;00m,[31mcheck-form[39;49;00m[37m[39;49;00m
[37m                    [39;49;00m))[37m[39;49;00m
[37m                 [39;49;00m)[37m[39;49;00m
[37m               [39;49;00m,[31mtypep-form[39;49;00m[37m[39;49;00m
[37m     [39;49;00m)[37m     [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m     [39;49;00m([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST3[39;49;00m[37m[39;49;00m
[37m           [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST3[39;49;00m[37m[39;49;00m
[37m                  [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m
[37m                              [39;49;00m[32m#'[39;49;00m([31mLAMBDA[39;49;00m[37m [39;49;00m(,[31mvar[39;49;00m[37m [39;49;00m,@[31mlambdalist[39;49;00m[37m [39;49;00m[31m&REST[39;49;00m[37m [39;49;00m[31mILLEGAL-ARGS[39;49;00m)[37m[39;49;00m
[37m                                  [39;49;00m([31mDECLARE[39;49;00m[37m [39;49;00m([31mIGNORE[39;49;00m[37m [39;49;00m[31mILLEGAL-ARGS[39;49;00m))[37m[39;49;00m
[37m                                  [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m[31mcheck-form[39;49;00m[37m[39;49;00m
[37m                                      [39;49;00m`(([31mMACROLET[39;49;00m[37m [39;49;00m(([31mERROR[39;49;00m[37m [39;49;00m([31m&REST[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m
[37m                                                     [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m[33m'PROGN[39;49;00m[37m[39;49;00m
[37m                                                           [39;49;00m([31mLIST*[39;49;00m[37m [39;49;00m[33m'C-WARN[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m
[37m                                                           [39;49;00m'([31mTHROW[39;49;00m[37m [39;49;00m[33m'C-TYPEP[39;49;00m[37m [39;49;00m[31mNIL[39;49;00m)[37m[39;49;00m
[37m                                                  [39;49;00m))[37m [39;49;00m)[37m[39;49;00m
[37m                                          [39;49;00m,[31mcheck-form[39;49;00m[37m[39;49;00m
[37m                                       [39;49;00m))[37m[39;49;00m
[37m                                    [39;49;00m)[37m[39;49;00m
[37m                                  [39;49;00m,[31mc-typep-form[39;49;00m[37m[39;49;00m
[37m                                [39;49;00m)[37m[39;49;00m
[37m     [39;49;00m)[37m     [39;49;00m)[37m      [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m
[37m     [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
[37m[39;49;00m
[37m; CLtL1 p. 43[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[36marrayp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mATOM[39;49;00m[37m [39;49;00m[36matom[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBASE-CHAR[39;49;00m[37m[39;49;00m
[37m  [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m
[37m  [39;49;00m[36mcharacterp[39;49;00m[37m[39;49;00m
[37m  [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([31mbase-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m[37m [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'BASE-CHAR[39;49;00m[37m[39;49;00m
)[37m [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIGNUM[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([31mfixnump[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIT[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m1[39;49;00m)))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m[36mbit-vector-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBOOLEAN[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'nil[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m't[39;49;00m)))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCHARACTER[39;49;00m[37m [39;49;00m[36mcharacterp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCOMPILED-FUNCTION[39;49;00m[37m [39;49;00m[36mcompiled-function-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m[36mcomplexp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m[36mconsp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mDOUBLE-FLOAT[39;49;00m[37m [39;49;00m[31mdouble-float-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mENCODING[39;49;00m[37m [39;49;00m[31mencodingp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mEXTENDED-CHAR[39;49;00m[37m[39;49;00m
[37m  [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([31mbase-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFIXNUM[39;49;00m[37m [39;49;00m[31mfixnump[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFLOAT[39;49;00m[37m [39;49;00m[36mfloatp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFUNCTION[39;49;00m[37m [39;49;00m[36mfunctionp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mHASH-TABLE[39;49;00m[37m [39;49;00m[36mhash-table-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mINTEGER[39;49;00m[37m [39;49;00m[36mintegerp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mKEYWORD[39;49;00m[37m [39;49;00m[36mkeywordp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLIST[39;49;00m[37m [39;49;00m[36mlistp[39;49;00m)[37m[39;49;00m
#+[31mLOGICAL-PATHNAMES[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLOGICAL-PATHNAME[39;49;00m[37m [39;49;00m[31mlogical-pathname-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLONG-FLOAT[39;49;00m[37m [39;49;00m[31mlong-float-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNIL[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNULL[39;49;00m[37m [39;49;00m[36mnull[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNUMBER[39;49;00m[37m [39;49;00m[36mnumberp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPACKAGE[39;49;00m[37m [39;49;00m[36mpackagep[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPATHNAME[39;49;00m[37m [39;49;00m[36mpathnamep[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRANDOM-STATE[39;49;00m[37m [39;49;00m[36mrandom-state-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRATIO[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mrationalp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRATIONAL[39;49;00m[37m [39;49;00m[36mrationalp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mREADTABLE[39;49;00m[37m [39;49;00m[36mreadtablep[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mREAL[39;49;00m[37m [39;49;00m[36mrealp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSEQUENCE[39;49;00m[37m [39;49;00m[31msequencep[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSHORT-FLOAT[39;49;00m[37m [39;49;00m[31mshort-float-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31msimple-array-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m[37m [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'BASE-CHAR[39;49;00m[37m[39;49;00m
)[37m [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[36msimple-bit-vector-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[36msimple-string-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[36msimple-vector-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSINGLE-FLOAT[39;49;00m[37m [39;49;00m[31msingle-float-p[39;49;00m)[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31m%standard-char-p[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mstandard-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m[37m; ABI[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTANDARD-CHAR[39;49;00m[37m [39;49;00m[31m%standard-char-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCLOS:STANDARD-OBJECT[39;49;00m[37m [39;49;00m[31mclos::std-instance-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTREAM[39;49;00m[37m [39;49;00m[36mstreamp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFILE-STREAM[39;49;00m[37m [39;49;00m[31mfile-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSYNONYM-STREAM[39;49;00m[37m [39;49;00m[31msynonym-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBROADCAST-STREAM[39;49;00m[37m [39;49;00m[31mbroadcast-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCONCATENATED-STREAM[39;49;00m[37m [39;49;00m[31mconcatenated-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mTWO-WAY-STREAM[39;49;00m[37m [39;49;00m[31mtwo-way-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mECHO-STREAM[39;49;00m[37m [39;49;00m[31mecho-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING-STREAM[39;49;00m[37m [39;49;00m[31mstring-stream-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[36mstringp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING-CHAR[39;49;00m[37m [39;49;00m[36mcharacterp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCLOS:STRUCTURE-OBJECT[39;49;00m[37m [39;49;00m[31mclos::structure-object-p[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSYMBOL[39;49;00m[37m [39;49;00m[36msymbolp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mT[39;49;00m[37m [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m
[37m;; foreign1.lisp is loaded after this file,[39;49;00m[37m[39;49;00m
[37m;; so these symbols are not external yet[39;49;00m[37m[39;49;00m
#+[31mffi[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-function[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-function[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
#+[31mffi[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-variable[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-variable[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
#+[31mffi[39;49;00m[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-address[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-address[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
[37m;; see lispbibl.d (#define FOREIGN) and predtype.d (TYPE-OF):[39;49;00m[37m[39;49;00m
#+([36mor[39;49;00m[37m [39;49;00m[31munix[39;49;00m[37m [39;49;00m[31mffi[39;49;00m[37m [39;49;00m[31maffi[39;49;00m[37m [39;49;00m[31mwin32[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mforeign-pointer[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'foreign-pointer[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m[36mvectorp[39;49;00m)[37m[39;49;00m
([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPLIST[39;49;00m[37m[39;49;00m
[37m    [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mtail[39;49;00m)[37m [39;49;00m([31mlist-length-dotted[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m[31mtail[39;49;00m)[37m [39;49;00m([36mevenp[39;49;00m[37m [39;49;00m[36mlength[39;49;00m)))))[37m[39;49;00m
[37m[39;49;00m
([36mdefmacro[39;49;00m[37m [39;49;00m[31mensure-dim[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[31mdim[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[37m;; make sure DIM is a valid dimension[39;49;00m[37m[39;49;00m
[37m  [39;49;00m`([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m[37m [39;49;00m`([31mINTEGER[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m(,[31mARRAY-DIMENSION-LIMIT[39;49;00m))))[37m[39;49;00m
[37m     [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: dimension ~S is invalid"[39;49;00m)[37m [39;49;00m[33m',type[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m)))[37m[39;49;00m
[37m[39;49;00m
([36mdefmacro[39;49;00m[37m [39;49;00m[31mensure-rank[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[31mrank[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[37m;; make sure RANK is a valid rank[39;49;00m[37m[39;49;00m
[37m  [39;49;00m`([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mrank[39;49;00m[37m [39;49;00m`([31mINTEGER[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m(,[31mARRAY-RANK-LIMIT[39;49;00m)))[37m[39;49;00m
[37m     [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: rank ~S is invalid"[39;49;00m)[37m [39;49;00m[33m',type[39;49;00m[37m [39;49;00m,[31mrank[39;49;00m)))[37m[39;49;00m
[37m[39;49;00m
[37m; CLtL1 p. 46-50[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-array[39;49;00m[37m [39;49;00m([31mtester[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mEQUAL[39;49;00m[37m [39;49;00m([31mARRAY-ELEMENT-TYPE[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m
[37m          [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m,[31mdims[39;49;00m[37m [39;49;00m([31mARRAY-RANK[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m
[37m              [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m,([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mARRAY-RANK[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m,@([34mlet[39;49;00m[37m [39;49;00m(([31mi[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([31mmapcap[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mdim[39;49;00m)[37m[39;49;00m
[37m                                [39;49;00m([36mprog1[39;49;00m[37m[39;49;00m
[37m                                  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdim[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m                                    [39;49;00m'()[37m[39;49;00m
[37m                                    [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m[33m',dim[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m,[31mi[39;49;00m)))[37m[39;49;00m
[37m                                  [39;49;00m)[37m[39;49;00m
[37m                                  [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mi[39;49;00m)[37m[39;49;00m
[37m                              [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m                            [39;49;00m[31mdims[39;49;00m[37m[39;49;00m
[37m                  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m               [39;49;00m)[37m[39;49;00m
[37m          [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-vector[39;49;00m[37m [39;49;00m([31mtester[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m[33m',size[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m          [39;49;00m)[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mtypep-number-test[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36m<[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m
[37m                  [39;49;00m#1=([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to ~S must be *, ~S or a list of ~S: ~S"[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m
[37m       [39;49;00m)[37m     [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36m>[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m
[37m                  [39;49;00m#1#[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m[39;49;00m
)[37m [39;49;00m)[37m    [39;49;00m)[37m     [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-number[39;49;00m[37m [39;49;00m([31mcaller[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'())[37m[39;49;00m
[37m                [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m`(([36m<=[39;49;00m[37m [39;49;00m,[31mlow[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m
[37m                 [39;49;00m`(([36m<[39;49;00m[37m [39;49;00m,([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m)[37m[39;49;00m
[37m                [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mc-warn[39;49;00m[37m [39;49;00m#1=([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to ~S must be *, ~S or a list of ~S: ~S"[39;49;00m)[37m[39;49;00m
[37m                           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m
[37m                   [39;49;00m)[37m[39;49;00m
[37m                   [39;49;00m([34mthrow[39;49;00m[37m [39;49;00m[33m'c-TYPEP[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m          [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'())[37m[39;49;00m
[37m                [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m`(([36m>=[39;49;00m[37m [39;49;00m,[31mhigh[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                 [39;49;00m`(([36m>[39;49;00m[37m [39;49;00m,([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m)[37m[39;49;00m
[37m                [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mc-warn[39;49;00m[37m [39;49;00m#1#[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m
[37m                   [39;49;00m([34mthrow[39;49;00m[37m [39;49;00m[33m'c-TYPEP[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m
[37m          [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([31mensure-rank[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mdim[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mdim[39;49;00m))))[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36marrayp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)))[37m[39;49;00m
[37m                         [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-dimensions[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m)[37m    [39;49;00m)[37m   [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-array[39;49;00m[37m [39;49;00m[33m'ARRAYP[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([31mensure-rank[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mdim[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31mdim[39;49;00m))))[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31msimple-array-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)))[37m[39;49;00m
[37m                         [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-dimensions[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m)[37m    [39;49;00m)[37m   [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-array[39;49;00m[37m [39;49;00m[33m'SIMPLE-ARRAY-P[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mvectorp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31msize[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mVECTORP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mEQUAL[39;49;00m[37m [39;49;00m([31mARRAY-ELEMENT-TYPE[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m
[37m          [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[33m',size[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m)[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMLPE-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mitype[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcomplexp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mrealpart[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m)))[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mitype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mimagpart[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mitype[39;49;00m))))[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mCOMPLEXP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mREALPART[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m))))[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mitype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m            [39;49;00m'()[37m[39;49;00m
[37m            [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mIMAGPART[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mitype[39;49;00m))))))[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mINTEGER[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mintegerp[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m[37m [39;49;00m[33m'INTEGERP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mMOD[39;49;00m[37m [39;49;00m([31mn[39;49;00m)[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to MOD must be an integer: ~S"[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m
[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m([31mNOT[39;49;00m[37m [39;49;00m([31mMINUSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m,[31mn[39;49;00m))[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIGNED-BYTE[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to SIGNED-BYTE must be an integer or * : ~S"[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m
[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([36m<[39;49;00m[37m [39;49;00m([31mINTEGER-LENGTH[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m,[31mn[39;49;00m)))[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to UNSIGNED-BYTE must be an integer or * : ~S"[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m
[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mminusp[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m([31mNOT[39;49;00m[37m [39;49;00m([31mMINUSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([36m<=[39;49;00m[37m [39;49;00m([31mINTEGER-LENGTH[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m,[31mn[39;49;00m)))[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mREAL[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mrealp[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m[37m [39;49;00m[33m'REALP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mRATIONAL[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mrationalp[39;49;00m[37m [39;49;00m[33m'RATIONAL[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'RATIONAL[39;49;00m[37m [39;49;00m[33m'RATIONALP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mFLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mfloatp[39;49;00m[37m [39;49;00m[33m'FLOAT[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'FLOAT[39;49;00m[37m [39;49;00m[33m'FLOATP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSHORT-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mshort-float-p[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSINGLE-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31msingle-float-p[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mDOUBLE-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mdouble-float-p[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mLONG-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mlong-float-p[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'STRINGP[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-STRING-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'STRINGP[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-STRING-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mbit-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'BIT-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-bit-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-BIT-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mcar-type[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mcdr-type[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m)[37m[39;49;00m
[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mCONSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mCAR[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',car-type[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mCDR[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',cdr-type[39;49;00m)))[37m[39;49;00m
[37m   [39;49;00m)[37m[39;49;00m
)[37m[39;49;00m
[37m[39;49;00m
([36mfmakunbound[39;49;00m[37m [39;49;00m[33m'def-compound-type[39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m; Typtest ohne Gefahr einer Fehlermeldung. F√ºr SIGNAL und HANDLER-BIND.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31msafe-typep[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menv[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31m*error-handler*[39;49;00m[37m[39;49;00m
[37m          [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([34m&rest[39;49;00m[37m [39;49;00m[31merror-args[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31merror-args[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31msafe-typep[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mnil[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m       [39;49;00m))[37m   [39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31menv[39;49;00m)[37m [39;49;00m[31mt[39;49;00m)[37m[39;49;00m
)[37m [39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m; Umwandlung eines "type for declaration" in einen "type for discrimination".[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mtype-for-discrimination[39;49;00m[37m [39;49;00m([31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m([31mnotp[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m[34m&aux[39;49;00m[37m [39;49;00m[31mf[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m(([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'DEFTYPE-EXPANDER[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mlist[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m                         [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m)))[37m[39;49;00m
[37m                    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m))[37m[39;49;00m
[37m                 [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m
[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m(([31mSATISFIES[39;49;00m[37m [39;49;00m[31mMEMBER[39;49;00m[37m [39;49;00m[31mEQL[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mNOT[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m))))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m`([31mNOT[39;49;00m[37m [39;49;00m,[31mzx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m))[37m[39;49;00m
[37m             [39;49;00m(([31mAND[39;49;00m[37m [39;49;00m[31mOR[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m[31mVALUES[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m                     [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([36mmapcar[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m))[37m [39;49;00m[31mz[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36meql[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m([36mcons[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mzx[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([31mFUNCTION[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; (FUNCTION arg-types res-type) is somewhere between[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; NIL and FUNCTION, but undecidable.[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m[37m [39;49;00m[33m'FUNCTION[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m                      [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'DEFTYPE-EXPANDER[39;49;00m))[37m[39;49;00m
[37m                       [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m
[37m                              [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m)))[37m[39;49;00m
[37m                         [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m[39;49;00m
[37m                      [39;49;00m))[37m[39;49;00m
[37m                      [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m)[37m  [39;49;00m)[37m [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m
[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m
)[37m [39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m; Testet eine Liste von Werten auf Erf√ºllen eines Type-Specifiers. F√ºr THE.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[37m; ABI[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mmacrolet[39;49;00m[37m [39;49;00m(([31mnear-typep[39;49;00m[37m [39;49;00m([31mobjform[39;49;00m[37m [39;49;00m[31mtypform[39;49;00m)[37m[39;49;00m
[37m               [39;49;00m[37m;; near-typep ist wie typep, nur dass das Objekt auch ein[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; Read-Label sein darf. Das tritt z.B. auf bei[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; (read-from-string "#1=#S(FOO :X #1#)")[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; im Konstruktor MAKE-FOO. Die Implementation ist aber[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; nicht gezwungen, bei fehlerhaftem THE zwingend einen[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; Fehler zu melden, darum ist ein lascherer Typcheck hier[39;49;00m[37m[39;49;00m
[37m               [39;49;00m[37m;; erlaubt.[39;49;00m[37m[39;49;00m
[37m               [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mg[39;49;00m[37m [39;49;00m([36mgensym[39;49;00m)))[37m[39;49;00m
[37m                 [39;49;00m`([34mlet[39;49;00m[37m [39;49;00m((,[31mg[39;49;00m[37m [39;49;00m,[31mobjform[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mg[39;49;00m[37m [39;49;00m,[31mtypform[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m,[31mg[39;49;00m)[37m [39;49;00m[33m'READ-LABEL[39;49;00m))))))[37m[39;49;00m
[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'VALUES[39;49;00m))[37m[39;49;00m
[37m      [39;49;00m[37m;; The VALUES type specifier is ill-defined in ANSI CL.[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; There are two possibilities to define a VALUES type specifier in a[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; sane way:[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; - (EXACT-VALUES type1 ... [&optional ...]) describes the exact shape[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   of the values list, as received by MULTIPLE-VALUE-LIST.[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   For example, (EXACT-VALUES SYMBOL) is matched by (values 'a) but not[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   by (values 'a 'b) or (values).[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; - (ASSIGNABLE-VALUES type1 ... [&optional ...]) describes the values[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   as received by a set of variables through MULTIPLE-VALUE-BIND or[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   MULTIPLE-VALUE-SETQ. For example, (ASSIGNABLE-VALUES SYMBOL) is[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   defined by whether[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;     (MULTIPLE-VALUE-BIND (var1) values (DECLARE (TYPE SYMBOL var1)) ...)[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   is valid or not; therefore (ASSIGNABLE-VALUES SYMBOL) is matched by[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   (values 'a) and (values 'a 'b) and (values).[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   Note that &OPTIONAL is actually redundant here:[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;     (ASSIGNABLE-VALUES type1 ... &optional otype1 ...)[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;   is equivalent to[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;     (ASSIGNABLE-VALUES type1 ... (OR NULL otype1) ...)[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; HyperSpec/Body/typspe_values.html indicates that VALUES means[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; EXACT-VALUES; however, HyperSpec/Body/speope_the.html indicates that[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; VALUES means ASSIGNABLE-VALUES.[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; SBCL interprets the VALUES type specifier to mean EXACT-VALUES when[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; it contains &OPTIONAL or &REST, but ASSIGNABLE-VALUES when it has[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; only a tuple of type specifiers. This is utter nonsense, in particular[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; because it makes (VALUES type1 ... typek &OPTIONAL)[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; different from   (VALUES type1 ... typek).[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; Here we use the ASSIGNABLE-VALUES interpretation.[39;49;00m[37m[39;49;00m
[37m      [39;49;00m[37m;; In SUBTYPEP we just punt and don't assume any interpretation.[39;49;00m[37m[39;49;00m
[37m      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mvals[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m([31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m[37m;; required:[39;49;00m[37m[39;49;00m
[37m        [39;49;00m([36mloop[39;49;00m[37m[39;49;00m
[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m[37m;; &optional:[39;49;00m[37m[39;49;00m
[37m        [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&optional[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m([36mloop[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))))[37m[39;49;00m
[37m        [39;49;00m[37m;; &rest &key:[39;49;00m[37m[39;49;00m
[37m        [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m[39;49;00m
[37m          [39;49;00m([34m&rest[39;49;00m[37m[39;49;00m
[37m           [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m
[37m          [39;49;00m([34m&key[39;49;00m)[37m[39;49;00m
[37m          [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&key[39;49;00m)[37m[39;49;00m
[37m          [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36moddp[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkeywords[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([36mloop[39;49;00m[37m[39;49;00m
[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mitem[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlistp[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)[37m [39;49;00m[34m2[39;49;00m)[37m[39;49;00m
[37m                               [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)))[37m[39;49;00m
[37m                    [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkw[39;49;00m[37m [39;49;00m([31msymbol-to-keyword[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mitem[39;49;00m))))[37m[39;49;00m
[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mgetf[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m[31mkw[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31mitem[39;49;00m))[37m[39;49;00m
[37m                      [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mpush[39;49;00m[37m [39;49;00m[31mkw[39;49;00m[37m [39;49;00m[31mkeywords[39;49;00m))))[37m[39;49;00m
[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&allow-other-keys[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mgetf[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m'[33m:allow-other-keys[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([36mdo[39;49;00m[37m [39;49;00m(([31mL[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[31mL[39;49;00m)))[37m[39;49;00m
[37m                      [39;49;00m(([36matom[39;49;00m[37m [39;49;00m[31mL[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mL[39;49;00m)[37m [39;49;00m[31mkeywords[39;49;00m)[37m[39;49;00m
[37m                      [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))))))[37m[39;49;00m
[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m[31mt[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m
[37m[39;49;00m
[37m;;; ===========================================================================[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; SUBTYPEP[39;49;00m[37m[39;49;00m
([36mload[39;49;00m[37m [39;49;00m[33m"subtypep"[39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m[39;49;00m
[37m;; Returns the number of bytes that are needed to represent #\Null in a[39;49;00m[37m[39;49;00m
[37m;; given encoding.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mencoding-zeroes[39;49;00m[37m [39;49;00m([31mencoding[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m#+[31mUNICODE[39;49;00m[37m[39;49;00m
[37m  [39;49;00m[37m;; this should use min_bytes_per_char for cache, not the hash table[39;49;00m[37m[39;49;00m
[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mname[39;49;00m[37m [39;49;00m([31mext:encoding-charset[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m))[37m[39;49;00m
[37m        [39;49;00m([31mtable[39;49;00m[37m [39;49;00m#.([36mmake-hash-table[39;49;00m[37m [39;49;00m[33m:key-type[39;49;00m[37m [39;49;00m'([36mor[39;49;00m[37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m [39;49;00m[33m:value-type[39;49;00m[37m [39;49;00m[33m'fixnum[39;49;00m[37m[39;49;00m
[37m                                  [39;49;00m[33m:test[39;49;00m[37m [39;49;00m[33m'stablehash-equal[39;49;00m[37m [39;49;00m[33m:warn-if-needs-rehash-after-gc[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m[39;49;00m
[37m                                  [39;49;00m[33m:initial-contents[39;49;00m[37m [39;49;00m'(([33m"UTF-7"[39;49;00m[37m [39;49;00m.[37m [39;49;00m[34m1[39;49;00m))))[37m[39;49;00m
[37m        [39;49;00m([31mtester[39;49;00m[37m [39;49;00m#.([36mmake-string[39;49;00m[37m [39;49;00m[34m2[39;49;00m[37m [39;49;00m[33m:initial-element[39;49;00m[37m [39;49;00m([36mcode-char[39;49;00m[37m [39;49;00m[34m0[39;49;00m))))[37m[39;49;00m
[37m    [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36mgethash[39;49;00m[37m [39;49;00m[31mname[39;49;00m[37m [39;49;00m[31mtable[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m([36msetf[39;49;00m[37m [39;49;00m([36mgethash[39;49;00m[37m [39;49;00m[31mname[39;49;00m[37m [39;49;00m[31mtable[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([36m-[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m([31mext:convert-string-to-bytes[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m))[37m[39;49;00m
[37m                 [39;49;00m([36mlength[39;49;00m[37m [39;49;00m([31mext:convert-string-to-bytes[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m[37m[39;49;00m
[37m                                                      [39;49;00m[33m:end[39;49;00m[37m [39;49;00m[34m1[39;49;00m))))))[37m[39;49;00m
[37m  [39;49;00m#-[31mUNICODE[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m[39;49;00m
[37m[39;49;00m
[37m;; Determines two values low,high such that[39;49;00m[37m[39;49;00m
[37m;;   (subtypep type `(INTEGER ,low ,high))[39;49;00m[37m[39;49;00m
[37m;; holds and low is as large as possible and high is as small as possible.[39;49;00m[37m[39;49;00m
[37m;; low = * means -infinity, high = * means infinity.[39;49;00m[37m[39;49;00m
[37m;; When (subtypep type 'INTEGER) is false, the values NIL,NIL are returned.[39;49;00m[37m[39;49;00m
[37m;; We need this function only for MAKE-ARRAY, UPGRADED-ARRAY-ELEMENT-TYPE and[39;49;00m[37m[39;49;00m
[37m;; OPEN and can therefore w.l.o.g. replace[39;49;00m[37m[39;49;00m
[37m;;   type  with  `(OR ,type (MEMBER 0))[39;49;00m[37m[39;49;00m
[37m#|[39;49;00m[37m ;; The original implementation calls canonicalize-type and then applies[39;49;00m
[37m   ;; a particular SUBTYPE variant:[39;49;00m
[37m (defun subtype-integer (type)[39;49;00m
[37m  (macrolet ((yes () '(return-from subtype-integer (values low high)))[39;49;00m
[37m             (no () '(return-from subtype-integer nil))[39;49;00m
[37m             (unknown () '(return-from subtype-integer nil)))[39;49;00m
[37m    (setq type (canonicalize-type type))[39;49;00m
[37m    (if (consp type)[39;49;00m
[37m      (case (first type)[39;49;00m
[37m        (MEMBER ; (MEMBER &rest objects)[39;49;00m
[37m          ;; All elements must be of type INTEGER.[39;49;00m
[37m          (let ((low 0) (high 0)) ; wlog![39;49;00m
[37m            (dolist (x (rest type) (yes))[39;49;00m
[37m              (unless (typep x 'INTEGER) (return (no)))[39;49;00m
[37m              (setq low (min low x) high (max high x)))))[39;49;00m
[37m        (OR ; (OR type*)[39;49;00m
[37m          ;; Every type must be subtype of INTEGER.[39;49;00m
[37m          (let ((low 0) (high 0)) ; wlog![39;49;00m
[37m            (dolist (type1 (rest type) (yes))[39;49;00m
[37m              (multiple-value-bind (low1 high1) (subtype-integer type1)[39;49;00m
[37m                (unless low1 (return (no)))[39;49;00m
[37m                (setq low (if (or (eq low '*) (eq low1 '*)) '* (min low low1))[39;49;00m
[37m                      high (if (or (eq high '*) (eq high1 '*))[39;49;00m
[37m                               '* (max high high1)))))))[39;49;00m
[37m        (AND ; (AND type*)[39;49;00m
[37m          ;; If one of the types is subtype of INTEGER, then yes,[39;49;00m
[37m          ;; otherwise unknown.[39;49;00m
[37m          (let ((low nil) (high nil))[39;49;00m
[37m            (dolist (type1 (rest type))[39;49;00m
[37m              (multiple-value-bind (low1 high1) (subtype-integer type1)[39;49;00m
[37m                (when low1[39;49;00m
[37m                  (if low[39;49;00m
[37m                    (setq low (if (eq low '*) low1 (if (eq low1 '*) low (max low low1)))[39;49;00m
[37m                          high (if (eq high '*) high1 (if (eq high1 '*) high (min high high1))))[39;49;00m
[37m                    (setq low low1 high high1)))))[39;49;00m
[37m            (if low[39;49;00m
[37m              (progn[39;49;00m
[37m                (when (and (numberp low) (numberp high) (not (<= low high)))[39;49;00m
[37m                  (setq low 0 high 0) ; type equivalent to NIL)[39;49;00m
[37m                (yes))[39;49;00m
[37m              (unknown)))))[39;49;00m
[37m      (setq type (list type)))[39;49;00m
[37m    (if (eq (first type) 'INTEGER)[39;49;00m
[37m      (let ((low (if (rest type) (second type) '*))[39;49;00m
[37m            (high (if (cddr type) (third type) '*)))[39;49;00m
[37m        (when (consp low)[39;49;00m
[37m          (setq low (first low))[39;49;00m
[37m          (when (numberp low) (incf low)))[39;49;00m
[37m        (when (consp high)[39;49;00m
[37m          (setq high (first high))[39;49;00m
[37m          (when (numberp high) (decf high)))[39;49;00m
[37m        (when (and (numberp low) (numberp high) (not (<= low high))) ; type leer?[39;49;00m
[37m          (setq low 0 high 0))[39;49;00m
[37m        (yes))[39;49;00m
[37m      (if (and (eq (first type) 'INTERVALS) (eq (second type) 'INTEGER))[39;49;00m
[37m        (let ((low (third type))[39;49;00m
[37m              (high (car (last type))))[39;49;00m
[37m          (when (consp low)[39;49;00m
[37m            (setq low (first low))[39;49;00m
[37m            (when (numberp low) (incf low)))[39;49;00m
[37m          (when (consp high)[39;49;00m
[37m            (setq high (first high))[39;49;00m
[37m            (when (numberp high) (decf high)))[39;49;00m
[37m          (yes))[39;49;00m
[37m        (unknown)))))[39;49;00m
[37m|#[39;49;00m[37m [39;49;00m[37m;; This implementation inlines the (tail-recursive) canonicalize-type[39;49;00m[37m[39;49;00m
[37m   [39;49;00m[37m;; function. Its advantage is that it doesn't cons as much.[39;49;00m[37m[39;49;00m
[37m   [39;49;00m[37m;; (For example, (subtype-integer '(UNSIGNED-BYTE 8)) doesn't cons.)[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m([34mtype[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34mmacrolet[39;49;00m[37m [39;49;00m(([31myes[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mno[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([31munknown[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m
[37m    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m    [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m
[37m             [39;49;00m([31mBIT[39;49;00m[37m [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mFIXNUM[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m'#,[31mmost-negative-fixnum[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m'#,[31mmost-positive-fixnum[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m(([31mINTEGER[39;49;00m[37m [39;49;00m[31mBIGNUM[39;49;00m[37m [39;49;00m[31mSIGNED-BYTE[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mUNSIGNED-BYTE[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m(([31mNIL[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m
[37m          [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m           [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlist-length[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m
[37m             [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([31mMEMBER[39;49;00m[37m [39;49;00m[37m; (MEMBER &rest objects)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; All elements must be of type INTEGER.[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m
[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))))[37m[39;49;00m
[37m             [39;49;00m([31mEQL[39;49;00m[37m [39;49;00m[37m; (EQL object)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m
[37m             [39;49;00m([31mOR[39;49;00m[37m [39;49;00m[37m; (OR type*)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; Every type must be subtype of INTEGER.[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m
[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mtype1[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow1[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)[37m [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m[31mtype1[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m
[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m
[37m                                  [39;49;00m[33m'*[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m))[37m[39;49;00m
[37m                          [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m
[37m                                   [39;49;00m[33m'*[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)))))))[37m[39;49;00m
[37m             [39;49;00m([31mAND[39;49;00m[37m [39;49;00m[37m; (AND type*)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; If one of the types is subtype of INTEGER, then yes,[39;49;00m[37m[39;49;00m
[37m              [39;49;00m[37m;; otherwise unknown.[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mtype1[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow1[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)[37m [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m[31mtype1[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m
[37m                      [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m
[37m                        [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m
[37m                                      [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m
[37m                                          [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m)))[37m[39;49;00m
[37m                              [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mhigh1[39;49;00m[37m[39;49;00m
[37m                                       [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mhigh[39;49;00m[37m[39;49;00m
[37m                                           [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m))))[37m[39;49;00m
[37m                        [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m
[37m                              [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)))))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m
[37m                  [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m
[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m
[37m                               [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                      [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; type equivalent to NIL[39;49;00m[37m[39;49;00m
[37m                    [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([31munknown[39;49;00m))))[37m[39;49;00m
[37m             [39;49;00m([31mINTEGER[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mthird[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mdecf[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; type equivalent to NIL[39;49;00m[37m[39;49;00m
[37m                [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mINTERVALS[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m
[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mthird[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                      [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m
[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mdecf[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([31munknown[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mMOD[39;49;00m[37m [39;49;00m[37m; (MOD n)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([31mno[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m
[37m                    [39;49;00m([31myes[39;49;00m)))))[37m[39;49;00m
[37m             [39;49;00m([31mSIGNED-BYTE[39;49;00m[37m [39;49;00m[37m; (SIGNED-BYTE &optional s)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ms[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                  [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m
[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31ms[39;49;00m)[37m [39;49;00m([36mplusp[39;49;00m[37m [39;49;00m[31ms[39;49;00m))[37m[39;49;00m
[37m                      [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36mash[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31ms[39;49;00m))))[37m [39;49;00m[37m; (ash 1 *) == (expt 2 *)[39;49;00m[37m[39;49;00m
[37m                      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36m-[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m
[37m                        [39;49;00m([31myes[39;49;00m)))))))[37m[39;49;00m
[37m             [39;49;00m([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[37m; (UNSIGNED-BYTE &optional s)[39;49;00m[37m[39;49;00m
[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ms[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m
[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m
[37m                      [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31ms[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m
[37m                        [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36mash[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31ms[39;49;00m)))[37m [39;49;00m[37m; (ash 1 *) == (expt 2 *)[39;49;00m[37m[39;49;00m
[37m                        [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m
[37m                          [39;49;00m([31myes[39;49;00m)))))))[37m[39;49;00m
[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m
[37m          [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31mclos::built-in-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m                    [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m             [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m[39;49;00m
[37m               [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m
[37m          [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mx[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m
[37m               [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m
[37m               [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m
[37m          [39;49;00m(([31mencodingp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31mno[39;49;00m))[37m[39;49;00m
[37m          [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))))[37m[39;49;00m
[37m[39;49;00m
[37m#|[39;49;00m[37m TODO: Fix subtype-integer such that this works.[39;49;00m
[37mHenry Baker:[39;49;00m
[37m (defun type-null (x)[39;49;00m
[37m  (values (and (eq 'bit (upgraded-array-element-type `(or bit ,x)))[39;49;00m
[37m               (not (typep 0 x))[39;49;00m
[37m               (not (typep 1 x)))[39;49;00m
[37m          t))[39;49;00m
[37m (type-null '(and symbol number))[39;49;00m
[37m (type-null '(and integer symbol))[39;49;00m
[37m (type-null '(and integer character))[39;49;00m
[37m|#[39;49;00m[37m[39;49;00m
[37m[39;49;00m
[37m;; Determines a sequence kind (an atom, as defined in defseq.lisp: one of[39;49;00m[37m[39;49;00m
[37m;;   LIST - stands for LIST[39;49;00m[37m[39;49;00m
[37m;;   VECTOR - stands for (VECTOR T)[39;49;00m[37m[39;49;00m
[37m;;   STRING - stands for (VECTOR CHARACTER)[39;49;00m[37m[39;49;00m
[37m;;   1, 2, 4, 8, 16, 32 - stands for (VECTOR (UNSIGNED-BYTE n))[39;49;00m[37m[39;49;00m
[37m;;   0 - stands for (VECTOR NIL))[39;49;00m[37m[39;49;00m
[37m;; that indicates the sequence type meant by the given type. Other possible[39;49;00m[37m[39;49;00m
[37m;; return values are[39;49;00m[37m[39;49;00m
[37m;;   SEQUENCE - denoting a type whose intersection with (OR LIST VECTOR) is not[39;49;00m[37m[39;49;00m
[37m;;              subtype of LIST or VECTOR, or[39;49;00m[37m[39;49;00m
[37m;;   NIL - indicating a type whose intersection with (OR LIST VECTOR) is empty.[39;49;00m[37m[39;49;00m
[37m;; When the type is (OR (VECTOR eltype1) ... (VECTOR eltypeN)), the chosen[39;49;00m[37m[39;49;00m
[37m;; element type is the smallest element type that contains all of eltype1 ...[39;49;00m[37m[39;49;00m
[37m;; eltypeN.[39;49;00m[37m[39;49;00m
[37m;;[39;49;00m[37m[39;49;00m
[37m;; User-defined sequence types are not supported here.[39;49;00m[37m[39;49;00m
[37m;;[39;49;00m[37m[39;49;00m
[37m;; This implementation inlines the (tail-recursive) canonicalize-type[39;49;00m[37m[39;49;00m
[37m;; function. Its advantage is that it doesn't cons as much. Also it employs[39;49;00m[37m[39;49;00m
[37m;; some heuristics and does not have the full power of SUBTYPEP.[39;49;00m[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31msubtype-sequence[39;49;00m[37m [39;49;00m([34mtype[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m
[37m           [39;49;00m(([31mLIST[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m[31mNULL[39;49;00m)[37m [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mNIL[39;49;00m)[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mBIT-VECTOR[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mSTRING[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mVECTOR[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mSEQUENCE[39;49;00m)[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m         [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlist-length[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m
[37m           [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([31mMEMBER[39;49;00m[37m [39;49;00m[37m; (MEMBER &rest objects)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-union[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([31mEQL[39;49;00m[37m [39;49;00m[37m; (EQL object)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[34m2[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m           [39;49;00m([31mOR[39;49;00m[37m [39;49;00m[37m; (OR type*)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-union[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([31mAND[39;49;00m[37m [39;49;00m[37m; (AND type*)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m))[37m[39;49;00m
[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-intersection[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m
[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m(([31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m)[37m [39;49;00m[37m; (SIMPLE-BIT-VECTOR &optional size)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m)[37m [39;49;00m[37m; (SIMPLE-STRING &optional size)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[37m; (SIMPLE-VECTOR &optional size)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m(([31mVECTOR[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m)[37m [39;49;00m[37m; (VECTOR &optional el-type size), (ARRAY &optional el-type dimensions)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcdddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mel-type[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m
[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m
[37m                [39;49;00m[33m'VECTOR[39;49;00m[37m[39;49;00m
[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31meltype[39;49;00m[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m
[37m                  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m
[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'BIT[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m
[37m                        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m[33m'UNSIGNED-BYTE[39;49;00m))[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31meltype[39;49;00m))[37m[39;49;00m
[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m
[37m                        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S is not up-to-date with ~S for element type ~S"[39;49;00m)[37m[39;49;00m
[37m                                  [39;49;00m[33m'subtypep-sequence[39;49;00m[37m [39;49;00m[33m'upgraded-array-element-type[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)))))))[37m[39;49;00m
[37m           [39;49;00m(([31mCONS[39;49;00m)[37m [39;49;00m[37m; (CONS &optional cartype cdrtype)[39;49;00m[37m[39;49;00m
[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcdddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m
[37m           [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31mclos::built-in-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m                  [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m
[37m           [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m
[37m        [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m
[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mtype-of-sequence[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mlistp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mvectorp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m
[37m         [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31meltype[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m[39;49;00m
[37m           [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'BIT[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m[33m'UNSIGNED-BYTE[39;49;00m))[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31meltype[39;49;00m))[37m[39;49;00m
[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m
[37m                 [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S is not up-to-date with ~S for element type ~S"[39;49;00m)[37m[39;49;00m
[37m                           [39;49;00m[33m'type-of-sequence[39;49;00m[37m [39;49;00m[33m'array-element-type[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)))))[37m[39;49;00m
[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31msequence-type-union[39;49;00m[37m [39;49;00m([31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m[37m; Simple general rules.[39;49;00m[37m[39;49;00m
[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m[37m; Now the union of two different types.[39;49;00m[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m))[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m[37m; union of LIST and a vector type[39;49;00m[37m[39;49;00m
[37m         [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m))[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m[37m; union of STRING and an integer-vector type[39;49;00m[37m[39;49;00m
[37m         [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m))))[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31msequence-type-intersection[39;49;00m[37m [39;49;00m([31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m[37m; Simple general rules.[39;49;00m[37m[39;49;00m
[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m[37m; Now the intersection of two different types.[39;49;00m[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m[37m; intersection of LIST and a vector type[39;49;00m[37m[39;49;00m
[37m         [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m))[37m[39;49;00m
[37m         [39;49;00m[37m; intersection of STRING and an integer-vector type[39;49;00m[37m[39;49;00m
[37m         [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m
[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m))))[37m[39;49;00m
[37m[39;49;00m
[37m;; ============================================================================[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36mdefun[39;49;00m[37m [39;49;00m[31mtype-expand[39;49;00m[37m [39;49;00m([31mtypespec[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31monce-p[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mexpanded[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31monce-p[39;49;00m)[37m[39;49;00m
[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mexpanded[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m)[37m[39;49;00m
[37m      [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m[39;49;00m
[37m             [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m                   [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'DEFSTRUCT-DESCRIPTION[39;49;00m)[37m[39;49;00m
[37m                        [39;49;00m([31mclos-class[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))[37m[39;49;00m
[37m                    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m                   [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))[37m[39;49;00m
[37m            [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)))[37m[39;49;00m
[37m             [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m[39;49;00m
[37m               [39;49;00m(([31mSATISFIES[39;49;00m[37m [39;49;00m[31mMEMBER[39;49;00m[37m [39;49;00m[31mEQL[39;49;00m[37m [39;49;00m[31mNOT[39;49;00m[37m [39;49;00m[31mAND[39;49;00m[37m [39;49;00m[31mOR[39;49;00m)[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m               [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m[39;49;00m
[37m                         [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m                        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))))[37m[39;49;00m
[37m            [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m
[37m            [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))))[37m[39;49;00m
[37m[39;49;00m
[37m;; ============================================================================[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36munless[39;49;00m[37m [39;49;00m([31mclos::funcallable-instance-p[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mclos::class-name[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m([36mfmakunbound[39;49;00m[37m [39;49;00m[33m'clos::class-name[39;49;00m))[37m[39;49;00m
[37m[39;49;00m
[37m[39;49;00m
([36mkeywordp[39;49;00m[37m [39;49;00m[33m:junk[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mT[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36mkeywordp[39;49;00m[37m [39;49;00m[33m::junk[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[31mT[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36msymbol-name[39;49;00m[37m [39;49;00m[33m::junk[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[33m"JUNK"[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36msymbol-name[39;49;00m[37m [39;49;00m[33m:#junk[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[33m"#JUNK"[39;49;00m[37m[39;49;00m
[37m[39;49;00m
([36msymbol-name[39;49;00m[37m [39;49;00m[33m:#.junk[39;49;00m)[37m[39;49;00m
[37m  [39;49;00m[33m"#.JUNK"[39;49;00m
