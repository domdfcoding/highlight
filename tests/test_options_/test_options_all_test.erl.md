     1^I-module(test).[37m[39;49;00m$
     2^I-export([listen/[34m1[39;49;00m,[37m[39;49;00m$
     3^I[37m         [39;49;00mhandle_client/[34m1[39;49;00m,[37m[39;49;00m$
     4^I[37m         [39;49;00mmaintain_clients/[34m1[39;49;00m,[37m[39;49;00m$
     5^I[37m         [39;49;00mstart/[34m1[39;49;00m,[37m[39;49;00m$
     6^I[37m         [39;49;00mstop/[34m0[39;49;00m,[37m[39;49;00m$
     7^I[37m         [39;49;00mcontroller/[34m1[39;49;00m]).[37m[39;49;00m$
     8^I[37m[39;49;00m$
     9^I-author([33m"[39;49;00m[33mjerith[39;49;00m[33m"[39;49;00m).[37m[39;49;00m$
    10^I[37m[39;49;00m$
    11^I-define([31mTCP_OPTIONS[39;49;00m,[list,[37m [39;49;00m{packet,[37m [39;49;00m[34m0[39;49;00m},[37m [39;49;00m{active,[37m [39;49;00mfalse},[37m [39;49;00m{reuseaddr,[37m [39;49;00mtrue}]).[37m[39;49;00m$
    12^I[37m[39;49;00m$
    13^I-record(player,[37m [39;49;00m{name=none,[37m [39;49;00msocket,[37m [39;49;00mmode}).[37m[39;49;00m$
    14^I[37m[39;49;00m$
    15^I[37m%% To allow incoming connections, we need to listen on a TCP port.[39;49;00m[37m[39;49;00m$
    16^I[37m%% This is also the entry point for our server as a whole, so it[39;49;00m[37m[39;49;00m$
    17^I[37m%% starts the client_manager process and gives it a name so the rest[39;49;00m[37m[39;49;00m$
    18^I[37m%% of the code can get to it easily.[39;49;00m[37m[39;49;00m$
    19^I[37m[39;49;00m$
    20^I[32mlisten[39;49;00m([31mPort[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    21^I[37m    [39;49;00m{ok,[37m [39;49;00m[31mLSocket[39;49;00m}[37m [39;49;00m=[37m [39;49;00m[04m[36mgen_tcp[39;49;00m:[32mlisten[39;49;00m([31mPort[39;49;00m,[37m [39;49;00m?[31mTCP_OPTIONS[39;49;00m),[37m[39;49;00m$
    22^I[37m    [39;49;00m[36mregister[39;49;00m(client_manager,[37m [39;49;00m[36mspawn[39;49;00m(?[31mMODULE[39;49;00m,[37m [39;49;00mmaintain_clients,[37m [39;49;00m[[]])),[37m[39;49;00m$
    23^I[37m    [39;49;00mdo_accept([31mLSocket[39;49;00m).[37m[39;49;00m$
    24^I[37m[39;49;00m$
    25^I[37m%% Accepting a connection gives us a connection socket with the[39;49;00m[37m[39;49;00m$
    26^I[37m%% newly-connected client on the other end.  Since we want to accept[39;49;00m[37m[39;49;00m$
    27^I[37m%% more than one client, we spawn a new process for each and then wait[39;49;00m[37m[39;49;00m$
    28^I[37m%% for another connection on our listening socket.[39;49;00m[37m[39;49;00m$
    29^I[37m[39;49;00m$
    30^I[32mdo_accept[39;49;00m([31mLSocket[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    31^I[37m    [39;49;00m[34mcase[39;49;00m[37m [39;49;00m[04m[36mgen_tcp[39;49;00m:[32maccept[39;49;00m([31mLSocket[39;49;00m)[37m [39;49;00m[34mof[39;49;00m[37m[39;49;00m$
    32^I[37m        [39;49;00m{ok,[37m [39;49;00m[31mSocket[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    33^I[37m            [39;49;00m[36mspawn[39;49;00m(?[31mMODULE[39;49;00m,[37m [39;49;00mhandle_client,[37m [39;49;00m[[31mSocket[39;49;00m]),[37m[39;49;00m$
    34^I[37m            [39;49;00mclient_manager[37m [39;49;00m![37m [39;49;00m{connect,[37m [39;49;00m[31mSocket[39;49;00m};[37m[39;49;00m$
    35^I[37m        [39;49;00m{error,[37m [39;49;00m[31mReason[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    36^I[37m            [39;49;00m[04m[36mio[39;49;00m:[32mformat[39;49;00m([33m"[39;49;00m[33mSocket accept error: [39;49;00m[33m~s[39;49;00m[33m~n[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[[31mReason[39;49;00m])[37m[39;49;00m$
    37^I[37m    [39;49;00m[34mend[39;49;00m,[37m[39;49;00m$
    38^I[37m    [39;49;00mdo_accept([31mLSocket[39;49;00m).[37m[39;49;00m$
    39^I[37m[39;49;00m$
    40^I[37m%% All the client-socket process needs to do is wait for data and[39;49;00m[37m[39;49;00m$
    41^I[37m%% forward it to the client_manager process which decides what to do[39;49;00m[37m[39;49;00m$
    42^I[37m%% with it.  If the client disconnects, we let client_manager know and[39;49;00m[37m[39;49;00m$
    43^I[37m%% then quietly go away.[39;49;00m[37m[39;49;00m$
    44^I[37m[39;49;00m$
    45^I[32mhandle_client[39;49;00m([31mSocket[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    46^I[37m    [39;49;00m[34mcase[39;49;00m[37m [39;49;00m[04m[36mgen_tcp[39;49;00m:[32mrecv[39;49;00m([31mSocket[39;49;00m,[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[34mof[39;49;00m[37m[39;49;00m$
    47^I[37m        [39;49;00m{ok,[37m [39;49;00m[31mData[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    48^I[37m            [39;49;00mclient_manager[37m [39;49;00m![37m [39;49;00m{data,[37m [39;49;00m[31mSocket[39;49;00m,[37m [39;49;00m[31mData[39;49;00m},[37m[39;49;00m$
    49^I[37m            [39;49;00mhandle_client([31mSocket[39;49;00m);[37m[39;49;00m$
    50^I[37m        [39;49;00m{error,[37m [39;49;00mclosed}[37m [39;49;00m->[37m[39;49;00m$
    51^I[37m            [39;49;00mclient_manager[37m [39;49;00m![37m [39;49;00m{disconnect,[37m [39;49;00m[31mSocket[39;49;00m}[37m[39;49;00m$
    52^I[37m    [39;49;00m[34mend[39;49;00m.[37m[39;49;00m$
    53^I[37m[39;49;00m$
    54^I[37m%% This is the main loop of the client_manager process.  It maintains[39;49;00m[37m[39;49;00m$
    55^I[37m%% the list of "players" and calls the handler for client input.[39;49;00m[37m[39;49;00m$
    56^I[37m[39;49;00m$
    57^I[32mmaintain_clients[39;49;00m([31mPlayers[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    58^I[37m    [39;49;00m[04m[36mio[39;49;00m:[32mformat[39;49;00m([33m"[39;49;00m[33mPlayers:[39;49;00m[33m~n[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[]),[37m[39;49;00m$
    59^I[37m    [39;49;00m[04m[36mlists[39;49;00m:[32mforeach[39;49;00m([34mfun[39;49;00m([31mP[39;49;00m)[37m [39;49;00m->[37m [39;49;00m[04m[36mio[39;49;00m:[32mformat[39;49;00m([33m"[39;49;00m[33m>>> [39;49;00m[33m~w[39;49;00m[33m~n[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[[31mP[39;49;00m])[37m [39;49;00m[34mend[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m),[37m[39;49;00m$
    60^I[37m    [39;49;00m[34mreceive[39;49;00m[37m[39;49;00m$
    61^I[37m        [39;49;00m{connect,[37m [39;49;00m[31mSocket[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    62^I[37m            [39;49;00m[31mPlayer[39;49;00m[37m [39;49;00m=[37m [39;49;00m#player{socket=[31mSocket[39;49;00m,[37m [39;49;00mmode=connect},[37m[39;49;00m$
    63^I[37m            [39;49;00msend_prompt([31mPlayer[39;49;00m),[37m[39;49;00m$
    64^I[37m            [39;49;00m[04m[36mio[39;49;00m:[32mformat[39;49;00m([33m"[39;49;00m[33mclient connected: [39;49;00m[33m~w[39;49;00m[33m~n[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[[31mPlayer[39;49;00m]),[37m[39;49;00m$
    65^I[37m            [39;49;00m[31mNewPlayers[39;49;00m[37m [39;49;00m=[37m  [39;49;00m[[31mPlayer[39;49;00m[37m [39;49;00m|[37m [39;49;00m[31mPlayers[39;49;00m];[37m[39;49;00m$
    66^I[37m        [39;49;00m{disconnect,[37m [39;49;00m[31mSocket[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    67^I[37m            [39;49;00m[31mPlayer[39;49;00m[37m [39;49;00m=[37m [39;49;00mfind_player([31mSocket[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m),[37m[39;49;00m$
    68^I[37m            [39;49;00m[04m[36mio[39;49;00m:[32mformat[39;49;00m([33m"[39;49;00m[33mclient disconnected: [39;49;00m[33m~w[39;49;00m[33m~n[39;49;00m[33m"[39;49;00m,[37m [39;49;00m[[31mPlayer[39;49;00m]),[37m[39;49;00m$
    69^I[37m            [39;49;00m[31mNewPlayers[39;49;00m[37m [39;49;00m=[37m [39;49;00m[04m[36mlists[39;49;00m:[32mdelete[39;49;00m([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m);[37m[39;49;00m$
    70^I[37m        [39;49;00m{data,[37m [39;49;00m[31mSocket[39;49;00m,[37m [39;49;00m[31mData[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
    71^I[37m            [39;49;00m[31mPlayer[39;49;00m[37m [39;49;00m=[37m [39;49;00mfind_player([31mSocket[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m),[37m[39;49;00m$
    72^I[37m            [39;49;00m[31mNewPlayers[39;49;00m[37m [39;49;00m=[37m [39;49;00mparse_data([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m,[37m [39;49;00m[31mData[39;49;00m),[37m[39;49;00m$
    73^I[37m            [39;49;00m[31mNewPlayer[39;49;00m[37m [39;49;00m=[37m [39;49;00mfind_player([31mSocket[39;49;00m,[37m [39;49;00m[31mNewPlayers[39;49;00m),[37m[39;49;00m$
    74^I[37m            [39;49;00msend_prompt([31mNewPlayer[39;49;00m)[37m[39;49;00m$
    75^I[37m    [39;49;00m[34mend[39;49;00m,[37m[39;49;00m$
    76^I[37m    [39;49;00mmaintain_clients([31mNewPlayers[39;49;00m).[37m[39;49;00m$
    77^I[37m[39;49;00m$
    78^I[37m%% find_player is a utility function to get a player record associated[39;49;00m[37m[39;49;00m$
    79^I[37m%% with a particular socket out of the player list.[39;49;00m[37m[39;49;00m$
    80^I[37m[39;49;00m$
    81^I[32mfind_player[39;49;00m([31mSocket[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    82^I[37m    [39;49;00m{value,[37m [39;49;00m[31mPlayer[39;49;00m}[37m [39;49;00m=[37m [39;49;00m[04m[36mlists[39;49;00m:[32mkeysearch[39;49;00m([31mSocket[39;49;00m,[37m [39;49;00m#player.socket,[37m [39;49;00m[31mPlayers[39;49;00m),[37m[39;49;00m$
    83^I[37m    [39;49;00m[31mPlayer[39;49;00m.[37m[39;49;00m$
    84^I[37m[39;49;00m$
    85^I[37m%% delete_player returns the player list without the given player.  It[39;49;00m[37m[39;49;00m$
    86^I[37m%% deletes the player from the list based on the socket rather than[39;49;00m[37m[39;49;00m$
    87^I[37m%% the whole record because the list might hold a different version.[39;49;00m[37m[39;49;00m$
    88^I[37m[39;49;00m$
    89^I[32mdelete_player[39;49;00m([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    90^I[37m    [39;49;00m[04m[36mlists[39;49;00m:[32mkeydelete[39;49;00m([31mPlayer[39;49;00m#player.socket,[37m [39;49;00m#player.socket,[37m [39;49;00m[31mPlayers[39;49;00m).[37m[39;49;00m$
    91^I[37m[39;49;00m$
    92^I[37m%% Sends an appropriate prompt to the player.  Currently the only[39;49;00m[37m[39;49;00m$
    93^I[37m%% prompt we send is the initial "Name: " when the player connects.[39;49;00m[37m[39;49;00m$
    94^I[37m[39;49;00m$
    95^I[32msend_prompt[39;49;00m([31mPlayer[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
    96^I[37m    [39;49;00m[34mcase[39;49;00m[37m [39;49;00m[31mPlayer[39;49;00m#player.mode[37m [39;49;00m[34mof[39;49;00m[37m[39;49;00m$
    97^I[37m        [39;49;00mconnect[37m [39;49;00m->[37m[39;49;00m$
    98^I[37m            [39;49;00m[04m[36mgen_tcp[39;49;00m:[36msend[39;49;00m([31mPlayer[39;49;00m#player.socket,[37m [39;49;00m[33m"[39;49;00m[33mName: [39;49;00m[33m"[39;49;00m);[37m[39;49;00m$
    99^I[37m        [39;49;00mactive[37m [39;49;00m->[37m[39;49;00m$
   100^I[37m            [39;49;00mok[37m[39;49;00m$
   101^I[37m    [39;49;00m[34mend[39;49;00m.[37m[39;49;00m$
   102^I[37m[39;49;00m$
   103^I[37m%% Sends the given data to all players in active mode.[39;49;00m[37m[39;49;00m$
   104^I[37m[39;49;00m$
   105^I[32msend_to_active[39;49;00m([31mPrefix[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m,[37m [39;49;00m[31mData[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
   106^I[37m    [39;49;00m[31mActivePlayers[39;49;00m[37m [39;49;00m=[37m [39;49;00m[04m[36mlists[39;49;00m:[32mfilter[39;49;00m([34mfun[39;49;00m([31mP[39;49;00m)[37m [39;49;00m->[37m [39;49;00m[31mP[39;49;00m#player.mode[37m [39;49;00m==[37m [39;49;00mactive[37m [39;49;00m[34mend[39;49;00m,[37m[39;49;00m$
   107^I[37m                                 [39;49;00m[31mPlayers[39;49;00m),[37m[39;49;00m$
   108^I[37m    [39;49;00m[04m[36mlists[39;49;00m:[32mforeach[39;49;00m([34mfun[39;49;00m([31mP[39;49;00m)[37m [39;49;00m->[37m [39;49;00m[04m[36mgen_tcp[39;49;00m:[36msend[39;49;00m([31mP[39;49;00m#player.socket,[37m [39;49;00m[31mPrefix[39;49;00m[37m [39;49;00m++[37m [39;49;00m[31mData[39;49;00m)[37m [39;49;00m[34mend[39;49;00m,[37m[39;49;00m$
   109^I[37m                  [39;49;00m[31mActivePlayers[39;49;00m),[37m[39;49;00m$
   110^I[37m    [39;49;00mok.[37m[39;49;00m$
   111^I[37m[39;49;00m$
   112^I[37m%% We don't really do much parsing, but that will probably change as[39;49;00m[37m[39;49;00m$
   113^I[37m%% more features are added.  Currently this handles naming the player[39;49;00m[37m[39;49;00m$
   114^I[37m%% when he first connects and treats everything else as a message to[39;49;00m[37m[39;49;00m$
   115^I[37m%% send.[39;49;00m[37m[39;49;00m$
   116^I[37m[39;49;00m$
   117^I[32mparse_data[39;49;00m([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m,[37m [39;49;00m[31mData[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
   118^I[37m    [39;49;00m[34mcase[39;49;00m[37m [39;49;00m[31mPlayer[39;49;00m#player.mode[37m [39;49;00m[34mof[39;49;00m[37m[39;49;00m$
   119^I[37m        [39;49;00mactive[37m [39;49;00m->[37m[39;49;00m$
   120^I[37m            [39;49;00msend_to_active([31mPlayer[39;49;00m#player.name[37m [39;49;00m++[37m [39;49;00m[33m"[39;49;00m[33m: [39;49;00m[33m"[39;49;00m,[37m[39;49;00m$
   121^I[37m              [39;49;00mdelete_player([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m),[37m [39;49;00m[31mData[39;49;00m),[37m[39;49;00m$
   122^I[37m            [39;49;00m[31mPlayers[39;49;00m;[37m[39;49;00m$
   123^I[37m        [39;49;00mconnect[37m [39;49;00m->[37m[39;49;00m$
   124^I[37m            [39;49;00m[31mUPlayer[39;49;00m[37m [39;49;00m=[37m [39;49;00m[31mPlayer[39;49;00m#player{name=bogostrip([31mData[39;49;00m),[37m [39;49;00mmode=active},[37m[39;49;00m$
   125^I[37m            [39;49;00m[[31mUPlayer[39;49;00m[37m [39;49;00m|[37m [39;49;00mdelete_player([31mPlayer[39;49;00m,[37m [39;49;00m[31mPlayers[39;49;00m)][37m[39;49;00m$
   126^I[37m    [39;49;00m[34mend[39;49;00m.[37m[39;49;00m$
   127^I[37m[39;49;00m$
   128^I[37m%% Utility methods to clean up the name before we apply it.  Called[39;49;00m[37m[39;49;00m$
   129^I[37m%% bogostrip rather than strip because it returns the first continuous[39;49;00m[37m[39;49;00m$
   130^I[37m%% block of non-matching characters rather stripping matching[39;49;00m[37m[39;49;00m$
   131^I[37m%% characters off the front and back.[39;49;00m[37m[39;49;00m$
   132^I[37m[39;49;00m$
   133^I[32mbogostrip[39;49;00m([31mString[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
   134^I[37m    [39;49;00mbogostrip([31mString[39;49;00m,[37m [39;49;00m[33m"[39;49;00m[33m\r[39;49;00m[33m\n[39;49;00m[33m\t[39;49;00m[33m [39;49;00m[33m"[39;49;00m).[37m[39;49;00m$
   135^I[37m[39;49;00m$
   136^I[32mbogostrip[39;49;00m([31mString[39;49;00m,[37m [39;49;00m[31mChars[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
   137^I[37m    [39;49;00m[31mLStripped[39;49;00m[37m [39;49;00m=[37m [39;49;00m[04m[36mstring[39;49;00m:[32msubstr[39;49;00m([31mString[39;49;00m,[37m [39;49;00m[04m[36mstring[39;49;00m:[32mspan[39;49;00m([31mString[39;49;00m,[37m [39;49;00m[31mChars[39;49;00m)+[34m1[39;49;00m),[37m[39;49;00m$
   138^I[37m    [39;49;00m[04m[36mstring[39;49;00m:[32msubstr[39;49;00m([31mLStripped[39;49;00m,[37m [39;49;00m[34m1[39;49;00m,[37m [39;49;00m[04m[36mstring[39;49;00m:[32mcspan[39;49;00m([31mLStripped[39;49;00m,[37m [39;49;00m[31mChars[39;49;00m)).[37m[39;49;00m$
   139^I[37m[39;49;00m$
   140^I[37m%% Here we have some extra code to test other bits of pygments' Erlang[39;49;00m[37m[39;49;00m$
   141^I[37m%% lexer.[39;49;00m[37m[39;49;00m$
   142^I[37m[39;49;00m$
   143^I[32mget_timestamp[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   144^I[37m    [39;49;00m{{[31mYear[39;49;00m,[31mMonth[39;49;00m,[31mDay[39;49;00m},{[31mHour[39;49;00m,[31mMin[39;49;00m,[31mSec[39;49;00m}}[37m [39;49;00m=[37m [39;49;00m[04m[36merlang[39;49;00m:[32muniversaltime[39;49;00m(),[37m[39;49;00m$
   145^I[37m    [39;49;00m[04m[36mlists[39;49;00m:[32mflatten[39;49;00m([04m[36mio_lib[39;49;00m:[32mformat[39;49;00m([37m[39;49;00m$
   146^I[37m                    [39;49;00m[33m"[39;49;00m[33m~4.10.0B[39;49;00m[33m-[39;49;00m[33m~2.10.0B[39;49;00m[33m-[39;49;00m[33m~2.10.0B[39;49;00m[33mT[39;49;00m[33m~2.10.0B[39;49;00m[33m:[39;49;00m[33m~2.10.0B[39;49;00m[33m:[39;49;00m[33m~2.10.0B[39;49;00m[33mZ[39;49;00m[33m"[39;49;00m,[37m[39;49;00m$
   147^I[37m                    [39;49;00m[[31mYear[39;49;00m,[37m [39;49;00m[31mMonth[39;49;00m,[37m [39;49;00m[31mDay[39;49;00m,[37m [39;49;00m[31mHour[39;49;00m,[37m [39;49;00m[31mMin[39;49;00m,[37m [39;49;00m[31mSec[39;49;00m])).[37m[39;49;00m$
   148^I[37m[39;49;00m$
   149^I[32ma_binary[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   150^I[37m    [39;49;00m<<[37m [39;49;00m[34m100[39;49;00m:[34m16[39;49;00m/integer,[37m [39;49;00m[34m16#7f[39;49;00m[37m [39;49;00m>>.[37m[39;49;00m$
   151^I[37m[39;49;00m$
   152^I[32ma_list_comprehension[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   153^I[37m    [39;49;00m[[31mX[39;49;00m*[34m2[39;49;00m[37m [39;49;00m||[37m [39;49;00m[31mX[39;49;00m[37m [39;49;00m<-[37m [39;49;00m[[34m1[39;49;00m,[34m2[39;49;00m,[34m3[39;49;00m]].[37m[39;49;00m$
   154^I[37m[39;49;00m$
   155^I[32ma_map[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   156^I[37m    [39;49;00m[31mM0[39;49;00m[37m [39;49;00m=[37m [39;49;00m#{[37m [39;49;00ma[37m [39;49;00m=>[37m [39;49;00m[34m1[39;49;00m,[37m [39;49;00mb[37m [39;49;00m=>[37m [39;49;00m[34m2[39;49;00m[37m [39;49;00m},[37m[39;49;00m$
   157^I[37m    [39;49;00m[31mM1[39;49;00m[37m [39;49;00m=[37m [39;49;00m[31mM0[39;49;00m#{[37m [39;49;00mb[37m [39;49;00m:=[37m [39;49;00m[34m200[39;49;00m[37m [39;49;00m}.[37m[39;49;00m$
   158^I[37m[39;49;00m$
   159^I[32mescape_sequences[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   160^I[37m    [39;49;00m[[37m [39;49;00m[33m"[39;49;00m[33m\b[39;49;00m[33m\d[39;49;00m[33m\e[39;49;00m[33m\f[39;49;00m[33m\n[39;49;00m[33m\r[39;49;00m[33m\s[39;49;00m[33m\t[39;49;00m[33m\v[39;49;00m[33m\'[39;49;00m[33m\"[39;49;00m[33m\\[39;49;00m[33m"[39;49;00m[37m[39;49;00m$
   161^I[37m    [39;49;00m,[37m [39;49;00m[33m"[39;49;00m[33m\1[39;49;00m[33m\12[39;49;00m[33m\123[39;49;00m[33m"[39;49;00m[37m [39;49;00m[37m% octal[39;49;00m[37m[39;49;00m$
   162^I[37m    [39;49;00m,[37m [39;49;00m[33m"[39;49;00m[33m\x01[39;49;00m[33m"[39;49;00m[37m      [39;49;00m[37m% short hex[39;49;00m[37m[39;49;00m$
   163^I[37m    [39;49;00m,[37m [39;49;00m[33m"[39;49;00m[33m\x{fff}[39;49;00m[33m"[39;49;00m[37m   [39;49;00m[37m% long hex[39;49;00m[37m[39;49;00m$
   164^I[37m    [39;49;00m,[37m [39;49;00m[33m"[39;49;00m[33m\^a[39;49;00m[33m\^A[39;49;00m[33m"[39;49;00m[37m    [39;49;00m[37m% control characters[39;49;00m[37m[39;49;00m$
   165^I[37m    [39;49;00m].[37m[39;49;00m$
   166^I[37m[39;49;00m$
   167^I[32mmap[39;49;00m([31mFun[39;49;00m,[37m [39;49;00m[[31mH[39;49;00m|[31mT[39;49;00m])[37m [39;49;00m->[37m[39;49;00m$
   168^I[37m    [39;49;00m[[31mFun[39;49;00m([31mH[39;49;00m)[37m [39;49;00m|[37m [39;49;00mmap([31mFun[39;49;00m,[37m [39;49;00m[31mT[39;49;00m)];[37m[39;49;00m$
   169^I[37m[39;49;00m$
   170^I[32mmap[39;49;00m([31mFun[39;49;00m,[37m [39;49;00m[])[37m [39;49;00m->[37m[39;49;00m$
   171^I[37m    [39;49;00m[].[37m[39;49;00m$
   172^I[37m[39;49;00m$
   173^I[37m%% pmap, just because it's cool.[39;49;00m[37m[39;49;00m$
   174^I[37m[39;49;00m$
   175^I[32mpmap[39;49;00m([31mF[39;49;00m,[37m [39;49;00m[31mL[39;49;00m)[37m [39;49;00m->[37m[39;49;00m$
   176^I[37m    [39;49;00m[31mParent[39;49;00m[37m [39;49;00m=[37m [39;49;00mself(),[37m[39;49;00m$
   177^I[37m    [39;49;00m[[34mreceive[39;49;00m[37m [39;49;00m{[31mPid[39;49;00m,[37m [39;49;00m[31mResult[39;49;00m}[37m [39;49;00m->[37m[39;49;00m$
   178^I[37m             [39;49;00m[31mResult[39;49;00m[37m[39;49;00m$
   179^I[37m     [39;49;00m[34mend[39;49;00m[37m [39;49;00m||[37m [39;49;00m[31mPid[39;49;00m[37m [39;49;00m<-[37m [39;49;00m[[36mspawn[39;49;00m([34mfun[39;49;00m()[37m [39;49;00m->[37m[39;49;00m$
   180^I[37m                                  [39;49;00m[31mParent[39;49;00m[37m [39;49;00m![37m [39;49;00m{self(),[37m [39;49;00m[31mF[39;49;00m([31mX[39;49;00m)}[37m [39;49;00m$
   181^I[37m                          [39;49;00m[34mend[39;49;00m)[37m [39;49;00m||[37m [39;49;00m[31mX[39;49;00m[37m [39;49;00m<-[37m [39;49;00m[31mL[39;49;00m]].$
