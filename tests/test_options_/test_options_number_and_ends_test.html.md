     1	<[94mhtml[39;49;00m>$
     2	<[94mhead[39;49;00m>$
     3	<[94mscript[39;49;00m>[37m[39;49;00m$
     4	[37m    [39;49;00m[34mfunction[39;49;00m[37m [39;49;00minitCodeBlock(id);[37m [39;49;00m{[37m[39;49;00m$
     5	[37m        [39;49;00m[34mvar[39;49;00m[37m [39;49;00mel[37m [39;49;00m=[37m [39;49;00m[36mdocument[39;49;00m.getElementById(id);[37m[39;49;00m$
     6	[37m    [39;49;00m}[37m[39;49;00m$
     7	</[94mscript[39;49;00m>$
     8	<[94mstyle[39;49;00m>[37m[39;49;00m$
     9	.[04m[32msyntax[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mborder[39;49;00m:[37m [39;49;00m[34m1[39;49;00m[36mpx[39;49;00m[37m [39;49;00m[34msolid[39;49;00m[37m [39;49;00m[34m#d0d0d0[39;49;00m;[37m [39;49;00m[34mbackground-color[39;49;00m:[37m [39;49;00m[34m#f0f0f0[39;49;00m;[37m[39;49;00m$
    10	[37m          [39;49;00m[34mmargin-left[39;49;00m:[37m [39;49;00m[34m10[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-right[39;49;00m:[37m [39;49;00m[34m10[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    11	[37m[39;49;00m$
    12	.[04m[32msyntaxheader[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mmargin-top[39;49;00m:[37m [39;49;00m[34m15[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-bottom[39;49;00m:[37m [39;49;00m[34m0[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    13	[37m                [39;49;00m[34mtext-align[39;49;00m:[37m [39;49;00m[34mright[39;49;00m;[37m [39;49;00m[34mfont-size[39;49;00m:[37m [39;49;00m[34m11[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    14	[37m                [39;49;00m[34mborder-bottom[39;49;00m:[37m [39;49;00m[34m0[39;49;00m;[37m [39;49;00m[34mpadding[39;49;00m:[37m [39;49;00m[34m3[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    15	[37m[39;49;00m$
    16	.[04m[32mlinenos[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfloat[39;49;00m:[37m [39;49;00m[34mleft[39;49;00m;[37m [39;49;00m[34mdisplay[39;49;00m:[37m [39;49;00m[34mblock[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    17	.[04m[32mlinenos[39;49;00m[37m [39;49;00m[94mpre[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mpadding-right[39;49;00m:[37m [39;49;00m[34m7[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mpadding-left[39;49;00m:[37m [39;49;00m[34m7[39;49;00m[36mpx[39;49;00m;[37m[39;49;00m$
    18	[37m               [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#666[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    19	[37m[39;49;00m$
    20	[94mpre[39;49;00m.[04m[32msyntax[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mpadding[39;49;00m:[37m [39;49;00m[34m5[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m[34mmargin-top[39;49;00m:[37m [39;49;00m[34m0[39;49;00m[36mpx[39;49;00m;[37m [39;49;00m}[37m[39;49;00m$
    21	[37m[39;49;00m$
    22	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcm[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#60a0b0[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m              [39;49;00m[37m/* comments */[39;49;00m[37m[39;49;00m$
    23	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcm-proc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mnormal[39;49;00m;[37m [39;49;00m}[37m          [39;49;00m[37m/* preproc */[39;49;00m[37m[39;49;00m$
    24	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mkw[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m               [39;49;00m[37m/* keywords */[39;49;00m[37m[39;49;00m$
    25	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mkw-pseudo[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mnormal[39;49;00m;[37m [39;49;00m}[37m               [39;49;00m[37m/* pseudo keywords */[39;49;00m[37m[39;49;00m$
    26	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mop[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#666666[39;49;00m;[37m [39;49;00m}[37m                                 [39;49;00m[37m/* operators */[39;49;00m[37m[39;49;00m$
    27	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mop-word[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m    [39;49;00m[37m/* word operators */[39;49;00m[37m[39;49;00m$
    28	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mbn[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m}[37m                                  [39;49;00m[37m/* builtins */[39;49;00m[37m[39;49;00m$
    29	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mfun[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#06287e[39;49;00m;[37m [39;49;00m}[37m                                [39;49;00m[37m/* func name */[39;49;00m[37m[39;49;00m$
    30	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mcls[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#0e84b5[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* class names */[39;49;00m[37m[39;49;00m$
    31	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mexc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#007020[39;49;00m;[37m [39;49;00m}[37m                               [39;49;00m[37m/* exceptions */[39;49;00m[37m[39;49;00m$
    32	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mvar[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#bb60d5[39;49;00m;[37m [39;49;00m}[37m                                [39;49;00m[37m/* variables */[39;49;00m[37m[39;49;00m$
    33	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mconst[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#60add5[39;49;00m;[37m [39;49;00m}[37m                              [39;49;00m[37m/* constants */[39;49;00m[37m[39;49;00m$
    34	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mentity[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#d55537[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* entities */[39;49;00m[37m[39;49;00m$
    35	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mattr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m}[37m                              [39;49;00m[37m/* attributes */[39;49;00m[37m[39;49;00m$
    36	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mtag[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#062873[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m             [39;49;00m[37m/* tag names */[39;49;00m[37m[39;49;00m$
    37	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mdeco[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#555555[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m           [39;49;00m[37m/* decorators */[39;49;00m[37m[39;49;00m$
    38	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m}[37m                                   [39;49;00m[37m/* strings */[39;49;00m[37m[39;49;00m$
    39	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-int[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#70a0d0[39;49;00m;[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m  [39;49;00m[37m/* interpolated str */[39;49;00m[37m[39;49;00m$
    40	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-esc[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#4070a0[39;49;00m;[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m        [39;49;00m[37m/* escaped str */[39;49;00m[37m[39;49;00m$
    41	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-re[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#235388[39;49;00m;[37m [39;49;00m}[37m                           [39;49;00m[37m/* regular expr */[39;49;00m[37m[39;49;00m$
    42	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-sym[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#517918[39;49;00m;[37m [39;49;00m}[37m                               [39;49;00m[37m/* symbols */[39;49;00m[37m[39;49;00m$
    43	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mst-oth[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#c65d09[39;49;00m;[37m [39;49;00m}[37m                         [39;49;00m[37m/* other strings */[39;49;00m[37m[39;49;00m$
    44	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mnb[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34m#40a070[39;49;00m;[37m [39;49;00m}[37m                                   [39;49;00m[37m/* numbers */[39;49;00m[37m[39;49;00m$
    45	[37m[39;49;00m$
    46	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-hd[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mblue[39;49;00m;[37m [39;49;00m}[37m              [39;49;00m[37m/* headings */[39;49;00m[37m[39;49;00m$
    47	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-sh[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mpurple[39;49;00m;[37m [39;49;00m}[37m         [39;49;00m[37m/* subheadings */[39;49;00m[37m[39;49;00m$
    48	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-del[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mred[39;49;00m;[37m [39;49;00m}[37m                             [39;49;00m[37m/* deleted text */[39;49;00m[37m[39;49;00m$
    49	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-ins[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mcolor[39;49;00m:[37m [39;49;00m[34mgreen[39;49;00m;[37m [39;49;00m}[37m                          [39;49;00m[37m/* inserted text */[39;49;00m[37m[39;49;00m$
    50	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-em[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-style[39;49;00m:[37m [39;49;00m[34mitalic[39;49;00m;[37m [39;49;00m}[37m                   [39;49;00m[37m/* emphasized text */[39;49;00m[37m[39;49;00m$
    51	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32mgen-sr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mfont-weight[39;49;00m:[37m [39;49;00m[34mbold[39;49;00m;[37m [39;49;00m}[37m                  [39;49;00m[37m/* strong emph. text */[39;49;00m[37m[39;49;00m$
    52	[37m[39;49;00m$
    53	.[04m[32msyntax[39;49;00m[37m [39;49;00m.[04m[32merr[39;49;00m[37m [39;49;00m{[37m [39;49;00m[34mborder[39;49;00m:[37m [39;49;00m[34m1[39;49;00m[36mpx[39;49;00m[37m [39;49;00m[34msolid[39;49;00m[37m [39;49;00m[34mred[39;49;00m;[37m [39;49;00m}[37m                     [39;49;00m[37m/* parser errors */[39;49;00m[37m[39;49;00m$
    54	</[94mstyle[39;49;00m>$
    55	</[94mhead[39;49;00m>$
    56	<[94mbody[39;49;00m>$
    57	<[94mpre[39;49;00m [36mid[39;49;00m=[33m"code-block"[39;49;00m [36mclass[39;49;00m=[33m"syntax"[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># -*- coding: utf-8 -*-</[94mspan[39;49;00m>$
    58	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>$
    59	    pocoo.pkg.core.acl$
    60	    ~~~~~~~~~~~~~~~~~~$
    61	$
    62	    Pocoo ACL System.$
    63	$
    64	</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
    65	$
    66	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.db</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>$
    67	$
    68	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>$
    69	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Group</[94mspan[39;49;00m>$
    70	$
    71	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>from </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>pocoo.pkg.core.db</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m> import</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>, \$
    72	     <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_subjects</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_objects</[94mspan[39;49;00m>$
    73	$
    74	$
    75	<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>AclManager</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
    76	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>$
    77	    Manager object to manage ALCs.$
    78	    </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
    79	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m>$
    80	$
    81	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>$
    82	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m>$
    83	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>2</[94mspan[39;49;00m>$
    84	$
    85	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>__init__</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>):$
    86	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>$
    87	$
    88	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>$
    89	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>):$
    90	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
    91	$
    92	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Group</[94mspan[39;49;00m>):$
    93	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>group</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
    94	$
    95	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
    96	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>ValueError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>neither user or group specified</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
    97	$
    98	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>allow</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>False</[94mspan[39;49;00m>):$
    99	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Allows the subject privilege on obj.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   100	$
   101	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>+</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>bool</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m>))$
   102	$
   103	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>default</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   104	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Sets the state for privilege on obj back to weak yes.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   105	$
   106	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>)$
   107	$
   108	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>deny</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>False</[94mspan[39;49;00m>):$
   109	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Denies the subject privilege on obj.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   110	$
   111	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>1</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>-</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>bool</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>force</[94mspan[39;49;00m>))$
   112	$
   113	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>can_access</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   114	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Checks if the current subject with the required privilege$
   115	        somehow. Either directly or when the subject is a user and$
   116	        one of its groups can access it.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   117	$
   118	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m>#XXX: maybe this could be one big query instead of 4</[94mspan[39;49;00m>$
   119	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m>#XXX: this currently does not work correctly, therefore return True</[94mspan[39;49;00m>$
   120	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>True</[94mspan[39;49;00m>$
   121	$
   122	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>)):$
   123	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>TypeError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>obj must be a forum, thread or site</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
   124	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>upper</[94mspan[39;49;00m>()$
   125	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>s</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_subject_join</[94mspan[39;49;00m>().<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>$
   126	$
   127	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>):$
   128	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>$
   129	$
   130	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>o</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>).<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>$
   131	$
   132	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># self check</[94mspan[39;49;00m>$
   133	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   134	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   135	$
   136	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>s</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   137	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   138	$
   139	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   140	            ))$
   141	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   142	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   143	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>):$
   144	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>$
   145	$
   146	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>]$
   147	$
   148	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># if the controlled subject is a user check all groups</[94mspan[39;49;00m>$
   149	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>User</[94mspan[39;49;00m>):$
   150	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>db</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   151	                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>o</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   152	$
   153	                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   154	$
   155	                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   156	$
   157	                    (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_members</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>)$
   158	                ))$
   159	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>while</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>True</[94mspan[39;49;00m>:$
   160	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   161	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   162	                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>break</[94mspan[39;49;00m>$
   163	$
   164	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   165	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_NO</[94mspan[39;49;00m>):$
   166	                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>$
   167	$
   168	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   169	                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>$
   170	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_NO</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>and</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>:$
   171	                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>$
   172	$
   173	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># check related objects</[94mspan[39;49;00m>$
   174	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>):$
   175	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>)$
   176	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>):$
   177	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>)$
   178	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   179	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>tendency</[94mspan[39;49;00m>$
   180	$
   181	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>do_check</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>in</[94mspan[39;49;00m> (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>WEAK_YES</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>STRONG_YES</[94mspan[39;49;00m>)$
   182	$
   183	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>):$
   184	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Helper functions for settings privileges.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   185	$
   186	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>upper</[94mspan[39;49;00m>()$
   187	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   188	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_bootstrap</[94mspan[39;49;00m>()$
   189	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   190	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_bootstrap_object</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   191	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># special state &quot;0&quot; which means delete</[94mspan[39;49;00m>$
   192	$
   193	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>:$
   194	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>p</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>], <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   195	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>delete</[94mspan[39;49;00m>($
   196	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>p</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   197	$
   198	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   199	$
   200	                (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>)$
   201	            ))$
   202	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m>$
   203	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># touch privilege and check existing mapping</[94mspan[39;49;00m>$
   204	$
   205	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_fetch_privilege</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>)$
   206	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>],$
   207	            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   208	$
   209	            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>) <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>&amp;</[94mspan[39;49;00m>$
   210	$
   211	            (<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>)$
   212	        ))$
   213	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   214	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   215	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># this rule exists already</[94mspan[39;49;00m>$
   216	$
   217	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>state</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>] <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>:$
   218	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m>$
   219	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># goddamn, same rule - different state, delete old first</[94mspan[39;49;00m>$
   220	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_set</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privilege</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>)$
   221	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># insert new rule</[94mspan[39;49;00m>$
   222	$
   223	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_mapping</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   224	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>,$
   225	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>,$
   226	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>,$
   227	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>state</[94mspan[39;49;00m>$
   228	$
   229	        )$
   230	$
   231	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_bootstrap</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   232	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>This method is automatically called when subject_id is$
   233	        None and an subject_id is required.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   234	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_subjects</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   235	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>$
   236	$
   237	        )$
   238	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   239	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>save</[94mspan[39;49;00m>()$
   240	$
   241	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_bootstrap_object</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   242	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Like _bootstrap but works for objects.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   243	$
   244	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>objtype</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   245	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>acl_objects</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   246	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>objtype</[94mspan[39;49;00m>$
   247	$
   248	        )$
   249	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   250	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>save</[94mspan[39;49;00m>()$
   251	$
   252	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   253	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Forum</[94mspan[39;49;00m>):$
   254	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   255	$
   256	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>isinstance</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Thread</[94mspan[39;49;00m>):$
   257	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   258	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Site</[94mspan[39;49;00m>:$
   259	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>site</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>$
   260	$
   261	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>raise</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"exc"[39;49;00m>TypeError</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>obj isn</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-esc"[39;49;00m>\&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>t a forum or thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>)$
   262	$
   263	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_object_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>):$
   264	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns a subjoin for the object id.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   265	$
   266	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_get_object_type</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>)$
   267	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>forum</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   268	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>],$
   269	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forums</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>forum_id</[94mspan[39;49;00m>$
   270	$
   271	            )$
   272	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>elif</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>t</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>thread</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   273	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m>],$
   274	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>posts</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>post_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>obj</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>post_id</[94mspan[39;49;00m>$
   275	$
   276	            )$
   277	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   278	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># XXX: it works ^^</[94mspan[39;49;00m>$
   279	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cm"[39;49;00m># i really want something like meta.select(&#39;0 as group_id&#39;)</[94mspan[39;49;00m>$
   280	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>Fake</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   281	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>alias</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>n</[94mspan[39;49;00m>):$
   282	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>_C</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   283	                        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>class </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"cls"[39;49;00m>c</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn"[39;49;00m>object</[94mspan[39;49;00m>):$
   284	                            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>object_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>$
   285	$
   286	                    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_C</[94mspan[39;49;00m>$
   287	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>Fake</[94mspan[39;49;00m>()$
   288	$
   289	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_get_subject_join</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   290	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns a subjoin for the subject id.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   291	$
   292	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   293	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>],$
   294	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>users</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>$
   295	$
   296	            )$
   297	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>],$
   298	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>groups</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>$
   299	$
   300	        )$
   301	$
   302	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>_fetch_privilege</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>, <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>):$
   303	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>Returns the priv_id for the given privilege. If it$
   304	        doesn</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-esc"[39;49;00m>\&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>t exist by now the system will create a new$
   305	        privilege.</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-db"[39;49;00m>&quot;&quot;&quot;</[94mspan[39;49;00m>$
   306	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>meta</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>select</[94mspan[39;49;00m>([<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>priv_id</[94mspan[39;49;00m>],$
   307	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>c</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>$
   308	$
   309	        ))$
   310	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>fetchone</[94mspan[39;49;00m>()$
   311	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>not</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   312	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>row</[94mspan[39;49;00m>[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   313	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>ctx</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>engine</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>execute</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>privileges</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>insert</[94mspan[39;49;00m>(),$
   314	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>name</[94mspan[39;49;00m>$
   315	$
   316	        )$
   317	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>r</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>last_inserted_ids</[94mspan[39;49;00m>()[<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"nb nb-int"[39;49;00m>0</[94mspan[39;49;00m>]$
   318	$
   319	    <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>def </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"fun"[39;49;00m>__repr__</[94mspan[39;49;00m>(<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>):$
   320	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>==</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>user</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m>:$
   321	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>user_id</[94mspan[39;49;00m>$
   322	$
   323	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>else</[94mspan[39;49;00m>:$
   324	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>=</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>group_id</[94mspan[39;49;00m>$
   325	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>if</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op op-word"[39;49;00m>is</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>None</[94mspan[39;49;00m>:$
   326	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&lt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>:</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> inactive&gt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>%</[94mspan[39;49;00m> ($
   327	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__name__</[94mspan[39;49;00m>,$
   328	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>,$
   329	                <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m>$
   330	$
   331	            )$
   332	        <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"kw"[39;49;00m>return</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&lt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%s</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>:</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m> active as </[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-int"[39;49;00m>%d</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st"[39;49;00m>&gt;</[94mspan[39;49;00m><[94mspan[39;49;00m [36mclass[39;49;00m=[33m"st st-sg"[39;49;00m>&#39;</[94mspan[39;49;00m> <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"op"[39;49;00m>%</[94mspan[39;49;00m> ($
   333	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__class__</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>__name__</[94mspan[39;49;00m>,$
   334	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>_type</[94mspan[39;49;00m>,$
   335	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>id_</[94mspan[39;49;00m>,$
   336	            <[94mspan[39;49;00m [36mclass[39;49;00m=[33m"bn bn-pseudo"[39;49;00m>self</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject</[94mspan[39;49;00m>.<[94mspan[39;49;00m [36mclass[39;49;00m=[33m"name"[39;49;00m>subject_id</[94mspan[39;49;00m>$
   337	$
   338	        )$
