     1^I[37m;; A pretty-printer that outputs tables in Fennel syntax.[39;49;00m[37m[39;49;00m$
     2^I[37m;; Loosely based on inspect.lua: http://github.com/kikito/inspect.lua[39;49;00m[37m[39;49;00m$
     3^I[37m[39;49;00m$
     4^I([34mfn [39;49;00m[31mview-quote[39;49;00m[37m [39;49;00m[[31mstr[39;49;00m][37m [39;49;00m([34m.. [39;49;00m[33m"\""[39;49;00m[37m [39;49;00m([34m: [39;49;00m[31mstr[39;49;00m[37m [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"\""[39;49;00m[37m [39;49;00m[33m"\\\""[39;49;00m)[37m [39;49;00m[33m"\""[39;49;00m))[37m[39;49;00m$
     5^I[37m[39;49;00m$
     6^I([34mlocal [39;49;00m[31mshort-control-char-escapes[39;49;00m[37m[39;49;00m$
     7^I[37m       [39;49;00m{[33m"\a"[39;49;00m[37m [39;49;00m[33m"\\a"[39;49;00m[37m [39;49;00m[33m"\b"[39;49;00m[37m [39;49;00m[33m"\\b"[39;49;00m[37m [39;49;00m[33m"\f"[39;49;00m[37m [39;49;00m[33m"\\f"[39;49;00m[37m [39;49;00m[33m"\n"[39;49;00m[37m [39;49;00m[33m"\\n"[39;49;00m[37m[39;49;00m$
     8^I[37m        [39;49;00m[33m"\r"[39;49;00m[37m [39;49;00m[33m"\\r"[39;49;00m[37m [39;49;00m[33m"\t"[39;49;00m[37m [39;49;00m[33m"\\t"[39;49;00m[37m [39;49;00m[33m"\v"[39;49;00m[37m [39;49;00m[33m"\\v"[39;49;00m})[37m[39;49;00m$
     9^I[37m[39;49;00m$
    10^I([34mlocal [39;49;00m[31mlong-control-char-escapes[39;49;00m[37m[39;49;00m$
    11^I[37m       [39;49;00m([34mlet [39;49;00m[[31mlong[39;49;00m[37m [39;49;00m{}][37m[39;49;00m$
    12^I[37m         [39;49;00m([34mfor [39;49;00m[[31mi[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[34m31[39;49;00m][37m[39;49;00m$
    13^I[37m           [39;49;00m([34mlet [39;49;00m[[31mch[39;49;00m[37m [39;49;00m([31mstring.char[39;49;00m[37m [39;49;00m[31mi[39;49;00m)][37m[39;49;00m$
    14^I[37m             [39;49;00m([34mwhen [39;49;00m([34mnot [39;49;00m([34m. [39;49;00m[31mshort-control-char-escapes[39;49;00m[37m [39;49;00m[31mch[39;49;00m))[37m[39;49;00m$
    15^I[37m               [39;49;00m([34mtset [39;49;00m[31mshort-control-char-escapes[39;49;00m[37m [39;49;00m[31mch[39;49;00m[37m [39;49;00m([34m.. [39;49;00m[33m"\\"[39;49;00m[37m [39;49;00m[31mi[39;49;00m))[37m[39;49;00m$
    16^I[37m               [39;49;00m([34mtset [39;49;00m[31mlong[39;49;00m[37m [39;49;00m[31mch[39;49;00m[37m [39;49;00m([34m: [39;49;00m[33m"\\%03d"[39;49;00m[37m [39;49;00m[33m:format[39;49;00m[37m [39;49;00m[31mi[39;49;00m)))))[37m[39;49;00m$
    17^I[37m         [39;49;00m[31mlong[39;49;00m))[37m[39;49;00m$
    18^I[37m[39;49;00m$
    19^I([34mfn [39;49;00m[31mescape[39;49;00m[37m [39;49;00m[[31mstr[39;49;00m][37m[39;49;00m$
    20^I[37m  [39;49;00m([34m-> [39;49;00m[31mstr[39;49;00m[37m[39;49;00m$
    21^I[37m      [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"\\"[39;49;00m[37m [39;49;00m[33m"\\\\"[39;49;00m)[37m[39;49;00m$
    22^I[37m      [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"(%c)%f[0-9]"[39;49;00m[37m [39;49;00m[31mlong-control-char-escapes[39;49;00m)[37m[39;49;00m$
    23^I[37m      [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"%c"[39;49;00m[37m [39;49;00m[31mshort-control-char-escapes[39;49;00m)))[37m[39;49;00m$
    24^I[37m[39;49;00m$
    25^I([34mfn [39;49;00m[31msequence-key?[39;49;00m[37m [39;49;00m[[31mk[39;49;00m[37m [39;49;00m[31mlen[39;49;00m][37m[39;49;00m$
    26^I[37m  [39;49;00m([34mand [39;49;00m([34m= [39;49;00m([36mtype [39;49;00m[31mk[39;49;00m)[37m [39;49;00m[33m"number"[39;49;00m)[37m[39;49;00m$
    27^I[37m       [39;49;00m([34m<= [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31mk[39;49;00m)[37m[39;49;00m$
    28^I[37m       [39;49;00m([34m<= [39;49;00m[31mk[39;49;00m[37m [39;49;00m[31mlen[39;49;00m)[37m[39;49;00m$
    29^I[37m       [39;49;00m([34m= [39;49;00m([31mmath.floor[39;49;00m[37m [39;49;00m[31mk[39;49;00m)[37m [39;49;00m[31mk[39;49;00m)))[37m[39;49;00m$
    30^I[37m[39;49;00m$
    31^I([34mlocal [39;49;00m[31mtype-order[39;49;00m[37m [39;49;00m{[33m:number[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m[33m:boolean[39;49;00m[37m [39;49;00m[34m2[39;49;00m[37m [39;49;00m[33m:string[39;49;00m[37m [39;49;00m[34m3[39;49;00m[37m [39;49;00m[33m:table[39;49;00m[37m [39;49;00m[34m4[39;49;00m[37m[39;49;00m$
    32^I[37m                   [39;49;00m[33m:function[39;49;00m[37m [39;49;00m[34m5[39;49;00m[37m [39;49;00m[33m:userdata[39;49;00m[37m [39;49;00m[34m6[39;49;00m[37m [39;49;00m[33m:thread[39;49;00m[37m [39;49;00m[34m7[39;49;00m})[37m[39;49;00m$
    33^I[37m[39;49;00m$
    34^I([34mfn [39;49;00m[31msort-keys[39;49;00m[37m [39;49;00m[[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m][37m[39;49;00m$
    35^I[37m  [39;49;00m([34mlet [39;49;00m[[31mta[39;49;00m[37m [39;49;00m([36mtype [39;49;00m[31ma[39;49;00m)[37m [39;49;00m[31mtb[39;49;00m[37m [39;49;00m([36mtype [39;49;00m[31mb[39;49;00m)][37m[39;49;00m$
    36^I[37m    [39;49;00m([34mif [39;49;00m([34mand [39;49;00m([34m= [39;49;00m[31mta[39;49;00m[37m [39;49;00m[31mtb[39;49;00m)[37m[39;49;00m$
    37^I[37m             [39;49;00m([34mor [39;49;00m([34m= [39;49;00m[31mta[39;49;00m[37m [39;49;00m[33m"string"[39;49;00m)[37m [39;49;00m([34m= [39;49;00m[31mta[39;49;00m[37m [39;49;00m[33m"number"[39;49;00m)))[37m[39;49;00m$
    38^I[37m        [39;49;00m([34m< [39;49;00m[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)[37m[39;49;00m$
    39^I[37m        [39;49;00m([34mlet [39;49;00m[[31mdta[39;49;00m[37m [39;49;00m([34m. [39;49;00m[31mtype-order[39;49;00m[37m [39;49;00m[31ma[39;49;00m)[37m[39;49;00m$
    40^I[37m              [39;49;00m[31mdtb[39;49;00m[37m [39;49;00m([34m. [39;49;00m[31mtype-order[39;49;00m[37m [39;49;00m[31mb[39;49;00m)][37m[39;49;00m$
    41^I[37m          [39;49;00m([34mif [39;49;00m([34mand [39;49;00m[31mdta[39;49;00m[37m [39;49;00m[31mdtb[39;49;00m)[37m[39;49;00m$
    42^I[37m              [39;49;00m([34m< [39;49;00m[31mdta[39;49;00m[37m [39;49;00m[31mdtb[39;49;00m)[37m[39;49;00m$
    43^I[37m              [39;49;00m[31mdta[39;49;00m[37m [39;49;00m[31mtrue[39;49;00m[37m[39;49;00m$
    44^I[37m              [39;49;00m[31mdtb[39;49;00m[37m [39;49;00m[31mfalse[39;49;00m[37m[39;49;00m$
    45^I[37m              [39;49;00m[33m:else[39;49;00m[37m [39;49;00m([34m< [39;49;00m[31mta[39;49;00m[37m [39;49;00m[31mtb[39;49;00m))))))[37m[39;49;00m$
    46^I[37m[39;49;00m$
    47^I([34mfn [39;49;00m[31mget-sequence-length[39;49;00m[37m [39;49;00m[[31mt[39;49;00m][37m[39;49;00m$
    48^I[37m  [39;49;00m([34mvar [39;49;00m[31mlen[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m[39;49;00m$
    49^I[37m  [39;49;00m([34meach [39;49;00m[[31mi[39;49;00m[37m [39;49;00m([36mipairs [39;49;00m[31mt[39;49;00m)][37m [39;49;00m([34mset [39;49;00m[31mlen[39;49;00m[37m [39;49;00m[31mi[39;49;00m))[37m[39;49;00m$
    50^I[37m  [39;49;00m[31mlen[39;49;00m)[37m[39;49;00m$
    51^I[37m[39;49;00m$
    52^I([34mfn [39;49;00m[31mget-nonsequential-keys[39;49;00m[37m [39;49;00m[[31mt[39;49;00m][37m[39;49;00m$
    53^I[37m  [39;49;00m([34mlet [39;49;00m[[31mkeys[39;49;00m[37m [39;49;00m{}[37m[39;49;00m$
    54^I[37m        [39;49;00m[31msequence-length[39;49;00m[37m [39;49;00m([31mget-sequence-length[39;49;00m[37m [39;49;00m[31mt[39;49;00m)][37m[39;49;00m$
    55^I[37m    [39;49;00m([34meach [39;49;00m[[31mk[39;49;00m[37m [39;49;00m([36mpairs [39;49;00m[31mt[39;49;00m)][37m[39;49;00m$
    56^I[37m      [39;49;00m([34mwhen [39;49;00m([34mnot [39;49;00m([31msequence-key?[39;49;00m[37m [39;49;00m[31mk[39;49;00m[37m [39;49;00m[31msequence-length[39;49;00m))[37m[39;49;00m$
    57^I[37m        [39;49;00m([31mtable.insert[39;49;00m[37m [39;49;00m[31mkeys[39;49;00m[37m [39;49;00m[31mk[39;49;00m)))[37m[39;49;00m$
    58^I[37m    [39;49;00m([31mtable.sort[39;49;00m[37m [39;49;00m[31mkeys[39;49;00m[37m [39;49;00m[31msort-keys[39;49;00m)[37m[39;49;00m$
    59^I[37m    [39;49;00m([34mvalues [39;49;00m[31mkeys[39;49;00m[37m [39;49;00m[31msequence-length[39;49;00m)))[37m[39;49;00m$
    60^I[37m[39;49;00m$
    61^I([34mfn [39;49;00m[31mcount-table-appearances[39;49;00m[37m [39;49;00m[[31mt[39;49;00m[37m [39;49;00m[31mappearances[39;49;00m][37m[39;49;00m$
    62^I[37m  [39;49;00m([34mwhen [39;49;00m([34m= [39;49;00m([36mtype [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[33m"table"[39;49;00m)[37m[39;49;00m$
    63^I[37m    [39;49;00m([34mif [39;49;00m([34mnot [39;49;00m([34m. [39;49;00m[31mappearances[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
    64^I[37m        [39;49;00m([34mdo [39;49;00m([34mtset [39;49;00m[31mappearances[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m[39;49;00m$
    65^I[37m            [39;49;00m([34meach [39;49;00m[[31mk[39;49;00m[37m [39;49;00m[31mv[39;49;00m[37m [39;49;00m([36mpairs [39;49;00m[31mt[39;49;00m)][37m[39;49;00m$
    66^I[37m              [39;49;00m([31mcount-table-appearances[39;49;00m[37m [39;49;00m[31mk[39;49;00m[37m [39;49;00m[31mappearances[39;49;00m)[37m[39;49;00m$
    67^I[37m              [39;49;00m([31mcount-table-appearances[39;49;00m[37m [39;49;00m[31mv[39;49;00m[37m [39;49;00m[31mappearances[39;49;00m)))[37m[39;49;00m$
    68^I[37m        [39;49;00m([34mtset [39;49;00m[31mappearances[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m([34m+ [39;49;00m([34mor [39;49;00m([34m. [39;49;00m[31mappearances[39;49;00m[37m [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[34m1[39;49;00m))))[37m[39;49;00m$
    69^I[37m  [39;49;00m[31mappearances[39;49;00m)[37m[39;49;00m$
    70^I[37m[39;49;00m$
    71^I[37m[39;49;00m[37m[39;49;00m$
    72^I[37m[39;49;00m$
    73^I([34mvar [39;49;00m[31mput-value[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m[37m; mutual recursion going on; defined below[39;49;00m[37m[39;49;00m$
    74^I[37m[39;49;00m$
    75^I([34mfn [39;49;00m[31mputs[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31m...[39;49;00m][37m[39;49;00m$
    76^I[37m  [39;49;00m([34meach [39;49;00m[[31m_[39;49;00m[37m [39;49;00m[31mv[39;49;00m[37m [39;49;00m([36mipairs [39;49;00m[[31m...[39;49;00m])][37m[39;49;00m$
    77^I[37m    [39;49;00m([31mtable.insert[39;49;00m[37m [39;49;00m[31mself.buffer[39;49;00m[37m [39;49;00m[31mv[39;49;00m)))[37m[39;49;00m$
    78^I[37m[39;49;00m$
    79^I([34mfn [39;49;00m[31mtabify[39;49;00m[37m [39;49;00m[[31mself[39;49;00m][37m [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"\n"[39;49;00m[37m [39;49;00m([34m: [39;49;00m[31mself.indent[39;49;00m[37m [39;49;00m[33m:rep[39;49;00m[37m [39;49;00m[31mself.level[39;49;00m)))[37m[39;49;00m$
    80^I[37m[39;49;00m$
    81^I([34mfn [39;49;00m[31malready-visited?[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mv[39;49;00m][37m [39;49;00m([34mnot= [39;49;00m([34m. [39;49;00m[31mself.ids[39;49;00m[37m [39;49;00m[31mv[39;49;00m)[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
    82^I[37m[39;49;00m$
    83^I([34mfn [39;49;00m[31mget-id[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mv[39;49;00m][37m[39;49;00m$
    84^I[37m  [39;49;00m([34mvar [39;49;00m[31mid[39;49;00m[37m [39;49;00m([34m. [39;49;00m[31mself.ids[39;49;00m[37m [39;49;00m[31mv[39;49;00m))[37m[39;49;00m$
    85^I[37m  [39;49;00m([34mwhen [39;49;00m([34mnot [39;49;00m[31mid[39;49;00m)[37m[39;49;00m$
    86^I[37m    [39;49;00m([34mlet [39;49;00m[[31mtv[39;49;00m[37m [39;49;00m([36mtype [39;49;00m[31mv[39;49;00m)][37m[39;49;00m$
    87^I[37m      [39;49;00m([34mset [39;49;00m[31mid[39;49;00m[37m [39;49;00m([34m+ [39;49;00m([34mor [39;49;00m([34m. [39;49;00m[31mself.max-ids[39;49;00m[37m [39;49;00m[31mtv[39;49;00m)[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
    88^I[37m      [39;49;00m([34mtset [39;49;00m[31mself.max-ids[39;49;00m[37m [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[31mid[39;49;00m)[37m[39;49;00m$
    89^I[37m      [39;49;00m([34mtset [39;49;00m[31mself.ids[39;49;00m[37m [39;49;00m[31mv[39;49;00m[37m [39;49;00m[31mid[39;49;00m)))[37m[39;49;00m$
    90^I[37m  [39;49;00m([36mtostring [39;49;00m[31mid[39;49;00m))[37m[39;49;00m$
    91^I[37m[39;49;00m$
    92^I([34mfn [39;49;00m[31mput-sequential-table[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mlen[39;49;00m][37m[39;49;00m$
    93^I[37m  [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"["[39;49;00m)[37m[39;49;00m$
    94^I[37m  [39;49;00m([34mset [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m([34m+ [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
    95^I[37m  [39;49;00m([34mfor [39;49;00m[[31mi[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31mlen[39;49;00m][37m[39;49;00m$
    96^I[37m    [39;49;00m([34mwhen [39;49;00m([34m< [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31mi[39;49;00m[37m [39;49;00m([34m+ [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31mlen[39;49;00m))[37m[39;49;00m$
    97^I[37m      [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m" "[39;49;00m))[37m[39;49;00m$
    98^I[37m    [39;49;00m([31mput-value[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([34m. [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mi[39;49;00m)))[37m[39;49;00m$
    99^I[37m  [39;49;00m([34mset [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m([34m- [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
   100^I[37m  [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"]"[39;49;00m))[37m[39;49;00m$
   101^I[37m[39;49;00m$
   102^I([34mfn [39;49;00m[31mput-key[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mk[39;49;00m][37m[39;49;00m$
   103^I[37m  [39;49;00m([34mif [39;49;00m([34mand [39;49;00m([34m= [39;49;00m([36mtype [39;49;00m[31mk[39;49;00m)[37m [39;49;00m[33m"string"[39;49;00m)[37m[39;49;00m$
   104^I[37m           [39;49;00m([34m: [39;49;00m[31mk[39;49;00m[37m [39;49;00m[33m:find[39;49;00m[37m [39;49;00m[33m"^[-%w?\\^_!$%&*+./@:|<=>]+$"[39;49;00m))[37m[39;49;00m$
   105^I[37m      [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m":"[39;49;00m[37m [39;49;00m[31mk[39;49;00m)[37m[39;49;00m$
   106^I[37m      [39;49;00m([31mput-value[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mk[39;49;00m)))[37m[39;49;00m$
   107^I[37m[39;49;00m$
   108^I([34mfn [39;49;00m[31mput-kv-table[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mordered-keys[39;49;00m][37m[39;49;00m$
   109^I[37m  [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"{"[39;49;00m)[37m[39;49;00m$
   110^I[37m  [39;49;00m([34mset [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m([34m+ [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
   111^I[37m  [39;49;00m[37m;; first, output sorted nonsequential keys[39;49;00m[37m[39;49;00m$
   112^I[37m  [39;49;00m([34meach [39;49;00m[[31mi[39;49;00m[37m [39;49;00m[31mk[39;49;00m[37m [39;49;00m([36mipairs [39;49;00m[31mordered-keys[39;49;00m)][37m[39;49;00m$
   113^I[37m    [39;49;00m([34mwhen [39;49;00m([34mor [39;49;00m[31mself.table-edges[39;49;00m[37m [39;49;00m([34mnot= [39;49;00m[31mi[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
   114^I[37m      [39;49;00m([31mtabify[39;49;00m[37m [39;49;00m[31mself[39;49;00m))[37m[39;49;00m$
   115^I[37m    [39;49;00m([31mput-key[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mk[39;49;00m)[37m[39;49;00m$
   116^I[37m    [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m" "[39;49;00m)[37m[39;49;00m$
   117^I[37m    [39;49;00m([31mput-value[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([34m. [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mk[39;49;00m)))[37m[39;49;00m$
   118^I[37m  [39;49;00m[37m;; next, output any sequential keys[39;49;00m[37m[39;49;00m$
   119^I[37m  [39;49;00m([34meach [39;49;00m[[31mi[39;49;00m[37m [39;49;00m[31mv[39;49;00m[37m [39;49;00m([36mipairs [39;49;00m[31mt[39;49;00m)][37m[39;49;00m$
   120^I[37m    [39;49;00m([31mtabify[39;49;00m[37m [39;49;00m[31mself[39;49;00m)[37m[39;49;00m$
   121^I[37m    [39;49;00m([31mput-key[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mi[39;49;00m)[37m[39;49;00m$
   122^I[37m    [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m" "[39;49;00m)[37m[39;49;00m$
   123^I[37m    [39;49;00m([31mput-value[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mv[39;49;00m))[37m[39;49;00m$
   124^I[37m  [39;49;00m([34mset [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m([34m- [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m[39;49;00m$
   125^I[37m  [39;49;00m([34mwhen [39;49;00m[31mself.table-edges[39;49;00m[37m[39;49;00m$
   126^I[37m    [39;49;00m([31mtabify[39;49;00m[37m [39;49;00m[31mself[39;49;00m))[37m[39;49;00m$
   127^I[37m  [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"}"[39;49;00m))[37m[39;49;00m$
   128^I[37m[39;49;00m$
   129^I([34mfn [39;49;00m[31mput-table[39;49;00m[37m [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m][37m[39;49;00m$
   130^I[37m  [39;49;00m([34mlet [39;49;00m[[31mmetamethod[39;49;00m[37m [39;49;00m([34mand [39;49;00m[31mself.metamethod?[39;49;00m[37m [39;49;00m([34m-?> [39;49;00m[31mt[39;49;00m[37m [39;49;00m[36mgetmetatable [39;49;00m([34m. [39;49;00m[33m:__fennelview[39;49;00m)))][37m[39;49;00m$
   131^I[37m    [39;49;00m([34mif [39;49;00m([34mand [39;49;00m([31malready-visited?[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[31mself.detect-cycles?[39;49;00m)[37m[39;49;00m$
   132^I[37m        [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"#<table @"[39;49;00m[37m [39;49;00m([31mget-id[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[33m">"[39;49;00m)[37m[39;49;00m$
   133^I[37m        [39;49;00m([34m>= [39;49;00m[31mself.level[39;49;00m[37m [39;49;00m[31mself.depth[39;49;00m)[37m[39;49;00m$
   134^I[37m        [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"{...}"[39;49;00m)[37m[39;49;00m$
   135^I[37m        [39;49;00m[31mmetamethod[39;49;00m[37m[39;49;00m$
   136^I[37m        [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([31mmetamethod[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mself.fennelview[39;49;00m))[37m[39;49;00m$
   137^I[37m        [39;49;00m[33m:else[39;49;00m[37m[39;49;00m$
   138^I[37m        [39;49;00m([34mlet [39;49;00m[([31mnon-seq-keys[39;49;00m[37m [39;49;00m[31mlen[39;49;00m)[37m [39;49;00m([31mget-nonsequential-keys[39;49;00m[37m [39;49;00m[31mt[39;49;00m)[37m[39;49;00m$
   139^I[37m              [39;49;00m[31mid[39;49;00m[37m [39;49;00m([31mget-id[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m)][37m[39;49;00m$
   140^I[37m          [39;49;00m[37m;; fancy metatable stuff can result in self.appearances not including[39;49;00m[37m[39;49;00m$
   141^I[37m          [39;49;00m[37m;; a table, so if it's not found, assume we haven't seen it; we can't[39;49;00m[37m[39;49;00m$
   142^I[37m          [39;49;00m[37m;; do cycle detection in that case.[39;49;00m[37m[39;49;00m$
   143^I[37m          [39;49;00m([34mwhen [39;49;00m([34mand [39;49;00m([34m< [39;49;00m[34m1[39;49;00m[37m [39;49;00m([34mor [39;49;00m([34m. [39;49;00m[31mself.appearances[39;49;00m[37m [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[31mself.detect-cycles?[39;49;00m)[37m[39;49;00m$
   144^I[37m            [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"@"[39;49;00m[37m [39;49;00m[31mid[39;49;00m))[37m[39;49;00m$
   145^I[37m          [39;49;00m([34mif [39;49;00m([34mand [39;49;00m([34m= [39;49;00m([34mlength [39;49;00m[31mnon-seq-keys[39;49;00m)[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([34m= [39;49;00m([34mlength [39;49;00m[31mt[39;49;00m)[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m$
   146^I[37m              [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([34mif [39;49;00m[31mself.empty-as-square[39;49;00m[37m [39;49;00m[33m"[]"[39;49;00m[37m [39;49;00m[33m"{}"[39;49;00m))[37m[39;49;00m$
   147^I[37m              [39;49;00m([34m= [39;49;00m([34mlength [39;49;00m[31mnon-seq-keys[39;49;00m)[37m [39;49;00m[34m0[39;49;00m)[37m[39;49;00m$
   148^I[37m              [39;49;00m([31mput-sequential-table[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mlen[39;49;00m)[37m[39;49;00m$
   149^I[37m              [39;49;00m[33m:else[39;49;00m[37m[39;49;00m$
   150^I[37m              [39;49;00m([31mput-kv-table[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mnon-seq-keys[39;49;00m))))))[37m[39;49;00m$
   151^I[37m[39;49;00m$
   152^I([34mset [39;49;00m[31mput-value[39;49;00m[37m [39;49;00m([34mfn [39;49;00m[[31mself[39;49;00m[37m [39;49;00m[31mv[39;49;00m][37m[39;49;00m$
   153^I[37m                 [39;49;00m([34mlet [39;49;00m[[31mtv[39;49;00m[37m [39;49;00m([36mtype [39;49;00m[31mv[39;49;00m)][37m[39;49;00m$
   154^I[37m                   [39;49;00m([34mif [39;49;00m([34m= [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[33m"string"[39;49;00m)[37m[39;49;00m$
   155^I[37m                       [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([31mview-quote[39;49;00m[37m [39;49;00m([31mescape[39;49;00m[37m [39;49;00m[31mv[39;49;00m)))[37m[39;49;00m$
   156^I[37m                       [39;49;00m([34mor [39;49;00m([34m= [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[33m"number"[39;49;00m)[37m [39;49;00m([34m= [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[33m"boolean"[39;49;00m)[37m [39;49;00m([34m= [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[33m"nil"[39;49;00m))[37m[39;49;00m$
   157^I[37m                       [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m([36mtostring [39;49;00m[31mv[39;49;00m))[37m[39;49;00m$
   158^I[37m                       [39;49;00m([34m= [39;49;00m[31mtv[39;49;00m[37m [39;49;00m[33m"table"[39;49;00m)[37m[39;49;00m$
   159^I[37m                       [39;49;00m([31mput-table[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[31mv[39;49;00m)[37m[39;49;00m$
   160^I[37m                       [39;49;00m[33m:else[39;49;00m[37m[39;49;00m$
   161^I[37m                       [39;49;00m([31mputs[39;49;00m[37m [39;49;00m[31mself[39;49;00m[37m [39;49;00m[33m"#<"[39;49;00m[37m [39;49;00m([36mtostring [39;49;00m[31mv[39;49;00m)[37m [39;49;00m[33m">"[39;49;00m)))))[37m[39;49;00m$
   162^I[37m[39;49;00m$
   163^I[37m[39;49;00m[37m[39;49;00m$
   164^I[37m[39;49;00m$
   165^I([34mfn [39;49;00m[31mone-line[39;49;00m[37m [39;49;00m[[31mstr[39;49;00m][37m[39;49;00m$
   166^I[37m  [39;49;00m[37m;; save return value as local to ignore gsub's extra return value[39;49;00m[37m[39;49;00m$
   167^I[37m  [39;49;00m([34mlet [39;49;00m[[31mret[39;49;00m[37m [39;49;00m([34m-> [39;49;00m[31mstr[39;49;00m[37m[39;49;00m$
   168^I[37m                [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"\n"[39;49;00m[37m [39;49;00m[33m" "[39;49;00m)[37m[39;49;00m$
   169^I[37m                [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"%[ "[39;49;00m[37m [39;49;00m[33m"["[39;49;00m)[37m [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m" %]"[39;49;00m[37m [39;49;00m[33m"]"[39;49;00m)[37m[39;49;00m$
   170^I[37m                [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"%{ "[39;49;00m[37m [39;49;00m[33m"{"[39;49;00m)[37m [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m" %}"[39;49;00m[37m [39;49;00m[33m"}"[39;49;00m)[37m[39;49;00m$
   171^I[37m                [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m"%( "[39;49;00m[37m [39;49;00m[33m"("[39;49;00m)[37m [39;49;00m([34m: [39;49;00m[33m:gsub[39;49;00m[37m [39;49;00m[33m" %)"[39;49;00m[37m [39;49;00m[33m")"[39;49;00m))][37m[39;49;00m$
   172^I[37m    [39;49;00m[31mret[39;49;00m))[37m[39;49;00m$
   173^I[37m[39;49;00m$
   174^I([34mfn [39;49;00m[31mfennelview[39;49;00m[37m [39;49;00m[[31mx[39;49;00m[37m [39;49;00m[31moptions[39;49;00m][37m[39;49;00m$
   175^I[37m  [39;49;00m[33m"Return a string representation of x.[39;49;00m$
   176^I[33m[39;49;00m$
   177^I[33mCan take an options table with these keys:[39;49;00m$
   178^I[33m* :one-line (boolean: default: false) keep the output string as a one-liner[39;49;00m$
   179^I[33m* :depth (number, default: 128) limit how many levels to go (default: 128)[39;49;00m$
   180^I[33m* :indent (string, default: \"  \") use this string to indent each level[39;49;00m$
   181^I[33m* :detect-cycles? (boolean, default: true) don't try to traverse a looping table[39;49;00m$
   182^I[33m* :metamethod? (boolean: default: true) use the __fennelview metamethod if found[39;49;00m$
   183^I[33m* :table-edges (boolean: default: true) put {} table brackets on their own line[39;49;00m$
   184^I[33m* :empty-as-square (boolean: default: false) render empty tables as [], not {}[39;49;00m$
   185^I[33m[39;49;00m$
   186^I[33mThe __fennelview metamethod should take the table being serialized as its first[39;49;00m$
   187^I[33margument and a function as its second arg which can be used on table elements to[39;49;00m$
   188^I[33mcontinue the fennelview process on them.[39;49;00m$
   189^I[33m"[39;49;00m[37m[39;49;00m$
   190^I[37m  [39;49;00m([34mlet [39;49;00m[[31moptions[39;49;00m[37m [39;49;00m([34mor [39;49;00m[31moptions[39;49;00m[37m [39;49;00m{})[37m[39;49;00m$
   191^I[37m        [39;49;00m[31minspector[39;49;00m[37m [39;49;00m{[33m:appearances[39;49;00m[37m [39;49;00m([31mcount-table-appearances[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m{})[37m[39;49;00m$
   192^I[37m                   [39;49;00m[33m:depth[39;49;00m[37m [39;49;00m([34mor [39;49;00m[31moptions.depth[39;49;00m[37m [39;49;00m[34m128[39;49;00m)[37m[39;49;00m$
   193^I[37m                   [39;49;00m[33m:level[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[33m:buffer[39;49;00m[37m [39;49;00m{}[37m [39;49;00m[33m:ids[39;49;00m[37m [39;49;00m{}[37m [39;49;00m[33m:max-ids[39;49;00m[37m [39;49;00m{}[37m[39;49;00m$
   194^I[37m                   [39;49;00m[33m:indent[39;49;00m[37m [39;49;00m([34mor [39;49;00m[31moptions.indent[39;49;00m[37m [39;49;00m([34mif [39;49;00m[31moptions.one-line[39;49;00m[37m [39;49;00m[33m""[39;49;00m[37m [39;49;00m[33m"  "[39;49;00m))[37m[39;49;00m$
   195^I[37m                   [39;49;00m[33m:detect-cycles?[39;49;00m[37m [39;49;00m([34mnot [39;49;00m([34m= [39;49;00m[31mfalse[39;49;00m[37m [39;49;00m[31moptions.detect-cycles?[39;49;00m))[37m[39;49;00m$
   196^I[37m                   [39;49;00m[33m:metamethod?[39;49;00m[37m [39;49;00m([34mnot [39;49;00m([34m= [39;49;00m[31mfalse[39;49;00m[37m [39;49;00m[31moptions.metamethod?[39;49;00m))[37m[39;49;00m$
   197^I[37m                   [39;49;00m[33m:fennelview[39;49;00m[37m [39;49;00m#([31mfennelview[39;49;00m[37m [39;49;00m[31m$1[39;49;00m[37m [39;49;00m[31moptions[39;49;00m)[37m[39;49;00m$
   198^I[37m                   [39;49;00m[33m:table-edges[39;49;00m[37m [39;49;00m([34mnot= [39;49;00m[31moptions.table-edges[39;49;00m[37m [39;49;00m[31mfalse[39;49;00m)[37m[39;49;00m$
   199^I[37m                   [39;49;00m[33m:empty-as-square[39;49;00m[37m [39;49;00m[31moptions.empty-as-square[39;49;00m}][37m[39;49;00m$
   200^I[37m    [39;49;00m([31mput-value[39;49;00m[37m [39;49;00m[31minspector[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   201^I[37m    [39;49;00m([34mlet [39;49;00m[[31mstr[39;49;00m[37m [39;49;00m([31mtable.concat[39;49;00m[37m [39;49;00m[31minspector.buffer[39;49;00m)][37m[39;49;00m$
   202^I[37m      [39;49;00m([34mif [39;49;00m[31moptions.one-line[39;49;00m[37m [39;49;00m([31mone-line[39;49;00m[37m [39;49;00m[31mstr[39;49;00m)[37m [39;49;00m[31mstr[39;49;00m))))$
