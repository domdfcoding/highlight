     1	[36m#[39;49;00m[36minclude[39;49;00m[37m [39;49;00m[37m<stdio.h>[39;49;00m[36m[39;49;00m
     2	[37m[39;49;00m
     3	[37m// __device__ function[39;49;00m
     4	[36m__device__[39;49;00m[37m [39;49;00m[36mvoid[39;49;00m[37m [39;49;00mfunc()[37m[39;49;00m
     5	{[37m[39;49;00m
     6	[37m    [39;49;00m[36mshort[39;49;00m*[37m [39;49;00marray0[37m [39;49;00m=[37m [39;49;00m([36mshort[39;49;00m*)array;[37m[39;49;00m
     7	[37m    [39;49;00m[36mfloat[39;49;00m*[37m [39;49;00marray1[37m [39;49;00m=[37m [39;49;00m([36mfloat[39;49;00m*)&array0[[34m127[39;49;00m];[37m[39;49;00m
     8	}[37m[39;49;00m
     9	[37m[39;49;00m
    10	[37m/* __global__ function */[39;49;00m[37m[39;49;00m
    11	[34m__global__[39;49;00m[37m [39;49;00m[34mstatic[39;49;00m[37m [39;49;00m[36mvoid[39;49;00m[37m [39;49;00mreduction([34mconst[39;49;00m[37m [39;49;00m[36mfloat[39;49;00m*[37m [39;49;00m[36m__restrict__[39;49;00m[37m [39;49;00minput,[37m [39;49;00m[36mfloat[39;49;00m[37m [39;49;00m*output,[37m [39;49;00m[36mclock_t[39;49;00m[37m [39;49;00m*timer)[37m[39;49;00m
    12	{[37m[39;49;00m
    13	[37m    [39;49;00m[37m// __shared__ float shared[2 * blockDim.x];[39;49;00m
    14	[37m    [39;49;00m[34mextern[39;49;00m[37m [39;49;00m[36m__shared__[39;49;00m[37m [39;49;00m[36mfloat[39;49;00m[37m [39;49;00mshared[];[37m[39;49;00m
    15	[37m[39;49;00m
    16	[37m    [39;49;00m[34mconst[39;49;00m[37m [39;49;00m[36mint[39;49;00m[37m [39;49;00mtid[37m [39;49;00m=[37m [39;49;00m[36mthreadIdx[39;49;00m.x;[37m[39;49;00m
    17	[37m    [39;49;00m[34mconst[39;49;00m[37m [39;49;00m[36mint[39;49;00m[37m [39;49;00mbid[37m [39;49;00m=[37m [39;49;00m[36mblockIdx[39;49;00m.x;[37m[39;49;00m
    18	[37m    [39;49;00m[37m[39;49;00m
    19	[37m    [39;49;00m[34mif[39;49;00m[37m [39;49;00m([36mthreadIdx[39;49;00m.x[37m [39;49;00m==[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m{[37m[39;49;00m
    20	[37m        [39;49;00m[32m__threadfence[39;49;00m();[37m[39;49;00m
    21	[37m    [39;49;00m}[37m[39;49;00m
    22	[37m[39;49;00m
    23	[37m    [39;49;00m[37m// Perform reduction to find minimum.[39;49;00m
    24	[37m    [39;49;00m[34mfor[39;49;00m[37m [39;49;00m([36mint[39;49;00m[37m [39;49;00md[37m [39;49;00m=[37m [39;49;00m[36mblockDim[39;49;00m.x;[37m [39;49;00md[37m [39;49;00m>[37m [39;49;00m[34m0[39;49;00m;[37m [39;49;00md[37m [39;49;00m/=[37m [39;49;00m[34m2[39;49;00m)[37m[39;49;00m
    25	[37m    [39;49;00m{[37m[39;49;00m
    26	[37m        [39;49;00m[32m__syncthreads[39;49;00m();[37m[39;49;00m
    27	[37m    [39;49;00m}[37m[39;49;00m
    28	}[37m[39;49;00m
    29	[37m[39;49;00m
    30	[36mint[39;49;00m[37m [39;49;00mmain([36mint[39;49;00m[37m [39;49;00margc,[37m [39;49;00m[36mchar[39;49;00m[37m [39;49;00m**argv)[37m[39;49;00m
    31	{[37m[39;49;00m
    32	[37m    [39;49;00m[36mdim3[39;49;00m[37m [39;49;00m[32mdimBlock[39;49;00m([34m8[39;49;00m,[37m [39;49;00m[34m8[39;49;00m,[37m [39;49;00m[34m1[39;49;00m);[37m[39;49;00m
    33	[37m[39;49;00m
    34	[37m    [39;49;00mtimedReduction<<<dimBlock,[37m [39;49;00m[34m256[39;49;00m,[37m [39;49;00m[34m256[39;49;00m,[37m [39;49;00m[34m0[39;49;00m>>>(dinput,[37m [39;49;00mdoutput,[37m [39;49;00mdtimer);[37m[39;49;00m
    35	[37m    [39;49;00mcudaDeviceReset();[37m[39;49;00m
    36	}
