     1^I[36m#!/usr/bin/env newlisp[39;49;00m[37m[39;49;00m$
     2^I[37m;; @module reversi.lsp[39;49;00m[37m[39;49;00m$
     3^I[37m;; @description a simple version of Reversi: you as white against newLISP as black[39;49;00m[37m[39;49;00m$
     4^I[37m;; @version 0.1 alpha August 2007[39;49;00m[37m[39;49;00m$
     5^I[37m;; @author cormullion[39;49;00m[37m[39;49;00m$
     6^I[37m;;[39;49;00m[37m[39;49;00m$
     7^I[37m;; 2008-10-08 21:46:54[39;49;00m[37m[39;49;00m$
     8^I[37m;; updated for newLISP version 10. (changed nth-set to setf)[39;49;00m[37m[39;49;00m$
     9^I[37m;; this now does not work with newLISP version 9![39;49;00m[37m[39;49;00m$
    10^I[37m;;[39;49;00m[37m[39;49;00m$
    11^I[37m;; This is my first attempt at writing a simple application using newLISP-GS.[39;49;00m[37m[39;49;00m$
    12^I[37m;; The game algorithms are basically by [39;49;00m[37m[39;49;00m$
    13^I[37m;; Peter Norvig http://norvig.com/paip/othello.lisp[39;49;00m[37m[39;49;00m$
    14^I[37m;; and all I've done is translate to newLISP and add the interface...[39;49;00m[37m[39;49;00m$
    15^I[37m;;[39;49;00m[37m[39;49;00m$
    16^I[37m;; To-Do: work out how to handle the end of the game properly...[39;49;00m[37m[39;49;00m$
    17^I[37m;; To-Do: complete newlispdoc for the functions[39;49;00m[37m[39;49;00m$
    18^I[37m[39;49;00m$
    19^I([34mconstant[39;49;00m[37m [39;49;00m'[33mempty[39;49;00m[37m [39;49;00m[33m0[39;49;00m)[37m [39;49;00m$
    20^I([34mconstant[39;49;00m[37m [39;49;00m'[33mblack[39;49;00m[37m [39;49;00m[33m1[39;49;00m)[37m [39;49;00m$
    21^I([34mconstant[39;49;00m[37m [39;49;00m'[33mwhite[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
    22^I([34mconstant[39;49;00m[37m [39;49;00m'[33mouter[39;49;00m[37m [39;49;00m[33m3[39;49;00m)[37m [39;49;00m[37m; squares outside the 8x8 board[39;49;00m[37m[39;49;00m$
    23^I[37m[39;49;00m$
    24^I([34mset[39;49;00m[37m [39;49;00m'[34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m'())[37m [39;49;00m[37m; the master board is a 100 element list[39;49;00m[37m[39;49;00m$
    25^I([34mset[39;49;00m[37m [39;49;00m'[34m*[39;49;00m[33mmoves*[39;49;00m[37m [39;49;00m'())[37m [39;49;00m[37m; list of moves made[39;49;00m[37m[39;49;00m$
    26^I[37m[39;49;00m$
    27^I[37m; these are the 8 different directions from a square on the board[39;49;00m[37m[39;49;00m$
    28^I[37m[39;49;00m$
    29^I([34mset[39;49;00m[37m [39;49;00m'[33mall-directions[39;49;00m[37m [39;49;00m'([34m-[39;49;00m[33m11[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m10[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m9[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m1[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m [39;49;00m[33m9[39;49;00m[37m [39;49;00m[33m10[39;49;00m[37m [39;49;00m[33m11[39;49;00m))[37m[39;49;00m$
    30^I[37m[39;49;00m$
    31^I[37m; return a list of all the playable squares (the 8 by 8 grid inside the 10by10[39;49;00m[37m[39;49;00m$
    32^I[37m[39;49;00m$
    33^I([34mdefine[39;49;00m[37m [39;49;00m([31mall-squares[39;49;00m)[37m[39;49;00m$
    34^I[37m  [39;49;00m([34mlocal[39;49;00m[37m [39;49;00m([31mresult[39;49;00m)[37m[39;49;00m$
    35^I[37m     [39;49;00m([34mfor[39;49;00m[37m [39;49;00m([31msquare[39;49;00m[37m [39;49;00m[33m11[39;49;00m[37m [39;49;00m[33m88[39;49;00m)[37m[39;49;00m$
    36^I[37m        [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31m<=[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m [39;49;00m([34mmod[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33m10[39;49;00m)[37m [39;49;00m[33m8[39;49;00m)[37m[39;49;00m$
    37^I[37m           [39;49;00m([34mpush[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33mresult[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m1[39;49;00m)))[37m[39;49;00m$
    38^I[33mresult[39;49;00m))[37m[39;49;00m$
    39^I[37m[39;49;00m$
    40^I[37m; make a board[39;49;00m[37m[39;49;00m$
    41^I[37m[39;49;00m$
    42^I([34mdefine[39;49;00m[37m [39;49;00m([31mmake-board[39;49;00m)[37m[39;49;00m$
    43^I[37m  [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m([34mdup[39;49;00m[37m [39;49;00m[33mouter[39;49;00m[37m [39;49;00m[33m100[39;49;00m))[37m[39;49;00m$
    44^I[37m  [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31ms[39;49;00m[37m [39;49;00m([31mall-squares[39;49;00m))[37m[39;49;00m$
    45^I[37m     [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33ms[39;49;00m)[37m [39;49;00m[33mempty[39;49;00m)))[37m[39;49;00m$
    46^I[37m[39;49;00m$
    47^I[37m; for testing and working at a terminal[39;49;00m[37m[39;49;00m$
    48^I[37m[39;49;00m$
    49^I([34mdefine[39;49;00m[37m [39;49;00m([34mprint[39;49;00m[34m-[39;49;00m[33mboard[39;49;00m)[37m[39;49;00m$
    50^I[37m  [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33m [39;49;00m[33m}[39;49;00m)[37m[39;49;00m$
    51^I[37m  [39;49;00m([34mfor[39;49;00m[37m [39;49;00m([31mc[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m [39;49;00m[33m8[39;49;00m)[37m[39;49;00m$
    52^I[37m     [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33mc[39;49;00m))[37m[39;49;00m$
    53^I[37m  [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mc[39;49;00m[37m [39;49;00m[33m0[39;49;00m)[37m[39;49;00m$
    54^I[37m  [39;49;00m([34mfor[39;49;00m[37m [39;49;00m([31mi[39;49;00m[37m [39;49;00m[33m0[39;49;00m[37m [39;49;00m[33m99[39;49;00m)[37m[39;49;00m$
    55^I[37m     [39;49;00m([34mcond[39;49;00m[37m[39;49;00m$
    56^I[37m        [39;49;00m(([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mi[39;49;00m)[37m [39;49;00m[33m0[39;49;00m)[37m [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33m.[39;49;00m[33m}[39;49;00m))[37m[39;49;00m$
    57^I[37m        [39;49;00m(([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mi[39;49;00m)[37m [39;49;00m[33m1[39;49;00m)[37m [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mb[39;49;00m[33m}[39;49;00m))[37m[39;49;00m$
    58^I[37m        [39;49;00m(([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mi[39;49;00m)[37m [39;49;00m[33m2[39;49;00m)[37m [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mw[39;49;00m[33m}[39;49;00m)))[37m[39;49;00m$
    59^I[37m     [39;49;00m([34mif[39;49;00m[37m [39;49;00m([34mand[39;49;00m[37m [39;49;00m([31m<=[39;49;00m[37m [39;49;00m[33mi[39;49;00m[37m [39;49;00m[33m88[39;49;00m)[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m([34mmod[39;49;00m[37m [39;49;00m([31m+[39;49;00m[37m [39;49;00m[33mi[39;49;00m[37m [39;49;00m[33m1[39;49;00m)[37m [39;49;00m[33m10[39;49;00m)[37m [39;49;00m[33m0[39;49;00m))[37m [39;49;00m[37m; newline[39;49;00m[37m[39;49;00m$
    60^I[37m        [39;49;00m([34mprint[39;49;00m[37m [39;49;00m[33m"\n"[39;49;00m[37m [39;49;00m([34minc[39;49;00m[37m [39;49;00m[33mc[39;49;00m))))[37m[39;49;00m$
    61^I[37m  [39;49;00m([34mprintln[39;49;00m[37m [39;49;00m[33m"\n"[39;49;00m))[37m[39;49;00m$
    62^I[37m[39;49;00m$
    63^I[37m; the initial starting pattern[39;49;00m[37m[39;49;00m$
    64^I[37m[39;49;00m$
    65^I([34mdefine[39;49;00m[37m [39;49;00m([31minitial-board[39;49;00m)[37m[39;49;00m$
    66^I[37m  [39;49;00m([31mmake-board[39;49;00m)[37m[39;49;00m$
    67^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m44[39;49;00m)[37m [39;49;00m[33mwhite[39;49;00m)[37m[39;49;00m$
    68^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m55[39;49;00m)[37m [39;49;00m[33mwhite[39;49;00m)[37m[39;49;00m$
    69^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m45[39;49;00m)[37m [39;49;00m[33mblack[39;49;00m)[37m[39;49;00m$
    70^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m54[39;49;00m)[37m [39;49;00m[33mblack[39;49;00m))[37m[39;49;00m$
    71^I[37m[39;49;00m$
    72^I([34mdefine[39;49;00m[37m [39;49;00m([31mopponent[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
    73^I[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mblack[39;49;00m)[37m [39;49;00m[33mwhite[39;49;00m[37m [39;49;00m[33mblack[39;49;00m))[37m[39;49;00m$
    74^I[37m[39;49;00m$
    75^I([34mdefine[39;49;00m[37m [39;49;00m([31mplayer-name[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
    76^I[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mwhite[39;49;00m)[37m [39;49;00m[33m"white"[39;49;00m[37m [39;49;00m[33m"black"[39;49;00m))[37m[39;49;00m$
    77^I[37m  [39;49;00m$
    78^I([34mdefine[39;49;00m[37m [39;49;00m([31mvalid-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m[39;49;00m$
    79^I[37m  [39;49;00m([34mand[39;49;00m[37m [39;49;00m$
    80^I[37m     [39;49;00m([34minteger[39;49;00m[33m?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m[39;49;00m$
    81^I[37m     [39;49;00m([31m<=[39;49;00m[37m [39;49;00m[33m11[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33m88[39;49;00m)[37m[39;49;00m$
    82^I[37m     [39;49;00m([31m<=[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m [39;49;00m([34mmod[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33m10[39;49;00m)[37m [39;49;00m[33m8[39;49;00m)))[37m[39;49;00m$
    83^I[37m[39;49;00m$
    84^I([34mdefine[39;49;00m[37m [39;49;00m([31mempty-square?[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m[39;49;00m$
    85^I[37m  [39;49;00m([34mand[39;49;00m[37m[39;49;00m$
    86^I[37m     [39;49;00m([31mvalid-move?[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m[39;49;00m$
    87^I[37m     [39;49;00m([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m [39;49;00m[33mempty[39;49;00m)))[37m[39;49;00m$
    88^I[37m     [39;49;00m$
    89^I[37m; test whether a move is legal. The square must be empty[39;49;00m[37m[39;49;00m$
    90^I[37m; and it must flip at least one of the opponent's piece[39;49;00m[37m[39;49;00m$
    91^I[37m[39;49;00m$
    92^I([34mdefine[39;49;00m[37m [39;49;00m([31mlegal-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
    93^I[37m  [39;49;00m([34mand[39;49;00m[37m [39;49;00m$
    94^I[37m     [39;49;00m([31mempty-square?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m[39;49;00m$
    95^I[37m     [39;49;00m([34mexists[39;49;00m[37m [39;49;00m([34mfn[39;49;00m[37m [39;49;00m([31mdir[39;49;00m)[37m [39;49;00m([31mwould-flip?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m))[37m [39;49;00m[33mall-directions[39;49;00m)))[37m[39;49;00m$
    96^I[37m[39;49;00m$
    97^I[37m; would this move by player result in any flips in the given direction?[39;49;00m[37m[39;49;00m$
    98^I[37m; if so, return the number of the 'opposite' (bracketing) piece's square[39;49;00m[37m[39;49;00m$
    99^I[37m[39;49;00m$
   100^I([34mdefine[39;49;00m[37m [39;49;00m([31mwould-flip?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)[37m [39;49;00m$
   101^I[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m$
   102^I[37m     [39;49;00m(([31mc[39;49;00m[37m [39;49;00m([31m+[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)))[37m[39;49;00m$
   103^I[37m     [39;49;00m([34mand[39;49;00m[37m [39;49;00m$
   104^I[37m        [39;49;00m([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mc[39;49;00m)[37m [39;49;00m([31mopponent[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   105^I[37m        [39;49;00m([34mfind[39;49;00m[34m-[39;49;00m[33mbracketing-piece[39;49;00m[37m [39;49;00m([31m+[39;49;00m[37m [39;49;00m[33mc[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m))))[37m[39;49;00m$
   106^I[37m  [39;49;00m$
   107^I([34mdefine[39;49;00m[37m [39;49;00m([34mfind[39;49;00m[34m-[39;49;00m[33mbracketing-piece[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)[37m[39;49;00m$
   108^I[37m  [39;49;00m[37m; return the square of the bracketing piece, if any[39;49;00m[37m[39;49;00m$
   109^I[37m  [39;49;00m([34mcond[39;49;00m[37m[39;49;00m$
   110^I[37m     [39;49;00m(([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m [39;49;00m[33mplayer[39;49;00m)[37m [39;49;00m[33msquare[39;49;00m)[37m[39;49;00m$
   111^I[37m     [39;49;00m(([31m=[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m [39;49;00m([31mopponent[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   112^I[37m        [39;49;00m([34mfind[39;49;00m[34m-[39;49;00m[33mbracketing-piece[39;49;00m[37m [39;49;00m([31m+[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m))[37m[39;49;00m$
   113^I[37m     [39;49;00m([34mtrue[39;49;00m[37m [39;49;00m[34mnil[39;49;00m)))[37m[39;49;00m$
   114^I[37m[39;49;00m$
   115^I([34mdefine[39;49;00m[37m [39;49;00m([31mmake-flips[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)[37m[39;49;00m$
   116^I[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m$
   117^I[37m     [39;49;00m(([31mbracketer[39;49;00m[37m [39;49;00m([31mwould-flip?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m))[37m[39;49;00m$
   118^I[37m      [39;49;00m([31mc[39;49;00m[37m [39;49;00m([31m+[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)))[37m[39;49;00m$
   119^I[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m[33mbracketer[39;49;00m[37m[39;49;00m$
   120^I[37m     [39;49;00m([34mdo-until[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[33mc[39;49;00m[37m [39;49;00m[33mbracketer[39;49;00m)[37m[39;49;00m$
   121^I[37m        [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mc[39;49;00m)[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   122^I[37m        [39;49;00m([34mpush[39;49;00m[37m [39;49;00m[33mc[39;49;00m[37m [39;49;00m[34m*[39;49;00m[33mflips*[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m1[39;49;00m)[37m[39;49;00m$
   123^I[37m        [39;49;00m([34minc[39;49;00m[37m [39;49;00m[33mc[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)))))[37m[39;49;00m$
   124^I[37m[39;49;00m$
   125^I[37m; make the move on the master game board, not yet visually[39;49;00m[37m[39;49;00m$
   126^I[37m[39;49;00m$
   127^I([34mdefine[39;49;00m[37m [39;49;00m([31mmake-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   128^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   129^I[37m  [39;49;00m([34mpush[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[34m*[39;49;00m[33mmoves*[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m1[39;49;00m)[37m[39;49;00m$
   130^I[37m  [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[34m*[39;49;00m[33mflips*[39;49;00m[37m [39;49;00m'())[37m [39;49;00m[37m; we're going to keep a record of the flips made[39;49;00m[37m[39;49;00m$
   131^I[37m  [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31mdir[39;49;00m[37m [39;49;00m[33mall-directions[39;49;00m)[37m[39;49;00m$
   132^I[37m     [39;49;00m([31mmake-flips[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33mdir[39;49;00m)))[37m[39;49;00m$
   133^I[37m[39;49;00m$
   134^I([34mdefine[39;49;00m[37m [39;49;00m([31mnext-to-play[39;49;00m[37m [39;49;00m[33mprevious-player[39;49;00m)[37m[39;49;00m$
   135^I[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mopp[39;49;00m[37m [39;49;00m([31mopponent[39;49;00m[37m [39;49;00m[33mprevious-player[39;49;00m)))[37m[39;49;00m$
   136^I[37m     [39;49;00m([34mcond[39;49;00m[37m[39;49;00m$
   137^I[37m        [39;49;00m(([31many-legal-move?[39;49;00m[37m [39;49;00m[33mopp[39;49;00m)[37m [39;49;00m[33mopp[39;49;00m)[37m[39;49;00m$
   138^I[37m        [39;49;00m(([31many-legal-move?[39;49;00m[37m [39;49;00m[33mprevious-player[39;49;00m)[37m[39;49;00m$
   139^I[37m           [39;49;00m([34mprintln[39;49;00m[37m [39;49;00m([31mplayer-name[39;49;00m[37m [39;49;00m[33mopp[39;49;00m)[37m [39;49;00m[33m" has no moves"[39;49;00m)[37m[39;49;00m$
   140^I[37m           [39;49;00m[33mprevious-player[39;49;00m)[37m[39;49;00m$
   141^I[37m        [39;49;00m([34mtrue[39;49;00m[37m [39;49;00m[34mnil[39;49;00m))))[37m[39;49;00m$
   142^I[37m        [39;49;00m$
   143^I[37m; are there any legal moves (returns first) for this player?[39;49;00m[37m[39;49;00m$
   144^I([34mdefine[39;49;00m[37m [39;49;00m([31many-legal-move?[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   145^I[37m  [39;49;00m([34mexists[39;49;00m[37m [39;49;00m([34mfn[39;49;00m[37m [39;49;00m([31mmove[39;49;00m)[37m [39;49;00m([31mlegal-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m [39;49;00m$
   146^I[37m     [39;49;00m([31mall-squares[39;49;00m)))[37m[39;49;00m$
   147^I[37m[39;49;00m$
   148^I[37m; a list of all legal moves might be useful[39;49;00m[37m[39;49;00m$
   149^I([34mdefine[39;49;00m[37m [39;49;00m([31mlegal-moves[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   150^I[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mresult[39;49;00m[37m [39;49;00m'()))[37m[39;49;00m$
   151^I[37m     [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31mmove[39;49;00m[37m [39;49;00m([31mall-squares[39;49;00m))[37m[39;49;00m$
   152^I[37m        [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31mlegal-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   153^I[37m           [39;49;00m([34mpush[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mresult[39;49;00m)))[37m[39;49;00m$
   154^I[37m  [39;49;00m([34munique[39;49;00m[37m [39;49;00m[33mresult[39;49;00m)))[37m[39;49;00m$
   155^I[37m[39;49;00m$
   156^I[37m; define any number of strategies that can be called on to calculate[39;49;00m[37m[39;49;00m$
   157^I[37m; the next computer move. This is the only one I've done... - make [39;49;00m[37m[39;49;00m$
   158^I[37m; any legal move at random![39;49;00m[37m[39;49;00m$
   159^I[37m[39;49;00m$
   160^I([34mdefine[39;49;00m[37m [39;49;00m([34mrandom[39;49;00m[34m-[39;49;00m[33mstrategy[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   161^I[37m  [39;49;00m([34mseed[39;49;00m[37m [39;49;00m([34mdate-value[39;49;00m))[37m[39;49;00m$
   162^I[37m  [39;49;00m([34mapply[39;49;00m[37m [39;49;00m[34mamb[39;49;00m[37m [39;49;00m([31mlegal-moves[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)))[37m[39;49;00m$
   163^I[37m[39;49;00m$
   164^I[37m; get the next move using a particular strategy[39;49;00m[37m[39;49;00m$
   165^I[37m[39;49;00m$
   166^I([34mdefine[39;49;00m[37m [39;49;00m([31mget-move[39;49;00m[37m [39;49;00m[33mstrategy[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   167^I[37m [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mmove[39;49;00m[37m [39;49;00m([34mapply[39;49;00m[37m [39;49;00m[33mstrategy[39;49;00m[37m [39;49;00m([34mlist[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))))[37m[39;49;00m$
   168^I[37m  [39;49;00m([34mcond[39;49;00m[37m[39;49;00m$
   169^I[37m     [39;49;00m(([34mand[39;49;00m[37m[39;49;00m$
   170^I[37m        [39;49;00m([31mvalid-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m[39;49;00m$
   171^I[37m        [39;49;00m([31mlegal-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   172^I[37m            [39;49;00m([31mmake-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   173^I[37m     [39;49;00m([34mtrue[39;49;00m[37m  [39;49;00m$
   174^I[37m        [39;49;00m([34mprintln[39;49;00m[37m [39;49;00m[33m"no valid or legal move for "[39;49;00m[37m [39;49;00m([31mplayer-name[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   175^I[37m        [39;49;00m[34mnil[39;49;00m))[37m[39;49;00m$
   176^I[37m  [39;49;00m[33mmove[39;49;00m))[37m[39;49;00m$
   177^I[37m[39;49;00m$
   178^I[37m; that's about all the game algorithms for now[39;49;00m[37m[39;49;00m$
   179^I[37m; now for the interface[39;49;00m[37m[39;49;00m$
   180^I[37m[39;49;00m$
   181^I([34mif[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[34mostype[39;49;00m[37m [39;49;00m[33m"Win32"[39;49;00m)[37m[39;49;00m$
   182^I[37m   [39;49;00m([34mload[39;49;00m[37m [39;49;00m([34mstring[39;49;00m[37m [39;49;00m([34menv[39;49;00m[37m [39;49;00m[33m"PROGRAMFILES"[39;49;00m)[37m [39;49;00m[33m"/newlisp/guiserver.lsp"[39;49;00m))[37m[39;49;00m$
   183^I[37m   [39;49;00m([34mload[39;49;00m[37m [39;49;00m[33m"/usr/share/newlisp/guiserver.lsp"[39;49;00m)[37m[39;49;00m$
   184^I)[37m[39;49;00m$
   185^I[37m[39;49;00m$
   186^I([31mgs[39;49;00m:[33minit[39;49;00m)[37m[39;49;00m$
   187^I([34mmap[39;49;00m[37m [39;49;00m[34mset[39;49;00m[37m [39;49;00m'([31mscreen-width[39;49;00m[37m [39;49;00m[33mscreen-height[39;49;00m)[37m [39;49;00m([31mgs[39;49;00m:[33mget-screen[39;49;00m))[37m[39;49;00m$
   188^I([34mset[39;49;00m[37m [39;49;00m'[33mboard-width[39;49;00m[37m [39;49;00m[33m540[39;49;00m)[37m[39;49;00m$
   189^I[37m; center on screen[39;49;00m[37m[39;49;00m$
   190^I([31mgs[39;49;00m:[33mframe[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m[37m [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m/[39;49;00m[37m [39;49;00m[33mscreen-width[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m [39;49;00m([31m/[39;49;00m[37m [39;49;00m[33mboard-width[39;49;00m[37m [39;49;00m[33m2[39;49;00m))[37m [39;49;00m[33m60[39;49;00m[37m [39;49;00m[33mboard-width[39;49;00m[37m [39;49;00m[33m660[39;49;00m[37m [39;49;00m[33m"Reversi"[39;49;00m)[37m[39;49;00m$
   191^I([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mborder-layout[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m)[37m[39;49;00m$
   192^I[37m[39;49;00m$
   193^I([31mgs[39;49;00m:[33mcanvas[39;49;00m[37m [39;49;00m'[33mMyCanvas[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m)[37m[39;49;00m$
   194^I[37m  [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mbackground[39;49;00m[37m [39;49;00m'[33mMyCanvas[39;49;00m[37m [39;49;00m'([31m.8[39;49;00m[37m [39;49;00m[33m.9[39;49;00m[37m [39;49;00m[33m.7[39;49;00m[37m [39;49;00m[33m.8[39;49;00m))[37m[39;49;00m$
   195^I[37m  [39;49;00m([31mgs[39;49;00m:[33mmouse-released[39;49;00m[37m [39;49;00m'[33mMyCanvas[39;49;00m[37m [39;49;00m'[33mmouse-released-action[39;49;00m[37m [39;49;00m[34mtrue[39;49;00m)[37m[39;49;00m$
   196^I[37m[39;49;00m$
   197^I([31mgs[39;49;00m:[33mpanel[39;49;00m[37m [39;49;00m'[33mControls[39;49;00m)[37m[39;49;00m$
   198^I[37m  [39;49;00m([31mgs[39;49;00m:[33mbutton[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m'[33mstart-game[39;49;00m[37m [39;49;00m[33m"Start"[39;49;00m)[37m[39;49;00m$
   199^I[37m[39;49;00m$
   200^I([31mgs[39;49;00m:[33mpanel[39;49;00m[37m [39;49;00m'[33mLower[39;49;00m)[37m[39;49;00m$
   201^I[37m  [39;49;00m([31mgs[39;49;00m:[33mlabel[39;49;00m[37m [39;49;00m'[33mWhiteScore[39;49;00m[37m [39;49;00m[33m""[39;49;00m)[37m[39;49;00m$
   202^I[37m  [39;49;00m([31mgs[39;49;00m:[33mlabel[39;49;00m[37m [39;49;00m'[33mBlackScore[39;49;00m[37m [39;49;00m[33m""[39;49;00m)[37m[39;49;00m$
   203^I[37m[39;49;00m$
   204^I([31mgs[39;49;00m:[34madd[39;49;00m[34m-[39;49;00m[33mto[39;49;00m[37m [39;49;00m'[33mControls[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m)[37m[39;49;00m$
   205^I([31mgs[39;49;00m:[34madd[39;49;00m[34m-[39;49;00m[33mto[39;49;00m[37m [39;49;00m'[33mLower[39;49;00m[37m [39;49;00m'[33mWhiteScore[39;49;00m[37m [39;49;00m'[33mBlackScore[39;49;00m)[37m[39;49;00m$
   206^I([31mgs[39;49;00m:[34madd[39;49;00m[34m-[39;49;00m[33mto[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m[37m [39;49;00m'[33mMyCanvas[39;49;00m[37m [39;49;00m[33m"center"[39;49;00m[37m [39;49;00m'[33mControls[39;49;00m[37m [39;49;00m[33m"north"[39;49;00m[37m [39;49;00m'[33mLower[39;49;00m[37m [39;49;00m[33m"south"[39;49;00m)[37m[39;49;00m$
   207^I[37m[39;49;00m$
   208^I([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33manti-aliasing[39;49;00m[37m [39;49;00m[34mtrue[39;49;00m)[37m[39;49;00m$
   209^I([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mvisible[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m[37m [39;49;00m[34mtrue[39;49;00m)[37m[39;49;00m$
   210^I[37m[39;49;00m$
   211^I[37m; size of board square, and radius/width of counter[39;49;00m[37m[39;49;00m$
   212^I([34mset[39;49;00m[37m [39;49;00m'[33msize[39;49;00m[37m [39;49;00m[33m60[39;49;00m[37m [39;49;00m'[33mwidth[39;49;00m[37m [39;49;00m[33m30[39;49;00m)[37m[39;49;00m$
   213^I[37m[39;49;00m$
   214^I[37m; initialize the master board[39;49;00m[37m[39;49;00m$
   215^I[37m[39;49;00m$
   216^I([34mdefine[39;49;00m[37m [39;49;00m([31minitial-board[39;49;00m)[37m[39;49;00m$
   217^I[37m  [39;49;00m([31mmake-board[39;49;00m)[37m[39;49;00m$
   218^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m44[39;49;00m)[37m [39;49;00m[33mwhite[39;49;00m)[37m[39;49;00m$
   219^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m55[39;49;00m)[37m [39;49;00m[33mwhite[39;49;00m)[37m[39;49;00m$
   220^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m45[39;49;00m)[37m [39;49;00m[33mblack[39;49;00m)[37m[39;49;00m$
   221^I[37m  [39;49;00m([34msetf[39;49;00m[37m [39;49;00m([34m*[39;49;00m[33mboard*[39;49;00m[37m [39;49;00m[33m54[39;49;00m)[37m [39;49;00m[33mblack[39;49;00m)[37m  [39;49;00m$
   222^I)[37m[39;49;00m$
   223^I[37m[39;49;00m$
   224^I[37m; draw a graphical repesentation of the board[39;49;00m[37m[39;49;00m$
   225^I[37m[39;49;00m$
   226^I([34mdefine[39;49;00m[37m [39;49;00m([31mdraw-board[39;49;00m)[37m[39;49;00m$
   227^I[37m  [39;49;00m([34mlocal[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m[39;49;00m$
   228^I[37m     [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31mi[39;49;00m[37m [39;49;00m([31mall-squares[39;49;00m))[37m[39;49;00m$
   229^I[37m        [39;49;00m([34mmap[39;49;00m[37m [39;49;00m[34mset[39;49;00m[37m [39;49;00m'([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m([31msquare-to-xy[39;49;00m[37m [39;49;00m[33mi[39;49;00m))[37m[39;49;00m$
   230^I[37m        [39;49;00m([31mgs[39;49;00m:[33mdraw-rect[39;49;00m[37m [39;49;00m$
   231^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   232^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m [39;49;00m[37m; !!!!!![39;49;00m[37m[39;49;00m$
   233^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m[39;49;00m$
   234^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   235^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   236^I[37m           [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m))))[37m[39;49;00m$
   237^I[37m[39;49;00m$
   238^I([34mdefine[39;49;00m[37m [39;49;00m([31mdraw-first-four-pieces[39;49;00m)[37m[39;49;00m$
   239^I[37m  [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33m44[39;49;00m[37m [39;49;00m[33m"white"[39;49;00m)[37m[39;49;00m$
   240^I[37m  [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33m55[39;49;00m[37m [39;49;00m[33m"white"[39;49;00m)[37m[39;49;00m$
   241^I[37m  [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33m45[39;49;00m[37m [39;49;00m[33m"black"[39;49;00m)[37m[39;49;00m$
   242^I[37m  [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33m54[39;49;00m[37m [39;49;00m[33m"black"[39;49;00m))[37m[39;49;00m$
   243^I[37m[39;49;00m$
   244^I[37m; this next function can mark the legal moves available to a player[39;49;00m[37m[39;49;00m$
   245^I[37m[39;49;00m$
   246^I([34mdefine[39;49;00m[37m [39;49;00m([31mshow-legal-moves[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   247^I[37m  [39;49;00m([34mlocal[39;49;00m[37m [39;49;00m([31mlegal-move-list[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m[39;49;00m$
   248^I[37m     [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mlegal-move-list[39;49;00m[37m [39;49;00m([31mlegal-moves[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   249^I[37m     [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31mm[39;49;00m[37m [39;49;00m([31mall-squares[39;49;00m))[37m[39;49;00m$
   250^I[37m        [39;49;00m([34mmap[39;49;00m[37m [39;49;00m[34mset[39;49;00m[37m [39;49;00m'([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m([31msquare-to-xy[39;49;00m[37m [39;49;00m[33mm[39;49;00m))[37m[39;49;00m$
   251^I[37m        [39;49;00m([31mgs[39;49;00m:[33mdraw-rect[39;49;00m[37m [39;49;00m$
   252^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   253^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m [39;49;00m[37m; !!!!!![39;49;00m[37m[39;49;00m$
   254^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m[39;49;00m$
   255^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   256^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   257^I[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([34mfind[39;49;00m[37m [39;49;00m[33mm[39;49;00m[37m [39;49;00m[33mlegal-move-list[39;49;00m)[37m [39;49;00m[33mgs[39;49;00m:[33mblue[39;49;00m[37m [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m)[37m[39;49;00m$
   258^I[37m        [39;49;00m)[37m[39;49;00m$
   259^I[37m     [39;49;00m)[37m[39;49;00m$
   260^I[37m  [39;49;00m)[37m[39;49;00m$
   261^I)[37m[39;49;00m$
   262^I[37m[39;49;00m$
   263^I[37m; convert the number of a square on the master board to coordinates[39;49;00m[37m[39;49;00m$
   264^I[37m[39;49;00m$
   265^I([34mdefine[39;49;00m[37m [39;49;00m([31msquare-to-xy[39;49;00m[37m [39;49;00m[33msquare[39;49;00m)[37m [39;49;00m$
   266^I[37m  [39;49;00m([34mlist[39;49;00m[37m [39;49;00m([31m/[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33m10[39;49;00m)[37m [39;49;00m([34mmod[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33m10[39;49;00m)))[37m[39;49;00m$
   267^I[37m[39;49;00m$
   268^I[37m; draw one of the pieces[39;49;00m[37m[39;49;00m$
   269^I[37m[39;49;00m$
   270^I([34mdefine[39;49;00m[37m [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33mcolour[39;49;00m)[37m[39;49;00m$
   271^I[37m  [39;49;00m([34mlocal[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m[39;49;00m$
   272^I[37m  [39;49;00m([34mmap[39;49;00m[37m [39;49;00m[34mset[39;49;00m[37m [39;49;00m'([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m([31msquare-to-xy[39;49;00m[37m [39;49;00m[33msquare[39;49;00m))[37m[39;49;00m$
   273^I[37m  [39;49;00m([34mcond[39;49;00m[37m [39;49;00m$
   274^I[37m     [39;49;00m(([31m=[39;49;00m[37m [39;49;00m[33mcolour[39;49;00m[37m [39;49;00m[33m"white"[39;49;00m)[37m [39;49;00m$
   275^I[37m        [39;49;00m([31mgs[39;49;00m:[33mfill-circle[39;49;00m[37m [39;49;00m$
   276^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   277^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m  [39;49;00m[37m; !!!!!!! y first, cos y is x ;-)[39;49;00m[37m[39;49;00m$
   278^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   279^I[37m           [39;49;00m[33mwidth[39;49;00m[37m[39;49;00m$
   280^I[37m           [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m))[37m[39;49;00m$
   281^I[37m     [39;49;00m$
   282^I[37m     [39;49;00m(([31m=[39;49;00m[37m [39;49;00m[33mcolour[39;49;00m[37m [39;49;00m[33m"black"[39;49;00m)[37m [39;49;00m$
   283^I[37m        [39;49;00m([31mgs[39;49;00m:[33mfill-circle[39;49;00m[37m [39;49;00m$
   284^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   285^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   286^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   287^I[37m           [39;49;00m[33mwidth[39;49;00m[37m[39;49;00m$
   288^I[37m           [39;49;00m[33mgs[39;49;00m:[33mblack[39;49;00m))[37m[39;49;00m$
   289^I[37m     [39;49;00m$
   290^I[37m     [39;49;00m(([31m=[39;49;00m[37m [39;49;00m[33mcolour[39;49;00m[37m [39;49;00m[33m"empty"[39;49;00m)[37m [39;49;00m$
   291^I[37m        [39;49;00m([31mgs[39;49;00m:[33mdraw-rect[39;49;00m[37m [39;49;00m$
   292^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   293^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m [39;49;00m$
   294^I[37m           [39;49;00m([31m-[39;49;00m[37m [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m)[37m[39;49;00m$
   295^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   296^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m[39;49;00m$
   297^I[37m           [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m))[37m[39;49;00m$
   298^I[37m  [39;49;00m)))[37m[39;49;00m$
   299^I[37m[39;49;00m$
   300^I[37m; animate the pieces flipping[39;49;00m[37m[39;49;00m$
   301^I[37m[39;49;00m$
   302^I([34mdefine[39;49;00m[37m [39;49;00m([31mflip-piece[39;49;00m[37m [39;49;00m[33msquare[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   303^I[37m; flip by drawing thinner and fatter ellipses [39;49;00m[37m[39;49;00m$
   304^I[37m; go from full disk in opposite colour to invisible[39;49;00m[37m[39;49;00m$
   305^I[37m; then from invisible to full disk in true colour[39;49;00m[37m[39;49;00m$
   306^I[37m  [39;49;00m([34mlocal[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33mcolour[39;49;00m)[37m[39;49;00m$
   307^I[37m     [39;49;00m([34mmap[39;49;00m[37m [39;49;00m[34mset[39;49;00m[37m [39;49;00m'([31mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m([31msquare-to-xy[39;49;00m[37m [39;49;00m[33msquare[39;49;00m))[37m[39;49;00m$
   308^I[37m     [39;49;00m[37m; delete original piece[39;49;00m[37m[39;49;00m$
   309^I[37m     [39;49;00m([31mgs[39;49;00m:[34mdelete[39;49;00m[34m-[39;49;00m[33mtag[39;49;00m[37m [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m))[37m[39;49;00m$
   310^I[37m     [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mcolour[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m [39;49;00m[33mgs[39;49;00m:[33mblack[39;49;00m[37m [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m[37m [39;49;00m))[37m [39;49;00m$
   311^I[37m     [39;49;00m([34mfor[39;49;00m[37m [39;49;00m([31mi[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m  [39;49;00m[33m1[39;49;00m[37m [39;49;00m[34m-[39;49;00m[33m3[39;49;00m)[37m[39;49;00m$
   312^I[37m        [39;49;00m([31mgs[39;49;00m:[33mfill-ellipse[39;49;00m[37m [39;49;00m$
   313^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mflip[39;49;00m[33m}[39;49;00m[37m [39;49;00m[33mi[39;49;00m)[37m [39;49;00m$
   314^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[37m; y first :-) !!! [39;49;00m[37m[39;49;00m$
   315^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   316^I[37m           [39;49;00m[33mi[39;49;00m[37m [39;49;00m$
   317^I[37m           [39;49;00m[33mwidth[39;49;00m[37m[39;49;00m$
   318^I[37m           [39;49;00m[33mcolour[39;49;00m)[37m[39;49;00m$
   319^I[37m        [39;49;00m([34msleep[39;49;00m[37m [39;49;00m[33m20[39;49;00m)[37m  [39;49;00m[37m; this might need adjusting...[39;49;00m[37m[39;49;00m$
   320^I[37m        [39;49;00m([31mgs[39;49;00m:[34mdelete[39;49;00m[34m-[39;49;00m[33mtag[39;49;00m[37m [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mflip[39;49;00m[33m}[39;49;00m[37m [39;49;00m[33mi[39;49;00m))[37m[39;49;00m$
   321^I[37m     [39;49;00m)[37m[39;49;00m$
   322^I[37m     [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mcolour[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31m=[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[33m2[39;49;00m)[37m [39;49;00m[33mgs[39;49;00m:[33mwhite[39;49;00m[37m [39;49;00m[33mgs[39;49;00m:[33mblack[39;49;00m))[37m[39;49;00m$
   323^I[37m     [39;49;00m([34mfor[39;49;00m[37m [39;49;00m([31mi[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m [39;49;00m[33mwidth[39;49;00m[37m [39;49;00m[33m3[39;49;00m)[37m[39;49;00m$
   324^I[37m        [39;49;00m([31mgs[39;49;00m:[33mfill-ellipse[39;49;00m[37m [39;49;00m$
   325^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mflip[39;49;00m[33m}[39;49;00m[37m [39;49;00m[33mi[39;49;00m)[37m [39;49;00m$
   326^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m[37m; :-) !!! [39;49;00m[37m[39;49;00m$
   327^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   328^I[37m           [39;49;00m[33mi[39;49;00m[37m [39;49;00m$
   329^I[37m           [39;49;00m[33mwidth[39;49;00m[37m[39;49;00m$
   330^I[37m           [39;49;00m[33mcolour[39;49;00m)[37m[39;49;00m$
   331^I[37m        [39;49;00m([34msleep[39;49;00m[37m [39;49;00m[33m20[39;49;00m)[37m  [39;49;00m$
   332^I[37m        [39;49;00m([31mgs[39;49;00m:[34mdelete[39;49;00m[34m-[39;49;00m[33mtag[39;49;00m[37m [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33m{[39;49;00m[33mflip[39;49;00m[33m}[39;49;00m[37m [39;49;00m[33mi[39;49;00m))[37m[39;49;00m$
   333^I[37m     [39;49;00m)[37m[39;49;00m$
   334^I[37m     [39;49;00m[37m; draw the piece again[39;49;00m[37m[39;49;00m$
   335^I[37m     [39;49;00m([31mgs[39;49;00m:[33mfill-circle[39;49;00m[37m [39;49;00m$
   336^I[37m           [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m)[37m [39;49;00m$
   337^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m[39;49;00m$
   338^I[37m           [39;49;00m([31m*[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33msize[39;49;00m)[37m [39;49;00m$
   339^I[37m           [39;49;00m[33mwidth[39;49;00m[37m[39;49;00m$
   340^I[37m           [39;49;00m[33mcolour[39;49;00m)[37m[39;49;00m$
   341^I[37m  [39;49;00m)[37m[39;49;00m$
   342^I)[37m[39;49;00m$
   343^I[37m[39;49;00m$
   344^I([34mdefine[39;49;00m[37m [39;49;00m([31mdo-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   345^I[37m  [39;49;00m([34mcond[39;49;00m[37m [39;49;00m$
   346^I[37m     [39;49;00m[37m; check if the move is good ...[39;49;00m[37m[39;49;00m$
   347^I[37m     [39;49;00m(([34mand[39;49;00m[37m [39;49;00m([31m!=[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m[37m [39;49;00m[34mnil[39;49;00m)[37m[39;49;00m$
   348^I[37m           [39;49;00m([31mvalid-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m)[37m[39;49;00m$
   349^I[37m           [39;49;00m([31mlegal-move?[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   350^I[37m           [39;49;00m$
   351^I[37m           [39;49;00m[37m; ... play it[39;49;00m[37m[39;49;00m$
   352^I[37m              [39;49;00m[37m; make move on board[39;49;00m[37m[39;49;00m$
   353^I[37m              [39;49;00m([31mmake-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   354^I[37m              [39;49;00m[37m; and on screen[39;49;00m[37m[39;49;00m$
   355^I[37m              [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m([31mplayer-name[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   356^I[37m              [39;49;00m([31mgs[39;49;00m:[33mupdate[39;49;00m)[37m[39;49;00m$
   357^I[37m              [39;49;00m[37m; do flipping stuff[39;49;00m[37m[39;49;00m$
   358^I[37m              [39;49;00m$
   359^I[37m              [39;49;00m[37m; wait for a while[39;49;00m[37m[39;49;00m$
   360^I[37m              [39;49;00m([34msleep[39;49;00m[37m [39;49;00m[33m1000[39;49;00m)[37m[39;49;00m$
   361^I[37m  [39;49;00m$
   362^I[37m              [39;49;00m[37m; then do flipping[39;49;00m[37m[39;49;00m$
   363^I[37m              [39;49;00m([34mdolist[39;49;00m[37m [39;49;00m([31mf[39;49;00m[37m [39;49;00m[34m*[39;49;00m[33mflips*[39;49;00m)[37m[39;49;00m$
   364^I[37m                 [39;49;00m([31mflip-piece[39;49;00m[37m [39;49;00m[33mf[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   365^I[37m              [39;49;00m$
   366^I[37m              [39;49;00m([34minc[39;49;00m[37m [39;49;00m[34m*[39;49;00m[33mmove-number*[39;49;00m)[37m[39;49;00m$
   367^I[37m              [39;49;00m([31mdraw-piece[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m([31mplayer-name[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   368^I[37m              [39;49;00m([31mgs[39;49;00m:[33mupdate[39;49;00m)[37m[39;49;00m$
   369^I[37m[39;49;00m$
   370^I[37m              [39;49;00m[37m; update scores[39;49;00m[37m[39;49;00m$
   371^I[37m              [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mWhiteScore[39;49;00m[37m [39;49;00m$
   372^I[37m                 [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33m"White: "[39;49;00m[37m [39;49;00m([34mfirst[39;49;00m[37m [39;49;00m([34mcount[39;49;00m[37m [39;49;00m([34mlist[39;49;00m[37m [39;49;00m[33mwhite[39;49;00m)[37m [39;49;00m[34m*[39;49;00m[33mboard*[39;49;00m))))[37m[39;49;00m$
   373^I[37m              [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mBlackScore[39;49;00m[37m[39;49;00m$
   374^I[37m                 [39;49;00m([34mstring[39;49;00m[37m [39;49;00m[33m"Black: "[39;49;00m[37m [39;49;00m([34mfirst[39;49;00m[37m [39;49;00m([34mcount[39;49;00m[37m [39;49;00m([34mlist[39;49;00m[37m [39;49;00m[33mblack[39;49;00m)[37m [39;49;00m[34m*[39;49;00m[33mboard*[39;49;00m))))[37m[39;49;00m$
   375^I[37m              [39;49;00m)[37m[39;49;00m$
   376^I[37m     [39;49;00m[37m; or return nil[39;49;00m[37m[39;49;00m$
   377^I[37m     [39;49;00m([34mtrue[39;49;00m[37m [39;49;00m$
   378^I[37m           [39;49;00m[34mnil[39;49;00m)))[37m[39;49;00m$
   379^I[37m[39;49;00m$
   380^I[37m; the game is driven by the mouse clicks of the user[39;49;00m[37m[39;49;00m$
   381^I[37m; in reply, the computer plays a black piece[39;49;00m[37m[39;49;00m$
   382^I[37m; premature clicking is possible and possibly a bad thing...[39;49;00m[37m[39;49;00m$
   383^I[37m[39;49;00m$
   384^I([34mdefine[39;49;00m[37m [39;49;00m([31mmouse-released-action[39;49;00m[37m [39;49;00m[33mx[39;49;00m[37m [39;49;00m[33my[39;49;00m[37m [39;49;00m[33mbutton[39;49;00m[37m [39;49;00m[33mmodifiers[39;49;00m[37m [39;49;00m[33mtags[39;49;00m)[37m[39;49;00m$
   385^I[37m  [39;49;00m[37m; extract the tag of the clicked square[39;49;00m[37m[39;49;00m$
   386^I[37m  [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mmove[39;49;00m[37m [39;49;00m([34mint[39;49;00m[37m [39;49;00m([34mstring[39;49;00m[37m [39;49;00m([34mfirst[39;49;00m[37m [39;49;00m[33mtags[39;49;00m))[37m [39;49;00m[33m0[39;49;00m[37m [39;49;00m[33m10[39;49;00m))[37m[39;49;00m$
   387^I[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([31mdo-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   388^I[37m     [39;49;00m([34mbegin[39;49;00m[37m[39;49;00m$
   389^I[37m        [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mplayer[39;49;00m[37m [39;49;00m([31mnext-to-play[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   390^I[37m        [39;49;00m[37m; there is a training mode - legal squares are highlighted[39;49;00m[37m[39;49;00m$
   391^I[37m        [39;49;00m[37m; you can uncomment the next line...[39;49;00m[37m[39;49;00m$
   392^I[37m        [39;49;00m[37m; (show-legal-moves player)[39;49;00m[37m[39;49;00m$
   393^I[37m        [39;49;00m([31mgs[39;49;00m:[33mupdate[39;49;00m)[37m[39;49;00m$
   394^I[37m        [39;49;00m$
   395^I[37m        [39;49;00m[37m; wait for black's reply[39;49;00m[37m[39;49;00m$
   396^I[37m        [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mcursor[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m[37m [39;49;00m[33m"wait"[39;49;00m)[37m[39;49;00m$
   397^I[37m        [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m[33m"black's move - thinking..."[39;49;00m)[37m[39;49;00m$
   398^I[37m        [39;49;00m[37m; give the illusion of Deep Thought...[39;49;00m[37m[39;49;00m$
   399^I[37m        [39;49;00m([34msleep[39;49;00m[37m [39;49;00m[33m2000[39;49;00m)[37m[39;49;00m$
   400^I[37m        [39;49;00m[37m; black's reply[39;49;00m[37m[39;49;00m$
   401^I[37m        [39;49;00m[37m; currently only the random strategy has been defined...[39;49;00m[37m[39;49;00m$
   402^I[37m        [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mstrategy[39;49;00m[37m [39;49;00m[34mrandom[39;49;00m[34m-[39;49;00m[33mstrategy[39;49;00m)[37m[39;49;00m$
   403^I[37m        [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mmove[39;49;00m[37m [39;49;00m([34mapply[39;49;00m[37m [39;49;00m[33mstrategy[39;49;00m[37m [39;49;00m([34mlist[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)))[37m[39;49;00m$
   404^I[37m        [39;49;00m([31mdo-move[39;49;00m[37m [39;49;00m[33mmove[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m)[37m[39;49;00m$
   405^I[37m        [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mplayer[39;49;00m[37m [39;49;00m([31mnext-to-play[39;49;00m[37m [39;49;00m[33mplayer[39;49;00m))[37m[39;49;00m$
   406^I[37m        [39;49;00m[37m; (show-legal-moves player) ; to see black's moves[39;49;00m[37m[39;49;00m$
   407^I[37m        [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m[33m"your move"[39;49;00m)[37m[39;49;00m$
   408^I[37m        [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mcursor[39;49;00m[37m [39;49;00m'[33mReversi[39;49;00m[37m [39;49;00m[33m"default"[39;49;00m)[37m[39;49;00m$
   409^I[37m        [39;49;00m([31mgs[39;49;00m:[33mupdate[39;49;00m))))[37m[39;49;00m$
   410^I[37m[39;49;00m$
   411^I([34mdefine[39;49;00m[37m [39;49;00m([31mstart-game[39;49;00m)[37m[39;49;00m$
   412^I[37m  [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m[33m"Click a square to place a piece!"[39;49;00m)[37m[39;49;00m$
   413^I[37m  [39;49;00m([31mgs[39;49;00m:[33mdisable[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m)[37m[39;49;00m$
   414^I[37m  [39;49;00m([34mset[39;49;00m[37m [39;49;00m'[33mplayer[39;49;00m[37m [39;49;00m[33mwhite[39;49;00m))[37m[39;49;00m$
   415^I[37m[39;49;00m$
   416^I([34mdefine[39;49;00m[37m [39;49;00m([31mstart[39;49;00m)[37m[39;49;00m$
   417^I[37m  [39;49;00m([31mgs[39;49;00m:[34mset[39;49;00m[34m-[39;49;00m[33mtext[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m[37m [39;49;00m[33m"Start"[39;49;00m)[37m[39;49;00m$
   418^I[37m  [39;49;00m([31mgs[39;49;00m:[33menable[39;49;00m[37m [39;49;00m'[33mStart[39;49;00m)[37m[39;49;00m$
   419^I[37m  [39;49;00m([34mset[39;49;00m[37m  [39;49;00m'[34m*[39;49;00m[33mmove-number*[39;49;00m[37m [39;49;00m[33m1[39;49;00m[37m[39;49;00m$
   420^I[37m        [39;49;00m'[34m*[39;49;00m[33mflips*[39;49;00m[37m [39;49;00m'())[37m[39;49;00m$
   421^I[37m  [39;49;00m([31minitial-board[39;49;00m)[37m[39;49;00m$
   422^I[37m  [39;49;00m([31mdraw-board[39;49;00m)[37m[39;49;00m$
   423^I[37m  [39;49;00m([31mdraw-first-four-pieces[39;49;00m))[37m[39;49;00m$
   424^I[37m[39;49;00m$
   425^I([31mstart[39;49;00m)[37m[39;49;00m$
   426^I[37m[39;49;00m$
   427^I([31mgs[39;49;00m:[33mlisten[39;49;00m)$
