     1	[37m// Created by Lionello Lunesu and placed in the public domain.[39;49;00m[37m[39;49;00m$
     2	[37m// This file has been modified from its original version.[39;49;00m[37m[39;49;00m$
     3	[37m// It has been formatted to fit your screen.[39;49;00m[37m[39;49;00m$
     4	[34mmodule[39;49;00m[37m [39;49;00mphoneno;[37m     [39;49;00m[37m// optional[39;49;00m[37m[39;49;00m$
     5	[34mimport[39;49;00m[37m [39;49;00mstd.stdio;[37m   [39;49;00m[37m// writefln     [39;49;00m[37m[39;49;00m$
     6	[34mimport[39;49;00m[37m [39;49;00mstd.ctype;[37m   [39;49;00m[37m// isdigit     [39;49;00m[37m[39;49;00m$
     7	[34mimport[39;49;00m[37m [39;49;00mstd.stream;[37m  [39;49;00m[37m// BufferedFile[39;49;00m[37m[39;49;00m$
     8	[37m[39;49;00m$
     9	[37m// Just for readability (imagine char[][][char[]])    [39;49;00m[37m[39;49;00m$
    10	[34malias[39;49;00m[37m [39;49;00m[36mchar[39;49;00m[][37m [39;49;00m[36mstring[39;49;00m;[37m[39;49;00m$
    11	[34malias[39;49;00m[37m [39;49;00m[36mstring[39;49;00m[][37m [39;49;00mstringarray;[37m[39;49;00m$
    12	[37m[39;49;00m$
    13	[37m/// Strips non-digit characters from the string (COW)[39;49;00m[37m[39;49;00m$
    14	[36mstring[39;49;00m[37m [39;49;00mstripNonDigit([37m [39;49;00m[34min[39;49;00m[37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00mline[37m [39;49;00m)[37m [39;49;00m$
    15	{[37m[39;49;00m$
    16	[37m    [39;49;00m[36mstring[39;49;00m[37m [39;49;00mret;[37m[39;49;00m$
    17	[37m    [39;49;00m[34mforeach[39;49;00m([36muint[39;49;00m[37m [39;49;00mi,[37m [39;49;00mc;[37m [39;49;00mline)[37m [39;49;00m{[37m[39;49;00m$
    18	[37m        [39;49;00m[37m// Error: std.ctype.isdigit at C:\dmd\src\phobos\std\ctype.d(37) [39;49;00m[37m[39;49;00m$
    19	[37m        [39;49;00m[37m// conflicts with std.stream.isdigit at C:\dmd\src\phobos\std\stream.d(2924)[39;49;00m[37m[39;49;00m$
    20	[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m(!std.ctype.isdigit(c))[37m [39;49;00m{[37m[39;49;00m$
    21	[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m(!ret)[37m[39;49;00m$
    22	[37m                [39;49;00mret[37m [39;49;00m=[37m [39;49;00mline[[34m0.[39;49;00m.i];[37m    [39;49;00m$
    23	[37m        [39;49;00m}[37m    [39;49;00m$
    24	[37m        [39;49;00m[34melse[39;49;00m[37m [39;49;00m[34mif[39;49;00m[37m [39;49;00m(ret)[37m[39;49;00m$
    25	[37m            [39;49;00mret[37m [39;49;00m~=[37m [39;49;00mc;[37m    [39;49;00m$
    26	[37m    [39;49;00m}[37m    [39;49;00m$
    27	[37m    [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mret?ret:line;[37m[39;49;00m$
    28	}[37m[39;49;00m$
    29	[37m[39;49;00m$
    30	[34munittest[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    31	[37m    [39;49;00m[34massert[39;49;00m([37m [39;49;00mstripNonDigit([33m"asdf"[39;49;00m)[37m [39;49;00m==[37m [39;49;00m[33m""[39;49;00m[37m  [39;49;00m);[37m[39;49;00m$
    32	[37m    [39;49;00m[34massert[39;49;00m([37m [39;49;00mstripNonDigit([33m"\'13-=2 4kop"[39;49;00m)[37m [39;49;00m==[37m  [39;49;00m[33m"1324"[39;49;00m[37m  [39;49;00m);[37m[39;49;00m$
    33	}[37m[39;49;00m$
    34	[37m[39;49;00m$
    35	[37m/// Converts a word into a number, ignoring all non alpha characters  [39;49;00m[37m[39;49;00m$
    36	[36mstring[39;49;00m[37m [39;49;00mwordToNum([37m [39;49;00m[34min[39;49;00m[37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00mword[37m [39;49;00m)[37m[39;49;00m$
    37	{[37m[39;49;00m$
    38	[37m// translation table for the task at hand[39;49;00m[37m[39;49;00m$
    39	[34mconst[39;49;00m[37m [39;49;00m[36mchar[39;49;00m[[34m256[39;49;00m][37m [39;49;00mTRANSLATE[37m [39;49;00m=[37m    [39;49;00m$
    40	[37m    [39;49;00m[33m"                                "[39;49;00m[37m  [39;49;00m[37m// 0   [39;49;00m[37m[39;49;00m$
    41	[37m    [39;49;00m[33m"                0123456789      "[39;49;00m[37m  [39;49;00m[37m// 32     [39;49;00m[37m[39;49;00m$
    42	[37m    [39;49;00m[33m" 57630499617851881234762239     "[39;49;00m[37m  [39;49;00m[37m// 64   [39;49;00m[37m[39;49;00m$
    43	[37m    [39;49;00m[33m" 57630499617851881234762239     "[39;49;00m[37m[39;49;00m$
    44	[37m    [39;49;00m[33m"                                "[39;49;00m[37m[39;49;00m$
    45	[37m    [39;49;00m[33m"                                "[39;49;00m[37m[39;49;00m$
    46	[37m    [39;49;00m[33m"                                "[39;49;00m[37m    [39;49;00m$
    47	[37m    [39;49;00m[33m"                                "[39;49;00m;[37m[39;49;00m$
    48	[37m    [39;49;00m[36mstring[39;49;00m[37m [39;49;00mret;[37m[39;49;00m$
    49	[37m    [39;49;00m[34mforeach[39;49;00m(c;[37m [39;49;00m[34mcast[39;49;00m([36mubyte[39;49;00m[])word)[37m[39;49;00m$
    50	[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m(TRANSLATE[c][37m [39;49;00m!=[37m [39;49;00m[33m' '[39;49;00m)[37m[39;49;00m$
    51	[37m            [39;49;00mret[37m [39;49;00m~=[37m [39;49;00mTRANSLATE[c];[37m[39;49;00m$
    52	[37m    [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mret;[37m[39;49;00m$
    53	}[37m[39;49;00m$
    54	[37m[39;49;00m$
    55	[34munittest[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    56	[37m [39;49;00m[37m// Test wordToNum using the table from the task description.[39;49;00m[37m[39;49;00m$
    57	[37m [39;49;00m[34massert[39;49;00m([37m [39;49;00m[33m"01112223334455666777888999"[39;49;00m[37m [39;49;00m==[37m[39;49;00m$
    58	[37m   [39;49;00mwordToNum([33m"E | J N Q | R W X | D S Y | F T | A M | C I V | B K U | L O P | G H Z"[39;49;00m));[37m[39;49;00m$
    59	[37m [39;49;00m[34massert[39;49;00m([37m [39;49;00m[33m"01112223334455666777888999"[39;49;00m[37m [39;49;00m==[37m [39;49;00m$
    60	[37m   [39;49;00mwordToNum([33m"e | j n q | r w x | d s y | f t | a m | c i v | b k u | l o p | g h z"[39;49;00m));[37m[39;49;00m$
    61	[37m [39;49;00m[34massert[39;49;00m([37m [39;49;00m[33m"0123456789"[39;49;00m[37m [39;49;00m==[37m [39;49;00m$
    62	[37m   [39;49;00mwordToNum([33m"0 |   1   |   2   |   3   |  4  |  5  |   6   |   7   |   8   |   9"[39;49;00m));[37m[39;49;00m$
    63	}[37m[39;49;00m$
    64	[37m[39;49;00m$
    65	[36mvoid[39;49;00m[37m [39;49;00mmain([37m [39;49;00m[36mstring[39;49;00m[][37m [39;49;00margs[37m [39;49;00m)[37m[39;49;00m$
    66	{[37m[39;49;00m$
    67	[37m    [39;49;00m[37m// This associative array maps a number to an array of words.    [39;49;00m[37m[39;49;00m$
    68	[37m    [39;49;00mstringarray[[36mstring[39;49;00m][37m    [39;49;00mnum2words;[37m[39;49;00m$
    69	[37m[39;49;00m$
    70	[37m    [39;49;00m[34mforeach[39;49;00m([36mstring[39;49;00m[37m [39;49;00mword;[37m [39;49;00m[34mnew[39;49;00m[37m [39;49;00mBufferedFile([33m"dictionary.txt"[39;49;00m[37m [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
    71	[37m        [39;49;00mnum2words[[37m [39;49;00mwordToNum(word)[37m [39;49;00m][37m [39;49;00m~=[37m [39;49;00mword.dup;[37m        [39;49;00m[37m// must dup[39;49;00m[37m[39;49;00m$
    72	[37m[39;49;00m$
    73	[37m    [39;49;00m[37m/// Finds all alternatives for the given number[39;49;00m[37m[39;49;00m$
    74	[37m    [39;49;00m[37m/// (should have been stripped from non-digit characters)[39;49;00m[37m[39;49;00m$
    75	[37m    [39;49;00mstringarray[37m [39;49;00m_FindWords([37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00mnumbers,[37m [39;49;00m[36mbool[39;49;00m[37m [39;49;00mdigitok[37m [39;49;00m)[37m[39;49;00m$
    76	[37m    [39;49;00m[34min[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    77	[37m        [39;49;00m[34massert[39;49;00m(numbers.length[37m [39;49;00m>[37m  [39;49;00m[34m0[39;49;00m);[37m    [39;49;00m$
    78	[37m    [39;49;00m}[37m    [39;49;00m$
    79	[37m    [39;49;00m[34mout[39;49;00m(result)[37m [39;49;00m{[37m[39;49;00m$
    80	[37m        [39;49;00m[34mforeach[39;49;00m[37m [39;49;00m(a;[37m [39;49;00mresult)[37m[39;49;00m$
    81	[37m            [39;49;00m[34massert[39;49;00m([37m [39;49;00mwordToNum(a)[37m [39;49;00m==[37m [39;49;00mnumbers[37m [39;49;00m);[37m[39;49;00m$
    82	[37m    [39;49;00m}[37m    [39;49;00m$
    83	[37m    [39;49;00m[34mbody[39;49;00m[37m [39;49;00m{[37m[39;49;00m$
    84	[37m        [39;49;00mstringarray[37m [39;49;00mret;[37m[39;49;00m$
    85	[37m        [39;49;00m[36mbool[39;49;00m[37m [39;49;00mfoundword[37m [39;49;00m=[37m [39;49;00m[34mfalse[39;49;00m;[37m[39;49;00m$
    86	[37m        [39;49;00m[34mfor[39;49;00m[37m [39;49;00m([36muint[39;49;00m[37m [39;49;00mt=[34m1[39;49;00m;[37m [39;49;00mt<=numbers.length;[37m [39;49;00m++t)[37m [39;49;00m{[37m[39;49;00m$
    87	[37m            [39;49;00m[34mauto[39;49;00m[37m [39;49;00malternatives[37m [39;49;00m=[37m [39;49;00mnumbers[[34m0.[39;49;00m.t][37m [39;49;00m[34min[39;49;00m[37m [39;49;00mnum2words;[37m[39;49;00m$
    88	[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m(!alternatives)[37m[39;49;00m$
    89	[37m                [39;49;00m[34mcontinue[39;49;00m;[37m[39;49;00m$
    90	[37m            [39;49;00mfoundword[37m [39;49;00m=[37m [39;49;00m[34mtrue[39;49;00m;[37m[39;49;00m$
    91	[37m            [39;49;00m[34mif[39;49;00m[37m [39;49;00m(numbers.length[37m [39;49;00m>[37m  [39;49;00mt)[37m [39;49;00m{[37m[39;49;00m$
    92	[37m                [39;49;00m[37m// Combine all current alternatives with all alternatives     [39;49;00m[37m[39;49;00m$
    93	[37m                [39;49;00m[37m// of the rest (next piece can start with a digit)              [39;49;00m[37m[39;49;00m$
    94	[37m                [39;49;00m[34mforeach[39;49;00m[37m [39;49;00m(a2;[37m [39;49;00m_FindWords([37m [39;49;00mnumbers[t..$],[37m [39;49;00m[34mtrue[39;49;00m[37m     [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
    95	[37m                    [39;49;00m[34mforeach[39;49;00m(a1;[37m [39;49;00m*alternatives)[37m[39;49;00m$
    96	[37m                       [39;49;00mret[37m [39;49;00m~=[37m [39;49;00ma1[37m [39;49;00m~[37m [39;49;00m[33m" "[39;49;00m[37m [39;49;00m~[37m [39;49;00ma2;[37m[39;49;00m$
    97	[37m            [39;49;00m}[37m[39;49;00m$
    98	[37m            [39;49;00m[34melse[39;49;00m[37m    [39;49;00m$
    99	[37m                [39;49;00mret[37m [39;49;00m~=[37m [39;49;00m*alternatives;[37m    [39;49;00m[37m// append these alternatives[39;49;00m[37m[39;49;00m$
   100	[37m        [39;49;00m}[37m[39;49;00m$
   101	[37m        [39;49;00m[37m// Try to keep 1 digit, only if we're allowed and no other[39;49;00m[37m[39;49;00m$
   102	[37m        [39;49;00m[37m// alternatives were found[39;49;00m[37m[39;49;00m$
   103	[37m        [39;49;00m[37m// Testing "ret.length" makes more sense than testing "foundword",[39;49;00m[37m[39;49;00m$
   104	[37m        [39;49;00m[37m// but the other implementations seem to do just this.[39;49;00m[37m[39;49;00m$
   105	[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m(digitok[37m [39;49;00m&&[37m [39;49;00m!foundword)[37m [39;49;00m{[37m [39;49;00m[37m//ret.length == 0  [39;49;00m[37m[39;49;00m$
   106	[37m            [39;49;00m[34mif[39;49;00m(numbers.length[37m [39;49;00m>[37m  [39;49;00m[34m1[39;49;00m)[37m [39;49;00m{[37m[39;49;00m$
   107	[37m                [39;49;00m[37m// Combine 1 digit with all altenatives from the rest    [39;49;00m[37m[39;49;00m$
   108	[37m                [39;49;00m[37m// (next piece can not start with a digit)          [39;49;00m[37m[39;49;00m$
   109	[37m                [39;49;00m[34mforeach[39;49;00m[37m [39;49;00m(a;[37m [39;49;00m_FindWords([37m [39;49;00mnumbers[[34m1.[39;49;00m.$],[37m [39;49;00m[34mfalse[39;49;00m[37m [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   110	[37m                    [39;49;00mret[37m [39;49;00m~=[37m [39;49;00mnumbers[[34m0.[39;49;00m[34m.1[39;49;00m][37m [39;49;00m~[37m [39;49;00m[33m" "[39;49;00m[37m [39;49;00m~[37m [39;49;00ma;[37m[39;49;00m$
   111	[37m            [39;49;00m}[37m    [39;49;00m$
   112	[37m            [39;49;00m[34melse[39;49;00m[37m    [39;49;00m$
   113	[37m                [39;49;00mret[37m [39;49;00m~=[37m [39;49;00mnumbers[[34m0.[39;49;00m[34m.1[39;49;00m];[37m    [39;49;00m[37m// just append this digit             [39;49;00m[37m[39;49;00m$
   114	[37m        [39;49;00m}[37m    [39;49;00m$
   115	[37m        [39;49;00m[34mreturn[39;49;00m[37m [39;49;00mret;[37m[39;49;00m$
   116	[37m    [39;49;00m}[37m[39;49;00m$
   117	[37m[39;49;00m$
   118	[37m    [39;49;00m[37m/// (This function was inlined in the original program) [39;49;00m[37m[39;49;00m$
   119	[37m    [39;49;00m[37m/// Finds all alternatives for the given phone number [39;49;00m[37m[39;49;00m$
   120	[37m    [39;49;00m[37m/// Returns: array of strings [39;49;00m[37m[39;49;00m$
   121	[37m    [39;49;00mstringarray[37m [39;49;00mFindWords([37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00mphone_number[37m [39;49;00m)[37m[39;49;00m$
   122	[37m    [39;49;00m{[37m[39;49;00m$
   123	[37m        [39;49;00m[34mif[39;49;00m[37m [39;49;00m(!phone_number.length)[37m[39;49;00m$
   124	[37m            [39;49;00m[34mreturn[39;49;00m[37m [39;49;00m[34mnull[39;49;00m;[37m[39;49;00m$
   125	[37m        [39;49;00m[37m// Strip the non-digit characters from the phone number, and[39;49;00m[37m[39;49;00m$
   126	[37m        [39;49;00m[37m// pass it to the recursive function (leading digit is allowed)[39;49;00m[37m[39;49;00m$
   127	[37m        [39;49;00m[34mreturn[39;49;00m[37m [39;49;00m_FindWords([37m [39;49;00mstripNonDigit(phone_number),[37m [39;49;00m[34mtrue[39;49;00m[37m [39;49;00m);[37m    [39;49;00m$
   128	[37m    [39;49;00m}[37m    [39;49;00m$
   129	[37m    [39;49;00m$
   130	[37m    [39;49;00m[37m// Read the phone numbers     [39;49;00m[37m[39;49;00m$
   131	[37m    [39;49;00m[34mforeach[39;49;00m([36mstring[39;49;00m[37m [39;49;00mphone;[37m [39;49;00m[34mnew[39;49;00m[37m [39;49;00mBufferedFile([33m"input.txt"[39;49;00m[37m   [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   132	[37m        [39;49;00m[34mforeach[39;49;00m(alternative;[37m [39;49;00mFindWords([37m [39;49;00mphone[37m [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   133	[37m            [39;49;00mwritefln(phone,[37m [39;49;00m[33m": "[39;49;00m,[37m [39;49;00malternative[37m [39;49;00m);[37m[39;49;00m$
   134	}$
