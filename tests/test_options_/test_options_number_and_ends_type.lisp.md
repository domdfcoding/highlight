     1	[37m;;;; TYPEP und Verwandtes[39;49;00m[37m[39;49;00m$
     2	[37m;;;; Michael Stoll, 21. 10. 1988[39;49;00m[37m[39;49;00m$
     3	[37m;;;; Bruno Haible, 10.6.1989[39;49;00m[37m[39;49;00m$
     4	[37m;;;; Sam Steingold 2000-2005[39;49;00m[37m[39;49;00m$
     5	[37m[39;49;00m$
     6	[37m;;; Datenstrukturen f√ºr TYPEP:[39;49;00m[37m[39;49;00m$
     7	[37m;;; - Ein Type-Specifier-Symbol hat auf seiner Propertyliste unter dem[39;49;00m[37m[39;49;00m$
     8	[37m;;;   Indikator SYS::TYPE-SYMBOL eine Funktion von einem Argument, die[39;49;00m[37m[39;49;00m$
     9	[37m;;;   testet, ob ein Objekt vom richtigen Typ ist.[39;49;00m[37m[39;49;00m$
    10	[37m;;; - Ein Symbol, das eine Type-Specifier-Liste beginnen kann, hat auf seiner[39;49;00m[37m[39;49;00m$
    11	[37m;;;   Propertyliste unter dem Indikator SYS::TYPE-LIST eine Funktion von[39;49;00m[37m[39;49;00m$
    12	[37m;;;   einem Argument f√ºr das zu testende Objekt und zus√§tzlichen Argumenten[39;49;00m[37m[39;49;00m$
    13	[37m;;;   f√ºr die Listenelemente.[39;49;00m[37m[39;49;00m$
    14	[37m;;; - Ein Symbol, das als Typmacro definiert wurde, hat auf seiner Property-[39;49;00m[37m[39;49;00m$
    15	[37m;;;   liste unter dem Indikator SYSTEM::DEFTYPE-EXPANDER den zugeh√∂rigen[39;49;00m[37m[39;49;00m$
    16	[37m;;;   Expander: eine Funktion, die den zu expandierenden Type-Specifier (eine[39;49;00m[37m[39;49;00m$
    17	[37m;;;   mindestens einelementige Liste) als Argument bekommt.[39;49;00m[37m[39;49;00m$
    18	[37m[39;49;00m$
    19	([36min-package[39;49;00m[37m [39;49;00m[33m"EXT"[39;49;00m)[37m[39;49;00m$
    20	([36mexport[39;49;00m[37m [39;49;00m'([31mtype-expand[39;49;00m))[37m[39;49;00m$
    21	([36min-package[39;49;00m[37m [39;49;00m[33m"SYSTEM"[39;49;00m)[37m[39;49;00m$
    22	[37m[39;49;00m$
    23	[37m; vorl√§ufig, solange bis clos.lisp geladen wird:[39;49;00m[37m[39;49;00m$
    24	([34meval-when[39;49;00m[37m [39;49;00m([36meval[39;49;00m)[37m[39;49;00m$
    25	[37m  [39;49;00m([31mpredefun[39;49;00m[37m [39;49;00m[31mclos::built-in-class-p[39;49;00m[37m [39;49;00m([31mobject[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mobject[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
    26	([36munless[39;49;00m[37m [39;49;00m([36mfboundp[39;49;00m[37m [39;49;00m[33m'clos::class-name[39;49;00m)[37m[39;49;00m$
    27	[37m  [39;49;00m([36mdefun[39;49;00m[37m [39;49;00m[31mclos::class-name[39;49;00m[37m [39;49;00m([31mc[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mc[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
    28	)[37m[39;49;00m$
    29	[37m[39;49;00m$
    30	([36mdefun[39;49;00m[37m [39;49;00m[31mtypespec-error[39;49;00m[37m [39;49;00m([31mfun[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
    31	[37m  [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m$
    32	[37m    [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: invalid type specification ~S"[39;49;00m)[37m[39;49;00m$
    33	[37m    [39;49;00m[31mfun[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m$
    34	)[37m [39;49;00m)[37m[39;49;00m$
    35	[37m[39;49;00m$
    36	[37m;; ============================================================================[39;49;00m[37m[39;49;00m$
    37	[37m[39;49;00m$
    38	[37m;; return the CLOS class named by TYPESPEC or NIL[39;49;00m[37m[39;49;00m$
    39	([36mdefun[39;49;00m[37m [39;49;00m[31mclos-class[39;49;00m[37m [39;49;00m([31mtypespec[39;49;00m)[37m[39;49;00m$
    40	[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mcc[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)))[37m[39;49;00m$
    41	[37m    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m[31mcc[39;49;00m[37m [39;49;00m([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31mcc[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[31mcc[39;49;00m)[37m [39;49;00m[31mtypespec[39;49;00m))[37m[39;49;00m$
    42	[37m      [39;49;00m[31mcc[39;49;00m)))[37m[39;49;00m$
    43	[37m[39;49;00m$
    44	[37m;;; TYPEP, CLTL S. 72, S. 42-51[39;49;00m[37m[39;49;00m$
    45	([36mdefun[39;49;00m[37m [39;49;00m[36mtypep[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menv[39;49;00m[37m [39;49;00m[34m&aux[39;49;00m[37m [39;49;00m[31mf[39;49;00m)[37m [39;49;00m[37m; x = Objekt, y = Typ[39;49;00m[37m[39;49;00m$
    46	[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menv[39;49;00m))[37m[39;49;00m$
    47	[37m  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    48	[37m  [39;49;00m([36mcond[39;49;00m[37m[39;49;00m$
    49	[37m    [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
    50	[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
    51	[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
    52	[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'DEFSTRUCT-DESCRIPTION[39;49;00m))[37m [39;49;00m([31mds-typep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mf[39;49;00m))[37m[39;49;00m$
    53	[37m             [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([31mclos-class[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    54	[37m              [39;49;00m[37m; It's not worth handling structure classes specially here.[39;49;00m[37m[39;49;00m$
    55	[37m              [39;49;00m([31mclos::typep-class[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mf[39;49;00m))[37m[39;49;00m$
    56	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    57	[37m    [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
    58	[37m    [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
    59	[37m       [39;49;00m([36mcond[39;49;00m[37m[39;49;00m$
    60	[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'SATISFIES[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m$
    61	[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    62	[37m              [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m$
    63	[37m                [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to SATISFIES must be a symbol: ~S"[39;49;00m)[37m[39;49;00m$
    64	[37m                [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
    65	[37m            [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
    66	[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m([36msymbol-function[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
    67	[37m         [39;49;00m)[37m[39;49;00m$
    68	[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'MEMBER[39;49;00m)[37m[39;49;00m$
    69	[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mmember[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m [39;49;00m[31mt[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
    70	[37m         [39;49;00m)[37m[39;49;00m$
    71	[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'EQL[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m$
    72	[37m            [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    73	[37m         [39;49;00m)[37m[39;49;00m$
    74	[37m         [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'NOT[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m$
    75	[37m            [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
    76	[37m         [39;49;00m)[37m[39;49;00m$
    77	[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'AND[39;49;00m)[37m[39;49;00m$
    78	[37m            [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mt[39;49;00m)[37m[39;49;00m$
    79	[37m              [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
    80	[37m         [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
    81	[37m         [39;49;00m(([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'OR[39;49;00m)[37m[39;49;00m$
    82	[37m            [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
    83	[37m              [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
    84	[37m         [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
    85	[37m         [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m [39;49;00m([36mapply[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
    86	[37m         [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    87	[37m    [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
    88	[37m    [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([31mclos::typep-class[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    89	[37m    [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
    90	[37m    [39;49;00m(([31mencodingp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([31mcharset-typep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    91	[37m    [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
    92	)[37m [39;49;00m)[37m[39;49;00m$
    93	[37m[39;49;00m$
    94	[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m$
    95	[37m[39;49;00m$
    96	[37m;; UPGRADED-ARRAY-ELEMENT-TYPE is a lattice homomorphism, see[39;49;00m[37m[39;49;00m$
    97	[37m;; ANSI CL 15.1.2.1.[39;49;00m[37m[39;49;00m$
    98	([36mdefun[39;49;00m[37m [39;49;00m[36mupgraded-array-element-type[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m)[37m[39;49;00m$
    99	[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m))[37m[39;49;00m$
   100	[37m  [39;49;00m[37m;; see array.d[39;49;00m[37m[39;49;00m$
   101	[37m  [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m$
   102	[37m    [39;49;00m(([31mBIT[39;49;00m)[37m [39;49;00m[33m'BIT[39;49;00m)[37m[39;49;00m$
   103	[37m    [39;49;00m(([31mCHARACTER[39;49;00m)[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m[39;49;00m$
   104	[37m    [39;49;00m(([31mT[39;49;00m)[37m [39;49;00m[33m'T[39;49;00m)[37m[39;49;00m$
   105	[37m    [39;49;00m(([31mNIL[39;49;00m)[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m$
   106	[37m    [39;49;00m([31mt[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m$
   107	[37m         [39;49;00m[33m'NIL[39;49;00m[37m[39;49;00m$
   108	[37m         [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([31msys::subtype-integer[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
   109	[37m           [39;49;00m[37m; Es gilt (or (null low) (subtypep type `(INTEGER ,low ,high)))[39;49;00m[37m[39;49;00m$
   110	[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mminusp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m$
   111	[37m             [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ml[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   112	[37m               [39;49;00m[37m; Es gilt (subtypep type `(UNSIGNED-BYTE ,l))[39;49;00m[37m[39;49;00m$
   113	[37m               [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m [39;49;00m[33m'BIT[39;49;00m)[37m[39;49;00m$
   114	[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m2[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m2[39;49;00m))[37m[39;49;00m$
   115	[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m4[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m4[39;49;00m))[37m[39;49;00m$
   116	[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m8[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m8[39;49;00m))[37m[39;49;00m$
   117	[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m16[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m16[39;49;00m))[37m[39;49;00m$
   118	[37m                     [39;49;00m(([36m<=[39;49;00m[37m [39;49;00m[31ml[39;49;00m[37m [39;49;00m[34m32[39;49;00m)[37m [39;49;00m'([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[34m32[39;49;00m))[37m[39;49;00m$
   119	[37m                     [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)))[37m[39;49;00m$
   120	[37m             [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m[39;49;00m$
   121	[37m               [39;49;00m[33m'CHARACTER[39;49;00m[37m[39;49;00m$
   122	[37m               [39;49;00m[33m'T[39;49;00m)))))))[37m[39;49;00m$
   123	[37m[39;49;00m$
   124	[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m$
   125	[37m[39;49;00m$
   126	[37m;; UPGRADED-COMPLEX-PART-TYPE is a lattice homomorphism, see[39;49;00m[37m[39;49;00m$
   127	[37m;; HyperSpec/Body/fun_complex.html and HyperSpec/Body/syscla_complex.html,[39;49;00m[37m[39;49;00m$
   128	[37m;; and an idempotent. Therefore[39;49;00m[37m[39;49;00m$
   129	[37m;;   (subtypep (upgraded-complex-part-type T1) (upgraded-complex-part-type T2))[39;49;00m[37m[39;49;00m$
   130	[37m;; is equivalent to[39;49;00m[37m[39;49;00m$
   131	[37m;;   (subtypep T1 (upgraded-complex-part-type T2))[39;49;00m[37m[39;49;00m$
   132	[37m;; (Proof: Let U T be an abbreviation for (upgraded-complex-part-type T).[39;49;00m[37m[39;49;00m$
   133	[37m;;  If U T1 <= U T2, then T1 <= U T1 <= U T2.[39;49;00m[37m[39;49;00m$
   134	[37m;;  If T1 <= U T2, then by homomorphism U T1 <= U U T2 = U T2.)[39;49;00m[37m[39;49;00m$
   135	[37m;;[39;49;00m[37m[39;49;00m$
   136	[37m;; For _any_ CL implementation, you could define[39;49;00m[37m[39;49;00m$
   137	[37m;;   (defun upgraded-complex-part-type (type) 'REAL)[39;49;00m[37m[39;49;00m$
   138	[37m;; Likewise for _any_ CL implementation, you could define[39;49;00m[37m[39;49;00m$
   139	[37m;;   (defun upgraded-complex-part-type (type) type)[39;49;00m[37m[39;49;00m$
   140	[37m;; or - again for _any_ CL implementation:[39;49;00m[37m[39;49;00m$
   141	[37m;;   (defun upgraded-complex-part-type (type)[39;49;00m[37m[39;49;00m$
   142	[37m;;     (cond ((subtypep type 'NIL) 'NIL)[39;49;00m[37m[39;49;00m$
   143	[37m;;           ((subtypep type 'SHORT-FLOAT) 'SHORT-FLOAT)[39;49;00m[37m[39;49;00m$
   144	[37m;;           ((subtypep type 'SINGLE-FLOAT) 'SINGLE-FLOAT)[39;49;00m[37m[39;49;00m$
   145	[37m;;           ((subtypep type 'DOUBLE-FLOAT) 'DOUBLE-FLOAT)[39;49;00m[37m[39;49;00m$
   146	[37m;;           ((subtypep type 'LONG-FLOAT) 'LONG-FLOAT)[39;49;00m[37m[39;49;00m$
   147	[37m;;           ((subtypep type 'RATIONAL) 'RATIONAL)[39;49;00m[37m[39;49;00m$
   148	[37m;;           ((subtypep type 'REAL) 'REAL)[39;49;00m[37m[39;49;00m$
   149	[37m;;           (t (error ...))))[39;49;00m[37m[39;49;00m$
   150	[37m;; The reason is that a complex number is immutable: no setters for the[39;49;00m[37m[39;49;00m$
   151	[37m;; realpart and imagpart exist.[39;49;00m[37m[39;49;00m$
   152	[37m;;[39;49;00m[37m[39;49;00m$
   153	[37m;; We choose the second implementation because it allows the most precise[39;49;00m[37m[39;49;00m$
   154	[37m;; type inference.[39;49;00m[37m[39;49;00m$
   155	([36mdefun[39;49;00m[37m [39;49;00m[36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m)[37m[39;49;00m$
   156	[37m  [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31menvironment[39;49;00m))[37m[39;49;00m$
   157	[37m  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36msubtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m)[37m[39;49;00m$
   158	[37m    [39;49;00m[34mtype[39;49;00m[37m[39;49;00m$
   159	[37m    [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m$
   160	[37m      [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: type ~S is not a subtype of ~S"[39;49;00m)[37m[39;49;00m$
   161	[37m      [39;49;00m[33m'upgraded-complex-part-type[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[33m'real[39;49;00m)))[37m[39;49;00m$
   162	[37m[39;49;00m$
   163	[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m$
   164	[37m[39;49;00m$
   165	[37m;; Macros for defining the various built-in "atomic type specifier"s and[39;49;00m[37m[39;49;00m$
   166	[37m;; "compound type specifier"s. The following macros add information for both[39;49;00m[37m[39;49;00m$
   167	[37m;; the TYPEP function above and the c-TYPEP in the compiler.[39;49;00m[37m[39;49;00m$
   168	[37m[39;49;00m$
   169	[37m; Alist symbol -> funname, used by the compiler.[39;49;00m[37m[39;49;00m$
   170	([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist1[39;49;00m[37m [39;49;00m'())[37m[39;49;00m$
   171	[37m; Alist symbol -> lambdabody, used by the compiler.[39;49;00m[37m[39;49;00m$
   172	([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist2[39;49;00m[37m [39;49;00m'())[37m[39;49;00m$
   173	[37m; Alist symbol -> expander function, used by the compiler.[39;49;00m[37m[39;49;00m$
   174	([36mdefparameter[39;49;00m[37m [39;49;00m[31mc-typep-alist3[39;49;00m[37m [39;49;00m'())[37m[39;49;00m$
   175	[37m[39;49;00m$
   176	[37m; (def-atomic-type symbol function-name)[39;49;00m[37m[39;49;00m$
   177	[37m; defines an atomic type. The function-name designates a function taking one[39;49;00m[37m[39;49;00m$
   178	[37m; argument and returning a generalized boolean value. It can be either a[39;49;00m[37m[39;49;00m$
   179	[37m; symbol or a lambda expression.[39;49;00m[37m[39;49;00m$
   180	([36mdefmacro[39;49;00m[37m [39;49;00m[31mdef-atomic-type[39;49;00m[37m [39;49;00m([04m[32msymbol[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m[39;49;00m$
   181	[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlambdap[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m)[37m [39;49;00m[33m'LAMBDA[39;49;00m))))[37m[39;49;00m$
   182	[37m    [39;49;00m`([31mPROGN[39;49;00m[37m[39;49;00m$
   183	[37m       [39;49;00m([31mSETF[39;49;00m[37m [39;49;00m([31mGET[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m[39;49;00m$
   184	[37m             [39;49;00m,([34mif[39;49;00m[37m [39;49;00m[31mlambdap[39;49;00m[37m[39;49;00m$
   185	[37m                [39;49;00m`([31mFUNCTION[39;49;00m[37m [39;49;00m,([31mconcat-pnames[39;49;00m[37m [39;49;00m[33m"TYPE-SYMBOL-"[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m [39;49;00m,[31mfunname[39;49;00m)[37m[39;49;00m$
   186	[37m                [39;49;00m`([31mFUNCTION[39;49;00m[37m [39;49;00m,[31mfunname[39;49;00m)[37m[39;49;00m$
   187	[37m              [39;49;00m)[37m[39;49;00m$
   188	[37m       [39;49;00m)[37m[39;49;00m$
   189	[37m       [39;49;00m,([34mif[39;49;00m[37m [39;49;00m[31mlambdap[39;49;00m[37m[39;49;00m$
   190	[37m          [39;49;00m`([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST2[39;49;00m[37m[39;49;00m$
   191	[37m                 [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST2[39;49;00m[37m [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m',[39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mfunname[39;49;00m))))[37m[39;49;00m$
   192	[37m           [39;49;00m)[37m[39;49;00m$
   193	[37m          [39;49;00m`([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST1[39;49;00m[37m[39;49;00m$
   194	[37m                 [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST1[39;49;00m[37m [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m',funname[39;49;00m)))[37m[39;49;00m$
   195	[37m           [39;49;00m)[37m[39;49;00m$
   196	[37m        [39;49;00m)[37m[39;49;00m$
   197	[37m       [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m$
   198	[37m     [39;49;00m)[37m[39;49;00m$
   199	)[37m [39;49;00m)[37m[39;49;00m$
   200	[37m[39;49;00m$
   201	[37m; (def-compound-type symbol lambda-list (x) check-form typep-form c-typep-form)[39;49;00m[37m[39;49;00m$
   202	[37m; defines a compound type. The lambda-list is of the form (&optional ...)[39;49;00m[37m[39;49;00m$
   203	[37m; where the arguments come from the CDR of the type specifier.[39;49;00m[37m[39;49;00m$
   204	[37m; For typep-form, x is an object.[39;49;00m[37m[39;49;00m$
   205	[37m; For c-typep-form, x is a multiply evaluatable form (actually a gensym).[39;49;00m[37m[39;49;00m$
   206	[37m; check-form is a form performing error checking, may call `error'.[39;49;00m[37m[39;49;00m$
   207	[37m; typep-form should return a generalized boolean value.[39;49;00m[37m[39;49;00m$
   208	[37m; c-typep-form should produce a form returning a generalized boolean value.[39;49;00m[37m[39;49;00m$
   209	([36mdefmacro[39;49;00m[37m [39;49;00m[31mdef-compound-type[39;49;00m[37m [39;49;00m([04m[32msymbol[39;49;00m[37m [39;49;00m[31mlambdalist[39;49;00m[37m [39;49;00m([31mvar[39;49;00m)[37m [39;49;00m[31mcheck-form[39;49;00m[37m [39;49;00m[31mtypep-form[39;49;00m[37m [39;49;00m[31mc-typep-form[39;49;00m)[37m[39;49;00m$
   210	[37m  [39;49;00m`([31mPROGN[39;49;00m[37m[39;49;00m$
   211	[37m     [39;49;00m([31mSETF[39;49;00m[37m [39;49;00m([31mGET[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m[39;49;00m$
   212	[37m           [39;49;00m([31mFUNCTION[39;49;00m[37m [39;49;00m,([31mconcat-pnames[39;49;00m[37m [39;49;00m[33m"TYPE-LIST-"[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m[39;49;00m$
   213	[37m             [39;49;00m([31mLAMBDA[39;49;00m[37m [39;49;00m(,[31mvar[39;49;00m[37m [39;49;00m,@[31mlambdalist[39;49;00m)[37m[39;49;00m$
   214	[37m               [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m[31mcheck-form[39;49;00m[37m[39;49;00m$
   215	[37m                   [39;49;00m`(([31mMACROLET[39;49;00m[37m [39;49;00m(([31mERROR[39;49;00m[37m [39;49;00m([31m&REST[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m$
   216	[37m                                  [39;49;00m([31mLIST*[39;49;00m[37m [39;49;00m[33m'ERROR-OF-TYPE[39;49;00m[37m [39;49;00m'[33m'ERROR[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m$
   217	[37m                               [39;49;00m))[37m[39;49;00m$
   218	[37m                       [39;49;00m,[31mcheck-form[39;49;00m[37m[39;49;00m$
   219	[37m                    [39;49;00m))[37m[39;49;00m$
   220	[37m                 [39;49;00m)[37m[39;49;00m$
   221	[37m               [39;49;00m,[31mtypep-form[39;49;00m[37m[39;49;00m$
   222	[37m     [39;49;00m)[37m     [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   223	[37m     [39;49;00m([31mSETQ[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST3[39;49;00m[37m[39;49;00m$
   224	[37m           [39;49;00m([31mNCONC[39;49;00m[37m [39;49;00m[31mC-TYPEP-ALIST3[39;49;00m[37m[39;49;00m$
   225	[37m                  [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m([31mCONS[39;49;00m[37m [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m$
   226	[37m                              [39;49;00m[32m#'[39;49;00m([31mLAMBDA[39;49;00m[37m [39;49;00m(,[31mvar[39;49;00m[37m [39;49;00m,@[31mlambdalist[39;49;00m[37m [39;49;00m[31m&REST[39;49;00m[37m [39;49;00m[31mILLEGAL-ARGS[39;49;00m)[37m[39;49;00m$
   227	[37m                                  [39;49;00m([31mDECLARE[39;49;00m[37m [39;49;00m([31mIGNORE[39;49;00m[37m [39;49;00m[31mILLEGAL-ARGS[39;49;00m))[37m[39;49;00m$
   228	[37m                                  [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m[31mcheck-form[39;49;00m[37m[39;49;00m$
   229	[37m                                      [39;49;00m`(([31mMACROLET[39;49;00m[37m [39;49;00m(([31mERROR[39;49;00m[37m [39;49;00m([31m&REST[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m$
   230	[37m                                                     [39;49;00m([31mLIST[39;49;00m[37m [39;49;00m[33m'PROGN[39;49;00m[37m[39;49;00m$
   231	[37m                                                           [39;49;00m([31mLIST*[39;49;00m[37m [39;49;00m[33m'C-WARN[39;49;00m[37m [39;49;00m[31mERROR-ARGS[39;49;00m)[37m[39;49;00m$
   232	[37m                                                           [39;49;00m'([31mTHROW[39;49;00m[37m [39;49;00m[33m'C-TYPEP[39;49;00m[37m [39;49;00m[31mNIL[39;49;00m)[37m[39;49;00m$
   233	[37m                                                  [39;49;00m))[37m [39;49;00m)[37m[39;49;00m$
   234	[37m                                          [39;49;00m,[31mcheck-form[39;49;00m[37m[39;49;00m$
   235	[37m                                       [39;49;00m))[37m[39;49;00m$
   236	[37m                                    [39;49;00m)[37m[39;49;00m$
   237	[37m                                  [39;49;00m,[31mc-typep-form[39;49;00m[37m[39;49;00m$
   238	[37m                                [39;49;00m)[37m[39;49;00m$
   239	[37m     [39;49;00m)[37m     [39;49;00m)[37m      [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m$
   240	[37m     [39;49;00m[33m',symbol[39;49;00m[37m[39;49;00m$
   241	[37m   [39;49;00m)[37m[39;49;00m$
   242	)[37m[39;49;00m$
   243	[37m[39;49;00m$
   244	[37m; CLtL1 p. 43[39;49;00m[37m[39;49;00m$
   245	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[36marrayp[39;49;00m)[37m[39;49;00m$
   246	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mATOM[39;49;00m[37m [39;49;00m[36matom[39;49;00m)[37m[39;49;00m$
   247	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBASE-CHAR[39;49;00m[37m[39;49;00m$
   248	[37m  [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m$
   249	[37m  [39;49;00m[36mcharacterp[39;49;00m[37m[39;49;00m$
   250	[37m  [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m$
   251	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([31mbase-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m[39;49;00m$
   252	)[37m[39;49;00m$
   253	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m[39;49;00m$
   254	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   255	[37m    [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   256	[37m         [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   257	[37m             [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m[37m [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'BASE-CHAR[39;49;00m[37m[39;49;00m$
   258	)[37m [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m$
   259	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIGNUM[39;49;00m[37m[39;49;00m$
   260	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([31mfixnump[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   261	)[37m[39;49;00m$
   262	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIT[39;49;00m[37m[39;49;00m$
   263	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m1[39;49;00m)))[37m[39;49;00m$
   264	)[37m[39;49;00m$
   265	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m[36mbit-vector-p[39;49;00m)[37m[39;49;00m$
   266	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBOOLEAN[39;49;00m[37m[39;49;00m$
   267	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'nil[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m't[39;49;00m)))[37m[39;49;00m$
   268	)[37m[39;49;00m$
   269	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCHARACTER[39;49;00m[37m [39;49;00m[36mcharacterp[39;49;00m)[37m[39;49;00m$
   270	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCOMPILED-FUNCTION[39;49;00m[37m [39;49;00m[36mcompiled-function-p[39;49;00m)[37m[39;49;00m$
   271	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m[36mcomplexp[39;49;00m)[37m[39;49;00m$
   272	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m[36mconsp[39;49;00m)[37m[39;49;00m$
   273	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mDOUBLE-FLOAT[39;49;00m[37m [39;49;00m[31mdouble-float-p[39;49;00m)[37m[39;49;00m$
   274	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mENCODING[39;49;00m[37m [39;49;00m[31mencodingp[39;49;00m)[37m[39;49;00m$
   275	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mEXTENDED-CHAR[39;49;00m[37m[39;49;00m$
   276	[37m  [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m$
   277	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
   278	[37m  [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m[39;49;00m$
   279	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([31mbase-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   280	)[37m[39;49;00m$
   281	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFIXNUM[39;49;00m[37m [39;49;00m[31mfixnump[39;49;00m)[37m[39;49;00m$
   282	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFLOAT[39;49;00m[37m [39;49;00m[36mfloatp[39;49;00m)[37m[39;49;00m$
   283	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFUNCTION[39;49;00m[37m [39;49;00m[36mfunctionp[39;49;00m)[37m[39;49;00m$
   284	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mHASH-TABLE[39;49;00m[37m [39;49;00m[36mhash-table-p[39;49;00m)[37m[39;49;00m$
   285	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mINTEGER[39;49;00m[37m [39;49;00m[36mintegerp[39;49;00m)[37m[39;49;00m$
   286	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mKEYWORD[39;49;00m[37m [39;49;00m[36mkeywordp[39;49;00m)[37m[39;49;00m$
   287	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLIST[39;49;00m[37m [39;49;00m[36mlistp[39;49;00m)[37m[39;49;00m$
   288	#+[31mLOGICAL-PATHNAMES[39;49;00m[37m[39;49;00m$
   289	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLOGICAL-PATHNAME[39;49;00m[37m [39;49;00m[31mlogical-pathname-p[39;49;00m)[37m[39;49;00m$
   290	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mLONG-FLOAT[39;49;00m[37m [39;49;00m[31mlong-float-p[39;49;00m)[37m[39;49;00m$
   291	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNIL[39;49;00m[37m[39;49;00m$
   292	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
   293	)[37m[39;49;00m$
   294	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNULL[39;49;00m[37m [39;49;00m[36mnull[39;49;00m)[37m[39;49;00m$
   295	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mNUMBER[39;49;00m[37m [39;49;00m[36mnumberp[39;49;00m)[37m[39;49;00m$
   296	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPACKAGE[39;49;00m[37m [39;49;00m[36mpackagep[39;49;00m)[37m[39;49;00m$
   297	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPATHNAME[39;49;00m[37m [39;49;00m[36mpathnamep[39;49;00m)[37m[39;49;00m$
   298	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRANDOM-STATE[39;49;00m[37m [39;49;00m[36mrandom-state-p[39;49;00m)[37m[39;49;00m$
   299	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRATIO[39;49;00m[37m[39;49;00m$
   300	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mrationalp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   301	)[37m[39;49;00m$
   302	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mRATIONAL[39;49;00m[37m [39;49;00m[36mrationalp[39;49;00m)[37m[39;49;00m$
   303	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mREADTABLE[39;49;00m[37m [39;49;00m[36mreadtablep[39;49;00m)[37m[39;49;00m$
   304	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mREAL[39;49;00m[37m [39;49;00m[36mrealp[39;49;00m)[37m[39;49;00m$
   305	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSEQUENCE[39;49;00m[37m [39;49;00m[31msequencep[39;49;00m)[37m[39;49;00m$
   306	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSHORT-FLOAT[39;49;00m[37m [39;49;00m[31mshort-float-p[39;49;00m)[37m[39;49;00m$
   307	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31msimple-array-p[39;49;00m)[37m[39;49;00m$
   308	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m[39;49;00m$
   309	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   310	[37m    [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   311	[37m         [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   312	[37m             [39;49;00m#+[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m[37m [39;49;00m#-[31mBASE-CHAR=CHARACTER[39;49;00m[37m [39;49;00m[33m'BASE-CHAR[39;49;00m[37m[39;49;00m$
   313	)[37m [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m$
   314	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[36msimple-bit-vector-p[39;49;00m)[37m[39;49;00m$
   315	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[36msimple-string-p[39;49;00m)[37m[39;49;00m$
   316	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[36msimple-vector-p[39;49;00m)[37m[39;49;00m$
   317	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSINGLE-FLOAT[39;49;00m[37m [39;49;00m[31msingle-float-p[39;49;00m)[37m[39;49;00m$
   318	([36mdefun[39;49;00m[37m [39;49;00m[31m%standard-char-p[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcharacterp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mstandard-char-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m[37m; ABI[39;49;00m[37m[39;49;00m$
   319	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTANDARD-CHAR[39;49;00m[37m [39;49;00m[31m%standard-char-p[39;49;00m)[37m[39;49;00m$
   320	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCLOS:STANDARD-OBJECT[39;49;00m[37m [39;49;00m[31mclos::std-instance-p[39;49;00m)[37m[39;49;00m$
   321	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTREAM[39;49;00m[37m [39;49;00m[36mstreamp[39;49;00m)[37m[39;49;00m$
   322	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mFILE-STREAM[39;49;00m[37m [39;49;00m[31mfile-stream-p[39;49;00m)[37m[39;49;00m$
   323	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSYNONYM-STREAM[39;49;00m[37m [39;49;00m[31msynonym-stream-p[39;49;00m)[37m[39;49;00m$
   324	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mBROADCAST-STREAM[39;49;00m[37m [39;49;00m[31mbroadcast-stream-p[39;49;00m)[37m[39;49;00m$
   325	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCONCATENATED-STREAM[39;49;00m[37m [39;49;00m[31mconcatenated-stream-p[39;49;00m)[37m[39;49;00m$
   326	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mTWO-WAY-STREAM[39;49;00m[37m [39;49;00m[31mtwo-way-stream-p[39;49;00m)[37m[39;49;00m$
   327	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mECHO-STREAM[39;49;00m[37m [39;49;00m[31mecho-stream-p[39;49;00m)[37m[39;49;00m$
   328	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING-STREAM[39;49;00m[37m [39;49;00m[31mstring-stream-p[39;49;00m)[37m[39;49;00m$
   329	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[36mstringp[39;49;00m)[37m[39;49;00m$
   330	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSTRING-CHAR[39;49;00m[37m [39;49;00m[36mcharacterp[39;49;00m)[37m[39;49;00m$
   331	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mCLOS:STRUCTURE-OBJECT[39;49;00m[37m [39;49;00m[31mclos::structure-object-p[39;49;00m)[37m[39;49;00m$
   332	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mSYMBOL[39;49;00m[37m [39;49;00m[36msymbolp[39;49;00m)[37m[39;49;00m$
   333	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mT[39;49;00m[37m [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
   334	[37m;; foreign1.lisp is loaded after this file,[39;49;00m[37m[39;49;00m$
   335	[37m;; so these symbols are not external yet[39;49;00m[37m[39;49;00m$
   336	#+[31mffi[39;49;00m[37m[39;49;00m$
   337	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-function[39;49;00m[37m[39;49;00m$
   338	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-function[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   339	#+[31mffi[39;49;00m[37m[39;49;00m$
   340	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-variable[39;49;00m[37m[39;49;00m$
   341	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-variable[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   342	#+[31mffi[39;49;00m[37m[39;49;00m$
   343	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mffi::foreign-address[39;49;00m[37m[39;49;00m$
   344	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'ffi::foreign-address[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   345	[37m;; see lispbibl.d (#define FOREIGN) and predtype.d (TYPE-OF):[39;49;00m[37m[39;49;00m$
   346	#+([36mor[39;49;00m[37m [39;49;00m[31munix[39;49;00m[37m [39;49;00m[31mffi[39;49;00m[37m [39;49;00m[31maffi[39;49;00m[37m [39;49;00m[31mwin32[39;49;00m)[37m[39;49;00m$
   347	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mforeign-pointer[39;49;00m[37m[39;49;00m$
   348	[37m  [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[33m'foreign-pointer[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
   349	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m[36mvectorp[39;49;00m)[37m[39;49;00m$
   350	([31mdef-atomic-type[39;49;00m[37m [39;49;00m[31mPLIST[39;49;00m[37m[39;49;00m$
   351	[37m    [39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mtail[39;49;00m)[37m [39;49;00m([31mlist-length-dotted[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   352	[37m                  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m[31mtail[39;49;00m)[37m [39;49;00m([36mevenp[39;49;00m[37m [39;49;00m[36mlength[39;49;00m)))))[37m[39;49;00m$
   353	[37m[39;49;00m$
   354	([36mdefmacro[39;49;00m[37m [39;49;00m[31mensure-dim[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[31mdim[39;49;00m)[37m[39;49;00m$
   355	[37m  [39;49;00m[37m;; make sure DIM is a valid dimension[39;49;00m[37m[39;49;00m$
   356	[37m  [39;49;00m`([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m[37m [39;49;00m`([31mINTEGER[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m(,[31mARRAY-DIMENSION-LIMIT[39;49;00m))))[37m[39;49;00m$
   357	[37m     [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: dimension ~S is invalid"[39;49;00m)[37m [39;49;00m[33m',type[39;49;00m[37m [39;49;00m,[31mdim[39;49;00m)))[37m[39;49;00m$
   358	[37m[39;49;00m$
   359	([36mdefmacro[39;49;00m[37m [39;49;00m[31mensure-rank[39;49;00m[37m [39;49;00m([34mtype[39;49;00m[37m [39;49;00m[31mrank[39;49;00m)[37m[39;49;00m$
   360	[37m  [39;49;00m[37m;; make sure RANK is a valid rank[39;49;00m[37m[39;49;00m$
   361	[37m  [39;49;00m`([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mrank[39;49;00m[37m [39;49;00m`([31mINTEGER[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m(,[31mARRAY-RANK-LIMIT[39;49;00m)))[37m[39;49;00m$
   362	[37m     [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: rank ~S is invalid"[39;49;00m)[37m [39;49;00m[33m',type[39;49;00m[37m [39;49;00m,[31mrank[39;49;00m)))[37m[39;49;00m$
   363	[37m[39;49;00m$
   364	[37m; CLtL1 p. 46-50[39;49;00m[37m[39;49;00m$
   365	([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-array[39;49;00m[37m [39;49;00m([31mtester[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   366	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   367	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   368	[37m            [39;49;00m'()[37m[39;49;00m$
   369	[37m            [39;49;00m`(([31mEQUAL[39;49;00m[37m [39;49;00m([31mARRAY-ELEMENT-TYPE[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m$
   370	[37m          [39;49;00m)[37m[39;49;00m$
   371	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   372	[37m            [39;49;00m'()[37m[39;49;00m$
   373	[37m            [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   374	[37m              [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m,[31mdims[39;49;00m[37m [39;49;00m([31mARRAY-RANK[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m$
   375	[37m              [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m,([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mARRAY-RANK[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m$
   376	[37m                [39;49;00m,@([34mlet[39;49;00m[37m [39;49;00m(([31mi[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m$
   377	[37m                    [39;49;00m([31mmapcap[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mdim[39;49;00m)[37m[39;49;00m$
   378	[37m                                [39;49;00m([36mprog1[39;49;00m[37m[39;49;00m$
   379	[37m                                  [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdim[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   380	[37m                                    [39;49;00m'()[37m[39;49;00m$
   381	[37m                                    [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m[33m',dim[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m,[31mi[39;49;00m)))[37m[39;49;00m$
   382	[37m                                  [39;49;00m)[37m[39;49;00m$
   383	[37m                                  [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mi[39;49;00m)[37m[39;49;00m$
   384	[37m                              [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   385	[37m                            [39;49;00m[31mdims[39;49;00m[37m[39;49;00m$
   386	[37m                  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   387	[37m               [39;49;00m)[37m[39;49;00m$
   388	[37m          [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   389	[37m   [39;49;00m)[37m[39;49;00m$
   390	)[37m[39;49;00m$
   391	([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-vector[39;49;00m[37m [39;49;00m([31mtester[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   392	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   393	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   394	[37m            [39;49;00m'()[37m[39;49;00m$
   395	[37m            [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m[33m',size[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   396	[37m          [39;49;00m)[37m[39;49;00m$
   397	[37m   [39;49;00m)[37m[39;49;00m$
   398	)[37m[39;49;00m$
   399	([36mdefun[39;49;00m[37m [39;49;00m[31mtypep-number-test[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
   400	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   401	[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m$
   402	[37m             [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   403	[37m             [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m$
   404	[37m                [39;49;00m([36m<[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   405	[37m             [39;49;00m)[37m[39;49;00m$
   406	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m$
   407	[37m                  [39;49;00m#1=([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to ~S must be *, ~S or a list of ~S: ~S"[39;49;00m)[37m[39;49;00m$
   408	[37m                  [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m$
   409	[37m       [39;49;00m)[37m     [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
   410	[37m       [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m$
   411	[37m             [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   412	[37m             [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtest[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   413	[37m                [39;49;00m([36m>[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   414	[37m             [39;49;00m)[37m[39;49;00m$
   415	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31merror-of-type[39;49;00m[37m [39;49;00m[33m'error[39;49;00m[37m[39;49;00m$
   416	[37m                  [39;49;00m#1#[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m[39;49;00m$
   417	)[37m [39;49;00m)[37m    [39;49;00m)[37m     [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
   418	([36mdefun[39;49;00m[37m [39;49;00m[31mc-typep-number[39;49;00m[37m [39;49;00m([31mcaller[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   419	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m(,[31mtester[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   420	[37m        [39;49;00m,@([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'())[37m[39;49;00m$
   421	[37m                [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m`(([36m<=[39;49;00m[37m [39;49;00m,[31mlow[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m$
   422	[37m                [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m$
   423	[37m                 [39;49;00m`(([36m<[39;49;00m[37m [39;49;00m,([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m$
   424	[37m                [39;49;00m)[37m[39;49;00m$
   425	[37m                [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mc-warn[39;49;00m[37m [39;49;00m#1=([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to ~S must be *, ~S or a list of ~S: ~S"[39;49;00m)[37m[39;49;00m$
   426	[37m                           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m$
   427	[37m                   [39;49;00m)[37m[39;49;00m$
   428	[37m                   [39;49;00m([34mthrow[39;49;00m[37m [39;49;00m[33m'c-TYPEP[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
   429	[37m          [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m$
   430	[37m        [39;49;00m,@([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'())[37m[39;49;00m$
   431	[37m                [39;49;00m(([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m`(([36m>=[39;49;00m[37m [39;49;00m,[31mhigh[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)))[37m[39;49;00m$
   432	[37m                [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   433	[37m                 [39;49;00m`(([36m>[39;49;00m[37m [39;49;00m,([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m$
   434	[37m                [39;49;00m)[37m[39;49;00m$
   435	[37m                [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mc-warn[39;49;00m[37m [39;49;00m#1#[37m [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mcaller[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m$
   436	[37m                   [39;49;00m([34mthrow[39;49;00m[37m [39;49;00m[33m'c-TYPEP[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m[39;49;00m$
   437	[37m          [39;49;00m)[37m     [39;49;00m)[37m[39;49;00m$
   438	[37m   [39;49;00m)[37m[39;49;00m$
   439	)[37m[39;49;00m$
   440	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   441	[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   442	[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   443	[37m      [39;49;00m([31mensure-rank[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   444	[37m      [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mdim[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mdim[39;49;00m))))[37m[39;49;00m$
   445	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36marrayp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   446	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   447	[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m$
   448	[37m       [39;49;00m)[37m[39;49;00m$
   449	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   450	[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   451	[37m             [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   452	[37m             [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   453	[37m                  [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)))[37m[39;49;00m$
   454	[37m                         [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-dimensions[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   455	[37m  [39;49;00m)[37m    [39;49;00m)[37m   [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m$
   456	[37m  [39;49;00m([31mc-typep-array[39;49;00m[37m [39;49;00m[33m'ARRAYP[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   457	)[37m[39;49;00m$
   458	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   459	[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   460	[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   461	[37m      [39;49;00m([31mensure-rank[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   462	[37m      [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mdim[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m[37m [39;49;00m[31mdim[39;49;00m))))[37m[39;49;00m$
   463	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31msimple-array-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   464	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   465	[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m$
   466	[37m       [39;49;00m)[37m[39;49;00m$
   467	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   468	[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m[39;49;00m$
   469	[37m             [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   470	[37m             [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mdims[39;49;00m)[37m [39;49;00m([36marray-rank[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   471	[37m                  [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31ma[39;49;00m[37m [39;49;00m[31mb[39;49;00m)))[37m[39;49;00m$
   472	[37m                         [39;49;00m[31mdims[39;49;00m[37m [39;49;00m([36marray-dimensions[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   473	[37m  [39;49;00m)[37m    [39;49;00m)[37m   [39;49;00m)[37m [39;49;00m)[37m    [39;49;00m)[37m[39;49;00m$
   474	[37m  [39;49;00m([31mc-typep-array[39;49;00m[37m [39;49;00m[33m'SIMPLE-ARRAY-P[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[31mdims[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   475	)[37m[39;49;00m$
   476	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   477	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mVECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   478	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mvectorp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   479	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   480	[37m           [39;49;00m([36mequal[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m))[37m[39;49;00m$
   481	[37m       [39;49;00m)[37m[39;49;00m$
   482	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31msize[39;49;00m))[37m[39;49;00m$
   483	[37m  [39;49;00m)[37m[39;49;00m$
   484	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mVECTORP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   485	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   486	[37m            [39;49;00m'()[37m[39;49;00m$
   487	[37m            [39;49;00m`(([31mEQUAL[39;49;00m[37m [39;49;00m([31mARRAY-ELEMENT-TYPE[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m$
   488	[37m          [39;49;00m)[37m[39;49;00m$
   489	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   490	[37m            [39;49;00m'()[37m[39;49;00m$
   491	[37m            [39;49;00m`(([31mEQL[39;49;00m[37m [39;49;00m([31mARRAY-DIMENSION[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[33m',size[39;49;00m))[37m[39;49;00m$
   492	[37m          [39;49;00m)[37m[39;49;00m$
   493	[37m   [39;49;00m)[37m[39;49;00m$
   494	)[37m[39;49;00m$
   495	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   496	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMLPE-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   497	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   498	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   499	[37m  [39;49;00m)[37m[39;49;00m$
   500	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   501	)[37m[39;49;00m$
   502	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mitype[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   503	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   504	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mcomplexp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   505	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   506	[37m           [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mrealpart[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m)))[37m[39;49;00m$
   507	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mitype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   508	[37m           [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mimagpart[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mitype[39;49;00m))))[37m[39;49;00m$
   509	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mCOMPLEXP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   510	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   511	[37m            [39;49;00m'()[37m[39;49;00m$
   512	[37m            [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mREALPART[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mrtype[39;49;00m))))[37m[39;49;00m$
   513	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mitype[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   514	[37m            [39;49;00m'()[37m[39;49;00m$
   515	[37m            [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mIMAGPART[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',[39;49;00m([36mupgraded-complex-part-type[39;49;00m[37m [39;49;00m[31mitype[39;49;00m))))))[37m[39;49;00m$
   516	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mINTEGER[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   517	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   518	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mintegerp[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m$
   519	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m[37m [39;49;00m[33m'INTEGERP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   520	)[37m[39;49;00m$
   521	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mMOD[39;49;00m[37m [39;49;00m([31mn[39;49;00m)[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   522	[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m)[37m[39;49;00m$
   523	[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to MOD must be an integer: ~S"[39;49;00m)[37m[39;49;00m$
   524	[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m$
   525	[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   526	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m$
   527	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m([31mNOT[39;49;00m[37m [39;49;00m([31mMINUSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m,[31mx[39;49;00m[37m [39;49;00m,[31mn[39;49;00m))[37m[39;49;00m$
   528	)[37m[39;49;00m$
   529	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIGNED-BYTE[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   530	[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m$
   531	[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to SIGNED-BYTE must be an integer or * : ~S"[39;49;00m)[37m[39;49;00m$
   532	[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m$
   533	[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   534	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36m<[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m$
   535	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   536	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([36m<[39;49;00m[37m [39;49;00m([31mINTEGER-LENGTH[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m,[31mn[39;49;00m)))[37m[39;49;00m$
   537	[37m   [39;49;00m)[37m[39;49;00m$
   538	)[37m[39;49;00m$
   539	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   540	[37m  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m$
   541	[37m    [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S: argument to UNSIGNED-BYTE must be an integer or * : ~S"[39;49;00m)[37m[39;49;00m$
   542	[37m           [39;49;00m[33m'typep[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m[39;49;00m$
   543	[37m  [39;49;00m)[37m [39;49;00m)[37m[39;49;00m$
   544	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   545	[37m       [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36mminusp[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m[39;49;00m$
   546	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m([36minteger-length[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mn[39;49;00m))[37m[39;49;00m$
   547	[37m  [39;49;00m)[37m[39;49;00m$
   548	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mINTEGERP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m([31mNOT[39;49;00m[37m [39;49;00m([31mMINUSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m))[37m[39;49;00m$
   549	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([36m<=[39;49;00m[37m [39;49;00m([31mINTEGER-LENGTH[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m,[31mn[39;49;00m)))[37m[39;49;00m$
   550	[37m   [39;49;00m)[37m[39;49;00m$
   551	)[37m[39;49;00m$
   552	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mREAL[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   553	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   554	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mrealp[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m)[37m[39;49;00m$
   555	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'REAL[39;49;00m[37m [39;49;00m[33m'REALP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   556	)[37m[39;49;00m$
   557	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mRATIONAL[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   558	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   559	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mrationalp[39;49;00m[37m [39;49;00m[33m'RATIONAL[39;49;00m)[37m[39;49;00m$
   560	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'RATIONAL[39;49;00m[37m [39;49;00m[33m'RATIONALP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   561	)[37m[39;49;00m$
   562	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mFLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   563	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   564	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36mfloatp[39;49;00m[37m [39;49;00m[33m'FLOAT[39;49;00m)[37m[39;49;00m$
   565	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'FLOAT[39;49;00m[37m [39;49;00m[33m'FLOATP[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   566	)[37m[39;49;00m$
   567	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSHORT-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   568	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   569	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mshort-float-p[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT[39;49;00m)[37m[39;49;00m$
   570	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT[39;49;00m[37m [39;49;00m[33m'SHORT-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   571	)[37m[39;49;00m$
   572	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSINGLE-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   573	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   574	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31msingle-float-p[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT[39;49;00m)[37m[39;49;00m$
   575	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT[39;49;00m[37m [39;49;00m[33m'SINGLE-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   576	)[37m[39;49;00m$
   577	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mDOUBLE-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   578	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   579	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mdouble-float-p[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT[39;49;00m)[37m[39;49;00m$
   580	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT[39;49;00m[37m [39;49;00m[33m'DOUBLE-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   581	)[37m[39;49;00m$
   582	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mLONG-FLOAT[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   583	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   584	[37m  [39;49;00m([31mtypep-number-test[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mlong-float-p[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT[39;49;00m)[37m[39;49;00m$
   585	[37m  [39;49;00m([31mc-typep-number[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT[39;49;00m[37m [39;49;00m[33m'LONG-FLOAT-P[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   586	)[37m[39;49;00m$
   587	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   588	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   589	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   590	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   591	[37m  [39;49;00m)[37m[39;49;00m$
   592	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'STRINGP[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   593	)[37m[39;49;00m$
   594	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   595	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   596	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   597	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   598	[37m  [39;49;00m)[37m[39;49;00m$
   599	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-STRING-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   600	)[37m[39;49;00m$
   601	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   602	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   603	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mstringp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   604	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   605	[37m  [39;49;00m)[37m[39;49;00m$
   606	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'STRINGP[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   607	)[37m[39;49;00m$
   608	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   609	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   610	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-string-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   611	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   612	[37m  [39;49;00m)[37m[39;49;00m$
   613	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-STRING-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   614	)[37m[39;49;00m$
   615	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   616	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   617	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mbit-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   618	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   619	[37m  [39;49;00m)[37m[39;49;00m$
   620	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'BIT-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   621	)[37m[39;49;00m$
   622	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   623	[37m  [39;49;00m([31mensure-dim[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[31msize[39;49;00m)[37m[39;49;00m$
   624	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36msimple-bit-vector-p[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   625	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m([36marray-dimension[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[34m0[39;49;00m)))[37m[39;49;00m$
   626	[37m  [39;49;00m)[37m[39;49;00m$
   627	[37m  [39;49;00m([31mc-typep-vector[39;49;00m[37m [39;49;00m[33m'SIMPLE-BIT-VECTOR-P[39;49;00m[37m [39;49;00m[31msize[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   628	)[37m[39;49;00m$
   629	([31mdef-compound-type[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m([34m&optional[39;49;00m[37m [39;49;00m([31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
   630	[37m  [39;49;00m[31mnil[39;49;00m[37m[39;49;00m$
   631	[37m  [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
   632	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mcar-type[39;49;00m))[37m[39;49;00m$
   633	[37m       [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mcdr-type[39;49;00m))[37m[39;49;00m$
   634	[37m  [39;49;00m)[37m[39;49;00m$
   635	[37m  [39;49;00m`([31mAND[39;49;00m[37m [39;49;00m([31mCONSP[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m[39;49;00m$
   636	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcar-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mCAR[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',car-type[39;49;00m)))[37m[39;49;00m$
   637	[37m        [39;49;00m,@([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mcdr-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m'()[37m [39;49;00m`(([31mTYPEP[39;49;00m[37m [39;49;00m([31mCDR[39;49;00m[37m [39;49;00m,[31mx[39;49;00m)[37m [39;49;00m[33m',cdr-type[39;49;00m)))[37m[39;49;00m$
   638	[37m   [39;49;00m)[37m[39;49;00m$
   639	)[37m[39;49;00m$
   640	[37m[39;49;00m$
   641	([36mfmakunbound[39;49;00m[37m [39;49;00m[33m'def-compound-type[39;49;00m)[37m[39;49;00m$
   642	[37m[39;49;00m$
   643	[37m;; ----------------------------------------------------------------------------[39;49;00m[37m[39;49;00m$
   644	[37m[39;49;00m$
   645	[37m; Typtest ohne Gefahr einer Fehlermeldung. F√ºr SIGNAL und HANDLER-BIND.[39;49;00m[37m[39;49;00m$
   646	([36mdefun[39;49;00m[37m [39;49;00m[31msafe-typep[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31menv[39;49;00m)[37m[39;49;00m$
   647	[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31m*error-handler*[39;49;00m[37m[39;49;00m$
   648	[37m          [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([34m&rest[39;49;00m[37m [39;49;00m[31merror-args[39;49;00m)[37m[39;49;00m$
   649	[37m              [39;49;00m([34mdeclare[39;49;00m[37m [39;49;00m([34mignore[39;49;00m[37m [39;49;00m[31merror-args[39;49;00m))[37m[39;49;00m$
   650	[37m              [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31msafe-typep[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mnil[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   651	[37m       [39;49;00m))[37m   [39;49;00m)[37m[39;49;00m$
   652	[37m    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31menv[39;49;00m)[37m [39;49;00m[31mt[39;49;00m)[37m[39;49;00m$
   653	)[37m [39;49;00m)[37m[39;49;00m$
   654	[37m[39;49;00m$
   655	[37m; Umwandlung eines "type for declaration" in einen "type for discrimination".[39;49;00m[37m[39;49;00m$
   656	([36mdefun[39;49;00m[37m [39;49;00m[31mtype-for-discrimination[39;49;00m[37m [39;49;00m([31my[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m([31mnotp[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m[34m&aux[39;49;00m[37m [39;49;00m[31mf[39;49;00m)[37m[39;49;00m$
   657	[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   658	[37m           [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   659	[37m                 [39;49;00m(([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   660	[37m                 [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[33m'DEFTYPE-EXPANDER[39;49;00m))[37m[39;49;00m$
   661	[37m                  [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mlist[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
   662	[37m                         [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m)))[37m[39;49;00m$
   663	[37m                    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m[39;49;00m$
   664	[37m                 [39;49;00m))[37m[39;49;00m$
   665	[37m                 [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   666	[37m        [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
   667	[37m        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)))[37m[39;49;00m$
   668	[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   669	[37m             [39;49;00m(([31mSATISFIES[39;49;00m[37m [39;49;00m[31mMEMBER[39;49;00m[37m [39;49;00m[31mEQL[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   670	[37m             [39;49;00m([31mNOT[39;49;00m[37m[39;49;00m$
   671	[37m              [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
   672	[37m                     [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m))))[37m[39;49;00m$
   673	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m`([31mNOT[39;49;00m[37m [39;49;00m,[31mzx[39;49;00m))[37m[39;49;00m$
   674	[37m             [39;49;00m))[37m[39;49;00m$
   675	[37m             [39;49;00m(([31mAND[39;49;00m[37m [39;49;00m[31mOR[39;49;00m[37m [39;49;00m[31mCOMPLEX[39;49;00m[37m [39;49;00m[31mVALUES[39;49;00m)[37m[39;49;00m$
   676	[37m              [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
   677	[37m                     [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([36mmapcar[39;49;00m[37m [39;49;00m[32m#'[39;49;00m([34mlambda[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m))[37m [39;49;00m[31mz[39;49;00m)))[37m[39;49;00m$
   678	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mevery[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[36meql[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m([36mcons[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[31mzx[39;49;00m))[37m[39;49;00m$
   679	[37m             [39;49;00m))[37m[39;49;00m$
   680	[37m             [39;49;00m([31mFUNCTION[39;49;00m[37m[39;49;00m$
   681	[37m              [39;49;00m[37m;; (FUNCTION arg-types res-type) is somewhere between[39;49;00m[37m[39;49;00m$
   682	[37m              [39;49;00m[37m;; NIL and FUNCTION, but undecidable.[39;49;00m[37m[39;49;00m$
   683	[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m[37m [39;49;00m[33m'FUNCTION[39;49;00m)[37m[39;49;00m$
   684	[37m             [39;49;00m)[37m[39;49;00m$
   685	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   686	[37m                      [39;49;00m(([34msetq[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m [39;49;00m[33m'DEFTYPE-EXPANDER[39;49;00m))[37m[39;49;00m$
   687	[37m                       [39;49;00m([34mlet*[39;49;00m[37m [39;49;00m(([31mz[39;49;00m[37m [39;49;00m([36mfuncall[39;49;00m[37m [39;49;00m[31mf[39;49;00m[37m [39;49;00m[31my[39;49;00m))[37m[39;49;00m$
   688	[37m                              [39;49;00m([31mzx[39;49;00m[37m [39;49;00m([31mtype-for-discrimination[39;49;00m[37m [39;49;00m[31mz[39;49;00m[37m [39;49;00m[31mnotp[39;49;00m)))[37m[39;49;00m$
   689	[37m                         [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mzx[39;49;00m[37m [39;49;00m[31mz[39;49;00m)[37m [39;49;00m[31my[39;49;00m[37m [39;49;00m[31mzx[39;49;00m)[37m[39;49;00m$
   690	[37m                      [39;49;00m))[37m[39;49;00m$
   691	[37m                      [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   692	[37m        [39;49;00m)[37m  [39;49;00m)[37m [39;49;00m)[37m  [39;49;00m)[37m[39;49;00m$
   693	[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[31my[39;49;00m)[37m[39;49;00m$
   694	)[37m [39;49;00m)[37m[39;49;00m$
   695	[37m[39;49;00m$
   696	[37m; Testet eine Liste von Werten auf Erf√ºllen eines Type-Specifiers. F√ºr THE.[39;49;00m[37m[39;49;00m$
   697	([36mdefun[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[37m; ABI[39;49;00m[37m[39;49;00m$
   698	[37m  [39;49;00m([34mmacrolet[39;49;00m[37m [39;49;00m(([31mnear-typep[39;49;00m[37m [39;49;00m([31mobjform[39;49;00m[37m [39;49;00m[31mtypform[39;49;00m)[37m[39;49;00m$
   699	[37m               [39;49;00m[37m;; near-typep ist wie typep, nur dass das Objekt auch ein[39;49;00m[37m[39;49;00m$
   700	[37m               [39;49;00m[37m;; Read-Label sein darf. Das tritt z.B. auf bei[39;49;00m[37m[39;49;00m$
   701	[37m               [39;49;00m[37m;; (read-from-string "#1=#S(FOO :X #1#)")[39;49;00m[37m[39;49;00m$
   702	[37m               [39;49;00m[37m;; im Konstruktor MAKE-FOO. Die Implementation ist aber[39;49;00m[37m[39;49;00m$
   703	[37m               [39;49;00m[37m;; nicht gezwungen, bei fehlerhaftem THE zwingend einen[39;49;00m[37m[39;49;00m$
   704	[37m               [39;49;00m[37m;; Fehler zu melden, darum ist ein lascherer Typcheck hier[39;49;00m[37m[39;49;00m$
   705	[37m               [39;49;00m[37m;; erlaubt.[39;49;00m[37m[39;49;00m$
   706	[37m               [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mg[39;49;00m[37m [39;49;00m([36mgensym[39;49;00m)))[37m[39;49;00m$
   707	[37m                 [39;49;00m`([34mlet[39;49;00m[37m [39;49;00m((,[31mg[39;49;00m[37m [39;49;00m,[31mobjform[39;49;00m))[37m[39;49;00m$
   708	[37m                    [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m,[31mg[39;49;00m[37m [39;49;00m,[31mtypform[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mtype-of[39;49;00m[37m [39;49;00m,[31mg[39;49;00m)[37m [39;49;00m[33m'READ-LABEL[39;49;00m))))))[37m[39;49;00m$
   709	[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'VALUES[39;49;00m))[37m[39;49;00m$
   710	[37m      [39;49;00m[37m;; The VALUES type specifier is ill-defined in ANSI CL.[39;49;00m[37m[39;49;00m$
   711	[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m$
   712	[37m      [39;49;00m[37m;; There are two possibilities to define a VALUES type specifier in a[39;49;00m[37m[39;49;00m$
   713	[37m      [39;49;00m[37m;; sane way:[39;49;00m[37m[39;49;00m$
   714	[37m      [39;49;00m[37m;; - (EXACT-VALUES type1 ... [&optional ...]) describes the exact shape[39;49;00m[37m[39;49;00m$
   715	[37m      [39;49;00m[37m;;   of the values list, as received by MULTIPLE-VALUE-LIST.[39;49;00m[37m[39;49;00m$
   716	[37m      [39;49;00m[37m;;   For example, (EXACT-VALUES SYMBOL) is matched by (values 'a) but not[39;49;00m[37m[39;49;00m$
   717	[37m      [39;49;00m[37m;;   by (values 'a 'b) or (values).[39;49;00m[37m[39;49;00m$
   718	[37m      [39;49;00m[37m;; - (ASSIGNABLE-VALUES type1 ... [&optional ...]) describes the values[39;49;00m[37m[39;49;00m$
   719	[37m      [39;49;00m[37m;;   as received by a set of variables through MULTIPLE-VALUE-BIND or[39;49;00m[37m[39;49;00m$
   720	[37m      [39;49;00m[37m;;   MULTIPLE-VALUE-SETQ. For example, (ASSIGNABLE-VALUES SYMBOL) is[39;49;00m[37m[39;49;00m$
   721	[37m      [39;49;00m[37m;;   defined by whether[39;49;00m[37m[39;49;00m$
   722	[37m      [39;49;00m[37m;;     (MULTIPLE-VALUE-BIND (var1) values (DECLARE (TYPE SYMBOL var1)) ...)[39;49;00m[37m[39;49;00m$
   723	[37m      [39;49;00m[37m;;   is valid or not; therefore (ASSIGNABLE-VALUES SYMBOL) is matched by[39;49;00m[37m[39;49;00m$
   724	[37m      [39;49;00m[37m;;   (values 'a) and (values 'a 'b) and (values).[39;49;00m[37m[39;49;00m$
   725	[37m      [39;49;00m[37m;;   Note that &OPTIONAL is actually redundant here:[39;49;00m[37m[39;49;00m$
   726	[37m      [39;49;00m[37m;;     (ASSIGNABLE-VALUES type1 ... &optional otype1 ...)[39;49;00m[37m[39;49;00m$
   727	[37m      [39;49;00m[37m;;   is equivalent to[39;49;00m[37m[39;49;00m$
   728	[37m      [39;49;00m[37m;;     (ASSIGNABLE-VALUES type1 ... (OR NULL otype1) ...)[39;49;00m[37m[39;49;00m$
   729	[37m      [39;49;00m[37m;; HyperSpec/Body/typspe_values.html indicates that VALUES means[39;49;00m[37m[39;49;00m$
   730	[37m      [39;49;00m[37m;; EXACT-VALUES; however, HyperSpec/Body/speope_the.html indicates that[39;49;00m[37m[39;49;00m$
   731	[37m      [39;49;00m[37m;; VALUES means ASSIGNABLE-VALUES.[39;49;00m[37m[39;49;00m$
   732	[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m$
   733	[37m      [39;49;00m[37m;; SBCL interprets the VALUES type specifier to mean EXACT-VALUES when[39;49;00m[37m[39;49;00m$
   734	[37m      [39;49;00m[37m;; it contains &OPTIONAL or &REST, but ASSIGNABLE-VALUES when it has[39;49;00m[37m[39;49;00m$
   735	[37m      [39;49;00m[37m;; only a tuple of type specifiers. This is utter nonsense, in particular[39;49;00m[37m[39;49;00m$
   736	[37m      [39;49;00m[37m;; because it makes (VALUES type1 ... typek &OPTIONAL)[39;49;00m[37m[39;49;00m$
   737	[37m      [39;49;00m[37m;; different from   (VALUES type1 ... typek).[39;49;00m[37m[39;49;00m$
   738	[37m      [39;49;00m[37m;;[39;49;00m[37m[39;49;00m$
   739	[37m      [39;49;00m[37m;; Here we use the ASSIGNABLE-VALUES interpretation.[39;49;00m[37m[39;49;00m$
   740	[37m      [39;49;00m[37m;; In SUBTYPEP we just punt and don't assume any interpretation.[39;49;00m[37m[39;49;00m$
   741	[37m      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mvals[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m([31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   742	[37m        [39;49;00m[37m;; required:[39;49;00m[37m[39;49;00m$
   743	[37m        [39;49;00m([36mloop[39;49;00m[37m[39;49;00m$
   744	[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
   745	[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m$
   746	[37m          [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   747	[37m            [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m$
   748	[37m        [39;49;00m[37m;; &optional:[39;49;00m[37m[39;49;00m$
   749	[37m        [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&optional[39;49;00m))[37m[39;49;00m$
   750	[37m          [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   751	[37m          [39;49;00m([36mloop[39;49;00m[37m[39;49;00m$
   752	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
   753	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m$
   754	[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   755	[37m              [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))))[37m[39;49;00m$
   756	[37m        [39;49;00m[37m;; &rest &key:[39;49;00m[37m[39;49;00m$
   757	[37m        [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m[39;49;00m$
   758	[37m          [39;49;00m([34m&rest[39;49;00m[37m[39;49;00m$
   759	[37m           [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   760	[37m           [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   761	[37m           [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mvals[39;49;00m)[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   762	[37m             [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m$
   763	[37m          [39;49;00m([34m&key[39;49;00m)[37m[39;49;00m$
   764	[37m          [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   765	[37m        [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&key[39;49;00m)[37m[39;49;00m$
   766	[37m          [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m$
   767	[37m            [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   768	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36moddp[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   769	[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkeywords[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   770	[37m              [39;49;00m([36mloop[39;49;00m[37m[39;49;00m$
   771	[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36matom[39;49;00m[37m [39;49;00m[31mvals[39;49;00m))[37m [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mt[39;49;00m))[37m[39;49;00m$
   772	[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[31mlambda-list-keywords[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m))[37m[39;49;00m$
   773	[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mitem[39;49;00m[37m [39;49;00m([36mpop[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)))[37m[39;49;00m$
   774	[37m                  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlistp[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)[37m [39;49;00m[34m2[39;49;00m)[37m[39;49;00m$
   775	[37m                               [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mitem[39;49;00m)))[37m[39;49;00m$
   776	[37m                    [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   777	[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkw[39;49;00m[37m [39;49;00m([31msymbol-to-keyword[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mitem[39;49;00m))))[37m[39;49;00m$
   778	[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([36mgetf[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m[31mkw[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31mitem[39;49;00m))[37m[39;49;00m$
   779	[37m                      [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   780	[37m                    [39;49;00m([36mpush[39;49;00m[37m [39;49;00m[31mkw[39;49;00m[37m [39;49;00m[31mkeywords[39;49;00m))))[37m[39;49;00m$
   781	[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m[33m'&allow-other-keys[39;49;00m))[37m[39;49;00m$
   782	[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m))[37m[39;49;00m$
   783	[37m                [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mgetf[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m'[33m:allow-other-keys[39;49;00m)[37m[39;49;00m$
   784	[37m                  [39;49;00m([36mdo[39;49;00m[37m [39;49;00m(([31mL[39;49;00m[37m [39;49;00m[31mvals[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[31mL[39;49;00m)))[37m[39;49;00m$
   785	[37m                      [39;49;00m(([36matom[39;49;00m[37m [39;49;00m[31mL[39;49;00m))[37m[39;49;00m$
   786	[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([31mmemq[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[31mL[39;49;00m)[37m [39;49;00m[31mkeywords[39;49;00m)[37m[39;49;00m$
   787	[37m                      [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31m%the[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))))))[37m[39;49;00m$
   788	[37m          [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypes[39;49;00m)[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'the[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   789	[37m        [39;49;00m[31mt[39;49;00m)[37m[39;49;00m$
   790	[37m      [39;49;00m([31mnear-typep[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m[36mvalues[39;49;00m)[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m$
   791	[37m[39;49;00m$
   792	[37m;;; ===========================================================================[39;49;00m[37m[39;49;00m$
   793	[37m[39;49;00m$
   794	[37m;; SUBTYPEP[39;49;00m[37m[39;49;00m$
   795	([36mload[39;49;00m[37m [39;49;00m[33m"subtypep"[39;49;00m)[37m[39;49;00m$
   796	[37m[39;49;00m$
   797	[37m[39;49;00m$
   798	[37m;; Returns the number of bytes that are needed to represent #\Null in a[39;49;00m[37m[39;49;00m$
   799	[37m;; given encoding.[39;49;00m[37m[39;49;00m$
   800	([36mdefun[39;49;00m[37m [39;49;00m[31mencoding-zeroes[39;49;00m[37m [39;49;00m([31mencoding[39;49;00m)[37m[39;49;00m$
   801	[37m  [39;49;00m#+[31mUNICODE[39;49;00m[37m[39;49;00m$
   802	[37m  [39;49;00m[37m;; this should use min_bytes_per_char for cache, not the hash table[39;49;00m[37m[39;49;00m$
   803	[37m  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mname[39;49;00m[37m [39;49;00m([31mext:encoding-charset[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m))[37m[39;49;00m$
   804	[37m        [39;49;00m([31mtable[39;49;00m[37m [39;49;00m#.([36mmake-hash-table[39;49;00m[37m [39;49;00m[33m:key-type[39;49;00m[37m [39;49;00m'([36mor[39;49;00m[37m [39;49;00m[36mstring[39;49;00m[37m [39;49;00m[04m[32msymbol[39;49;00m)[37m [39;49;00m[33m:value-type[39;49;00m[37m [39;49;00m[33m'fixnum[39;49;00m[37m[39;49;00m$
   805	[37m                                  [39;49;00m[33m:test[39;49;00m[37m [39;49;00m[33m'stablehash-equal[39;49;00m[37m [39;49;00m[33m:warn-if-needs-rehash-after-gc[39;49;00m[37m [39;49;00m[31mt[39;49;00m[37m[39;49;00m$
   806	[37m                                  [39;49;00m[33m:initial-contents[39;49;00m[37m [39;49;00m'(([33m"UTF-7"[39;49;00m[37m [39;49;00m.[37m [39;49;00m[34m1[39;49;00m))))[37m[39;49;00m$
   807	[37m        [39;49;00m([31mtester[39;49;00m[37m [39;49;00m#.([36mmake-string[39;49;00m[37m [39;49;00m[34m2[39;49;00m[37m [39;49;00m[33m:initial-element[39;49;00m[37m [39;49;00m([36mcode-char[39;49;00m[37m [39;49;00m[34m0[39;49;00m))))[37m[39;49;00m$
   808	[37m    [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36mgethash[39;49;00m[37m [39;49;00m[31mname[39;49;00m[37m [39;49;00m[31mtable[39;49;00m)[37m[39;49;00m$
   809	[37m        [39;49;00m([36msetf[39;49;00m[37m [39;49;00m([36mgethash[39;49;00m[37m [39;49;00m[31mname[39;49;00m[37m [39;49;00m[31mtable[39;49;00m)[37m[39;49;00m$
   810	[37m              [39;49;00m([36m-[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m([31mext:convert-string-to-bytes[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m))[37m[39;49;00m$
   811	[37m                 [39;49;00m([36mlength[39;49;00m[37m [39;49;00m([31mext:convert-string-to-bytes[39;49;00m[37m [39;49;00m[31mtester[39;49;00m[37m [39;49;00m[31mencoding[39;49;00m[37m[39;49;00m$
   812	[37m                                                      [39;49;00m[33m:end[39;49;00m[37m [39;49;00m[34m1[39;49;00m))))))[37m[39;49;00m$
   813	[37m  [39;49;00m#-[31mUNICODE[39;49;00m[37m [39;49;00m[34m1[39;49;00m)[37m[39;49;00m$
   814	[37m[39;49;00m$
   815	[37m;; Determines two values low,high such that[39;49;00m[37m[39;49;00m$
   816	[37m;;   (subtypep type `(INTEGER ,low ,high))[39;49;00m[37m[39;49;00m$
   817	[37m;; holds and low is as large as possible and high is as small as possible.[39;49;00m[37m[39;49;00m$
   818	[37m;; low = * means -infinity, high = * means infinity.[39;49;00m[37m[39;49;00m$
   819	[37m;; When (subtypep type 'INTEGER) is false, the values NIL,NIL are returned.[39;49;00m[37m[39;49;00m$
   820	[37m;; We need this function only for MAKE-ARRAY, UPGRADED-ARRAY-ELEMENT-TYPE and[39;49;00m[37m[39;49;00m$
   821	[37m;; OPEN and can therefore w.l.o.g. replace[39;49;00m[37m[39;49;00m$
   822	[37m;;   type  with  `(OR ,type (MEMBER 0))[39;49;00m[37m[39;49;00m$
   823	[37m#|[39;49;00m[37m ;; The original implementation calls canonicalize-type and then applies[39;49;00m$
   824	[37m   ;; a particular SUBTYPE variant:[39;49;00m$
   825	[37m (defun subtype-integer (type)[39;49;00m$
   826	[37m  (macrolet ((yes () '(return-from subtype-integer (values low high)))[39;49;00m$
   827	[37m             (no () '(return-from subtype-integer nil))[39;49;00m$
   828	[37m             (unknown () '(return-from subtype-integer nil)))[39;49;00m$
   829	[37m    (setq type (canonicalize-type type))[39;49;00m$
   830	[37m    (if (consp type)[39;49;00m$
   831	[37m      (case (first type)[39;49;00m$
   832	[37m        (MEMBER ; (MEMBER &rest objects)[39;49;00m$
   833	[37m          ;; All elements must be of type INTEGER.[39;49;00m$
   834	[37m          (let ((low 0) (high 0)) ; wlog![39;49;00m$
   835	[37m            (dolist (x (rest type) (yes))[39;49;00m$
   836	[37m              (unless (typep x 'INTEGER) (return (no)))[39;49;00m$
   837	[37m              (setq low (min low x) high (max high x)))))[39;49;00m$
   838	[37m        (OR ; (OR type*)[39;49;00m$
   839	[37m          ;; Every type must be subtype of INTEGER.[39;49;00m$
   840	[37m          (let ((low 0) (high 0)) ; wlog![39;49;00m$
   841	[37m            (dolist (type1 (rest type) (yes))[39;49;00m$
   842	[37m              (multiple-value-bind (low1 high1) (subtype-integer type1)[39;49;00m$
   843	[37m                (unless low1 (return (no)))[39;49;00m$
   844	[37m                (setq low (if (or (eq low '*) (eq low1 '*)) '* (min low low1))[39;49;00m$
   845	[37m                      high (if (or (eq high '*) (eq high1 '*))[39;49;00m$
   846	[37m                               '* (max high high1)))))))[39;49;00m$
   847	[37m        (AND ; (AND type*)[39;49;00m$
   848	[37m          ;; If one of the types is subtype of INTEGER, then yes,[39;49;00m$
   849	[37m          ;; otherwise unknown.[39;49;00m$
   850	[37m          (let ((low nil) (high nil))[39;49;00m$
   851	[37m            (dolist (type1 (rest type))[39;49;00m$
   852	[37m              (multiple-value-bind (low1 high1) (subtype-integer type1)[39;49;00m$
   853	[37m                (when low1[39;49;00m$
   854	[37m                  (if low[39;49;00m$
   855	[37m                    (setq low (if (eq low '*) low1 (if (eq low1 '*) low (max low low1)))[39;49;00m$
   856	[37m                          high (if (eq high '*) high1 (if (eq high1 '*) high (min high high1))))[39;49;00m$
   857	[37m                    (setq low low1 high high1)))))[39;49;00m$
   858	[37m            (if low[39;49;00m$
   859	[37m              (progn[39;49;00m$
   860	[37m                (when (and (numberp low) (numberp high) (not (<= low high)))[39;49;00m$
   861	[37m                  (setq low 0 high 0) ; type equivalent to NIL)[39;49;00m$
   862	[37m                (yes))[39;49;00m$
   863	[37m              (unknown)))))[39;49;00m$
   864	[37m      (setq type (list type)))[39;49;00m$
   865	[37m    (if (eq (first type) 'INTEGER)[39;49;00m$
   866	[37m      (let ((low (if (rest type) (second type) '*))[39;49;00m$
   867	[37m            (high (if (cddr type) (third type) '*)))[39;49;00m$
   868	[37m        (when (consp low)[39;49;00m$
   869	[37m          (setq low (first low))[39;49;00m$
   870	[37m          (when (numberp low) (incf low)))[39;49;00m$
   871	[37m        (when (consp high)[39;49;00m$
   872	[37m          (setq high (first high))[39;49;00m$
   873	[37m          (when (numberp high) (decf high)))[39;49;00m$
   874	[37m        (when (and (numberp low) (numberp high) (not (<= low high))) ; type leer?[39;49;00m$
   875	[37m          (setq low 0 high 0))[39;49;00m$
   876	[37m        (yes))[39;49;00m$
   877	[37m      (if (and (eq (first type) 'INTERVALS) (eq (second type) 'INTEGER))[39;49;00m$
   878	[37m        (let ((low (third type))[39;49;00m$
   879	[37m              (high (car (last type))))[39;49;00m$
   880	[37m          (when (consp low)[39;49;00m$
   881	[37m            (setq low (first low))[39;49;00m$
   882	[37m            (when (numberp low) (incf low)))[39;49;00m$
   883	[37m          (when (consp high)[39;49;00m$
   884	[37m            (setq high (first high))[39;49;00m$
   885	[37m            (when (numberp high) (decf high)))[39;49;00m$
   886	[37m          (yes))[39;49;00m$
   887	[37m        (unknown)))))[39;49;00m$
   888	[37m|#[39;49;00m[37m [39;49;00m[37m;; This implementation inlines the (tail-recursive) canonicalize-type[39;49;00m[37m[39;49;00m$
   889	[37m   [39;49;00m[37m;; function. Its advantage is that it doesn't cons as much.[39;49;00m[37m[39;49;00m$
   890	[37m   [39;49;00m[37m;; (For example, (subtype-integer '(UNSIGNED-BYTE 8)) doesn't cons.)[39;49;00m[37m[39;49;00m$
   891	([36mdefun[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m([34mtype[39;49;00m)[37m[39;49;00m$
   892	[37m  [39;49;00m([34mmacrolet[39;49;00m[37m [39;49;00m(([31myes[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   893	[37m             [39;49;00m([31mno[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   894	[37m             [39;49;00m([31munknown[39;49;00m[37m [39;49;00m()[37m [39;49;00m'([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)))[37m[39;49;00m$
   895	[37m    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   896	[37m    [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
   897	[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m$
   898	[37m             [39;49;00m([31mBIT[39;49;00m[37m [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m1[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m$
   899	[37m             [39;49;00m([31mFIXNUM[39;49;00m[37m[39;49;00m$
   900	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m'#,[31mmost-negative-fixnum[39;49;00m)[37m[39;49;00m$
   901	[37m                    [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m'#,[31mmost-positive-fixnum[39;49;00m))[37m[39;49;00m$
   902	[37m                [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m$
   903	[37m             [39;49;00m(([31mINTEGER[39;49;00m[37m [39;49;00m[31mBIGNUM[39;49;00m[37m [39;49;00m[31mSIGNED-BYTE[39;49;00m)[37m[39;49;00m$
   904	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m$
   905	[37m             [39;49;00m([31mUNSIGNED-BYTE[39;49;00m[37m[39;49;00m$
   906	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m$
   907	[37m             [39;49;00m(([31mNIL[39;49;00m)[37m[39;49;00m$
   908	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m([31myes[39;49;00m)))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m$
   909	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m$
   910	[37m          [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   911	[37m           [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlist-length[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m$
   912	[37m             [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   913	[37m           [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
   914	[37m             [39;49;00m([31mMEMBER[39;49;00m[37m [39;49;00m[37m; (MEMBER &rest objects)[39;49;00m[37m[39;49;00m$
   915	[37m              [39;49;00m[37m;; All elements must be of type INTEGER.[39;49;00m[37m[39;49;00m$
   916	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m$
   917	[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   918	[37m                  [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m$
   919	[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))))[37m[39;49;00m$
   920	[37m             [39;49;00m([31mEQL[39;49;00m[37m [39;49;00m[37m; (EQL object)[39;49;00m[37m[39;49;00m$
   921	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mx[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   922	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m$
   923	[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   924	[37m                  [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m$
   925	[37m             [39;49;00m([31mOR[39;49;00m[37m [39;49;00m[37m; (OR type*)[39;49;00m[37m[39;49;00m$
   926	[37m              [39;49;00m[37m;; Every type must be subtype of INTEGER.[39;49;00m[37m[39;49;00m$
   927	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; wlog![39;49;00m[37m[39;49;00m$
   928	[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mtype1[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   929	[37m                  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow1[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)[37m [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m[31mtype1[39;49;00m)[37m[39;49;00m$
   930	[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m([36mreturn[39;49;00m[37m [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m$
   931	[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m$
   932	[37m                                  [39;49;00m[33m'*[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m))[37m[39;49;00m$
   933	[37m                          [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m$
   934	[37m                                   [39;49;00m[33m'*[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)))))))[37m[39;49;00m$
   935	[37m             [39;49;00m([31mAND[39;49;00m[37m [39;49;00m[37m; (AND type*)[39;49;00m[37m[39;49;00m$
   936	[37m              [39;49;00m[37m;; If one of the types is subtype of INTEGER, then yes,[39;49;00m[37m[39;49;00m$
   937	[37m              [39;49;00m[37m;; otherwise unknown.[39;49;00m[37m[39;49;00m$
   938	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[31mnil[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
   939	[37m                [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mtype1[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   940	[37m                  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mlow1[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)[37m [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m[31mtype1[39;49;00m)[37m[39;49;00m$
   941	[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m$
   942	[37m                      [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m$
   943	[37m                        [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m$
   944	[37m                                      [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m$
   945	[37m                                          [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m)))[37m[39;49;00m$
   946	[37m                              [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mhigh1[39;49;00m[37m[39;49;00m$
   947	[37m                                       [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m[31mhigh[39;49;00m[37m[39;49;00m$
   948	[37m                                           [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m))))[37m[39;49;00m$
   949	[37m                        [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mlow1[39;49;00m[37m[39;49;00m$
   950	[37m                              [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[31mhigh1[39;49;00m)))))[37m[39;49;00m$
   951	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m[39;49;00m$
   952	[37m                  [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m$
   953	[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m$
   954	[37m                               [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   955	[37m                      [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; type equivalent to NIL[39;49;00m[37m[39;49;00m$
   956	[37m                    [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   957	[37m                  [39;49;00m([31munknown[39;49;00m))))[37m[39;49;00m$
   958	[37m             [39;49;00m([31mINTEGER[39;49;00m[37m[39;49;00m$
   959	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m))[37m[39;49;00m$
   960	[37m                    [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mthird[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m$
   961	[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m[39;49;00m$
   962	[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m[39;49;00m$
   963	[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m$
   964	[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m$
   965	[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m$
   966	[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mdecf[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   967	[37m                [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mnot[39;49;00m[37m [39;49;00m([36m<=[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   968	[37m                  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[37m; type equivalent to NIL[39;49;00m[37m[39;49;00m$
   969	[37m                [39;49;00m([31myes[39;49;00m)))[37m[39;49;00m$
   970	[37m             [39;49;00m([31mINTERVALS[39;49;00m[37m[39;49;00m$
   971	[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m$
   972	[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mthird[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   973	[37m                      [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mcar[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m$
   974	[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m[39;49;00m$
   975	[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mlow[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mlow[39;49;00m))[37m[39;49;00m$
   976	[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)[37m [39;49;00m([36mincf[39;49;00m[37m [39;49;00m[31mlow[39;49;00m)))[37m[39;49;00m$
   977	[37m                  [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m[39;49;00m$
   978	[37m                    [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m))[37m[39;49;00m$
   979	[37m                    [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mnumberp[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)[37m [39;49;00m([36mdecf[39;49;00m[37m [39;49;00m[31mhigh[39;49;00m)))[37m[39;49;00m$
   980	[37m                  [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   981	[37m                [39;49;00m([31munknown[39;49;00m)))[37m[39;49;00m$
   982	[37m             [39;49;00m([31mMOD[39;49;00m[37m [39;49;00m[37m; (MOD n)[39;49;00m[37m[39;49;00m$
   983	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
   984	[37m                [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31mn[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m$
   985	[37m                  [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   986	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mn[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m[39;49;00m$
   987	[37m                  [39;49;00m([31mno[39;49;00m)[37m[39;49;00m$
   988	[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m$
   989	[37m                    [39;49;00m([31myes[39;49;00m)))))[37m[39;49;00m$
   990	[37m             [39;49;00m([31mSIGNED-BYTE[39;49;00m[37m [39;49;00m[37m; (SIGNED-BYTE &optional s)[39;49;00m[37m[39;49;00m$
   991	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ms[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m$
   992	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
   993	[37m                  [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
   994	[37m                  [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m$
   995	[37m                    [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31ms[39;49;00m)[37m [39;49;00m([36mplusp[39;49;00m[37m [39;49;00m[31ms[39;49;00m))[37m[39;49;00m$
   996	[37m                      [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
   997	[37m                    [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36mash[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31ms[39;49;00m))))[37m [39;49;00m[37m; (ash 1 *) == (expt 2 *)[39;49;00m[37m[39;49;00m$
   998	[37m                      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36m-[39;49;00m[37m [39;49;00m[31mn[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m$
   999	[37m                        [39;49;00m([31myes[39;49;00m)))))))[37m[39;49;00m$
  1000	[37m             [39;49;00m([31mUNSIGNED-BYTE[39;49;00m[37m [39;49;00m[37m; (UNSIGNED-BYTE &optional s)[39;49;00m[37m[39;49;00m$
  1001	[37m              [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31ms[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m$
  1002	[37m                [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
  1003	[37m                    [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m[33m'*[39;49;00m))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
  1004	[37m                    [39;49;00m([34mprogn[39;49;00m[37m[39;49;00m$
  1005	[37m                      [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mintegerp[39;49;00m[37m [39;49;00m[31ms[39;49;00m)[37m [39;49;00m([36m>=[39;49;00m[37m [39;49;00m[31ms[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m[39;49;00m$
  1006	[37m                        [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1007	[37m                      [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mn[39;49;00m[37m [39;49;00m([36mash[39;49;00m[37m [39;49;00m[34m1[39;49;00m[37m [39;49;00m[31ms[39;49;00m)))[37m [39;49;00m[37m; (ash 1 *) == (expt 2 *)[39;49;00m[37m[39;49;00m$
  1008	[37m                        [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36m1-[39;49;00m[37m [39;49;00m[31mn[39;49;00m)))[37m[39;49;00m$
  1009	[37m                          [39;49;00m([31myes[39;49;00m)))))))[37m[39;49;00m$
  1010	[37m             [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m$
  1011	[37m          [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1012	[37m           [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31mclos::built-in-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1013	[37m                    [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1014	[37m             [39;49;00m([34mreturn-from[39;49;00m[37m [39;49;00m[31msubtype-integer[39;49;00m[37m[39;49;00m$
  1015	[37m               [39;49;00m([31msubtype-integer[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
  1016	[37m             [39;49;00m([31mno[39;49;00m)))[37m[39;49;00m$
  1017	[37m          [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1018	[37m           [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mx[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
  1019	[37m             [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mtypep[39;49;00m[37m [39;49;00m[31mx[39;49;00m[37m [39;49;00m[33m'INTEGER[39;49;00m)[37m[39;49;00m$
  1020	[37m               [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mlow[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m))[37m [39;49;00m([31mhigh[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[34m0[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m [39;49;00m([31myes[39;49;00m))[37m[39;49;00m$
  1021	[37m               [39;49;00m([31mno[39;49;00m))))[37m[39;49;00m$
  1022	[37m          [39;49;00m(([31mencodingp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([31mno[39;49;00m))[37m[39;49;00m$
  1023	[37m          [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))))[37m[39;49;00m$
  1024	[37m[39;49;00m$
  1025	[37m#|[39;49;00m[37m TODO: Fix subtype-integer such that this works.[39;49;00m$
  1026	[37mHenry Baker:[39;49;00m$
  1027	[37m (defun type-null (x)[39;49;00m$
  1028	[37m  (values (and (eq 'bit (upgraded-array-element-type `(or bit ,x)))[39;49;00m$
  1029	[37m               (not (typep 0 x))[39;49;00m$
  1030	[37m               (not (typep 1 x)))[39;49;00m$
  1031	[37m          t))[39;49;00m$
  1032	[37m (type-null '(and symbol number))[39;49;00m$
  1033	[37m (type-null '(and integer symbol))[39;49;00m$
  1034	[37m (type-null '(and integer character))[39;49;00m$
  1035	[37m|#[39;49;00m[37m[39;49;00m$
  1036	[37m[39;49;00m$
  1037	[37m;; Determines a sequence kind (an atom, as defined in defseq.lisp: one of[39;49;00m[37m[39;49;00m$
  1038	[37m;;   LIST - stands for LIST[39;49;00m[37m[39;49;00m$
  1039	[37m;;   VECTOR - stands for (VECTOR T)[39;49;00m[37m[39;49;00m$
  1040	[37m;;   STRING - stands for (VECTOR CHARACTER)[39;49;00m[37m[39;49;00m$
  1041	[37m;;   1, 2, 4, 8, 16, 32 - stands for (VECTOR (UNSIGNED-BYTE n))[39;49;00m[37m[39;49;00m$
  1042	[37m;;   0 - stands for (VECTOR NIL))[39;49;00m[37m[39;49;00m$
  1043	[37m;; that indicates the sequence type meant by the given type. Other possible[39;49;00m[37m[39;49;00m$
  1044	[37m;; return values are[39;49;00m[37m[39;49;00m$
  1045	[37m;;   SEQUENCE - denoting a type whose intersection with (OR LIST VECTOR) is not[39;49;00m[37m[39;49;00m$
  1046	[37m;;              subtype of LIST or VECTOR, or[39;49;00m[37m[39;49;00m$
  1047	[37m;;   NIL - indicating a type whose intersection with (OR LIST VECTOR) is empty.[39;49;00m[37m[39;49;00m$
  1048	[37m;; When the type is (OR (VECTOR eltype1) ... (VECTOR eltypeN)), the chosen[39;49;00m[37m[39;49;00m$
  1049	[37m;; element type is the smallest element type that contains all of eltype1 ...[39;49;00m[37m[39;49;00m$
  1050	[37m;; eltypeN.[39;49;00m[37m[39;49;00m$
  1051	[37m;;[39;49;00m[37m[39;49;00m$
  1052	[37m;; User-defined sequence types are not supported here.[39;49;00m[37m[39;49;00m$
  1053	[37m;;[39;49;00m[37m[39;49;00m$
  1054	[37m;; This implementation inlines the (tail-recursive) canonicalize-type[39;49;00m[37m[39;49;00m$
  1055	[37m;; function. Its advantage is that it doesn't cons as much. Also it employs[39;49;00m[37m[39;49;00m$
  1056	[37m;; some heuristics and does not have the full power of SUBTYPEP.[39;49;00m[37m[39;49;00m$
  1057	([36mdefun[39;49;00m[37m [39;49;00m[31msubtype-sequence[39;49;00m[37m [39;49;00m([34mtype[39;49;00m)[37m[39;49;00m$
  1058	[37m  [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1059	[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1060	[37m         [39;49;00m([36mcase[39;49;00m[37m [39;49;00m[34mtype[39;49;00m[37m[39;49;00m$
  1061	[37m           [39;49;00m(([31mLIST[39;49;00m[37m [39;49;00m[31mCONS[39;49;00m[37m [39;49;00m[31mNULL[39;49;00m)[37m [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m$
  1062	[37m           [39;49;00m(([31mNIL[39;49;00m)[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m$
  1063	[37m           [39;49;00m(([31mBIT-VECTOR[39;49;00m[37m [39;49;00m[31mSIMPLE-BIT-VECTOR[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m$
  1064	[37m           [39;49;00m(([31mSTRING[39;49;00m[37m [39;49;00m[31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m$
  1065	[37m           [39;49;00m(([31mVECTOR[39;49;00m[37m [39;49;00m[31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1066	[37m           [39;49;00m(([31mSEQUENCE[39;49;00m)[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m$
  1067	[37m           [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m$
  1068	[37m        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
  1069	[37m         [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([36mlist-length[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36mnull[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m([36mlast[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))))[37m[39;49;00m$
  1070	[37m           [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1071	[37m         [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1072	[37m           [39;49;00m([31mMEMBER[39;49;00m[37m [39;49;00m[37m; (MEMBER &rest objects)[39;49;00m[37m[39;49;00m$
  1073	[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m$
  1074	[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1075	[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-union[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
  1076	[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m$
  1077	[37m           [39;49;00m([31mEQL[39;49;00m[37m [39;49;00m[37m; (EQL object)[39;49;00m[37m[39;49;00m$
  1078	[37m            [39;49;00m([36munless[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m([36mlength[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[34m2[39;49;00m)[37m[39;49;00m$
  1079	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1080	[37m            [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
  1081	[37m           [39;49;00m([31mOR[39;49;00m[37m [39;49;00m[37m; (OR type*)[39;49;00m[37m[39;49;00m$
  1082	[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m$
  1083	[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1084	[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-union[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
  1085	[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m$
  1086	[37m           [39;49;00m([31mAND[39;49;00m[37m [39;49;00m[37m; (AND type*)[39;49;00m[37m[39;49;00m$
  1087	[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mkind[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m))[37m[39;49;00m$
  1088	[37m              [39;49;00m([36mdolist[39;49;00m[37m [39;49;00m([31mx[39;49;00m[37m [39;49;00m([36mrest[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1089	[37m                [39;49;00m([34msetq[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msequence-type-intersection[39;49;00m[37m [39;49;00m[31mkind[39;49;00m[37m [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m[31mx[39;49;00m))))[37m[39;49;00m$
  1090	[37m              [39;49;00m[31mkind[39;49;00m))[37m[39;49;00m$
  1091	[37m           [39;49;00m(([31mSIMPLE-BIT-VECTOR[39;49;00m[37m [39;49;00m[31mBIT-VECTOR[39;49;00m)[37m [39;49;00m[37m; (SIMPLE-BIT-VECTOR &optional size)[39;49;00m[37m[39;49;00m$
  1092	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1093	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1094	[37m            [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m$
  1095	[37m           [39;49;00m(([31mSIMPLE-STRING[39;49;00m[37m [39;49;00m[31mSTRING[39;49;00m[37m [39;49;00m[31mSIMPLE-BASE-STRING[39;49;00m[37m [39;49;00m[31mBASE-STRING[39;49;00m)[37m [39;49;00m[37m; (SIMPLE-STRING &optional size)[39;49;00m[37m[39;49;00m$
  1096	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1097	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1098	[37m            [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m$
  1099	[37m           [39;49;00m([31mSIMPLE-VECTOR[39;49;00m[37m [39;49;00m[37m; (SIMPLE-VECTOR &optional size)[39;49;00m[37m[39;49;00m$
  1100	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1101	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1102	[37m            [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1103	[37m           [39;49;00m(([31mVECTOR[39;49;00m[37m [39;49;00m[31mARRAY[39;49;00m[37m [39;49;00m[31mSIMPLE-ARRAY[39;49;00m)[37m [39;49;00m[37m; (VECTOR &optional el-type size), (ARRAY &optional el-type dimensions)[39;49;00m[37m[39;49;00m$
  1104	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcdddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1105	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1106	[37m            [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31mel-type[39;49;00m[37m [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mcdr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'*[39;49;00m)))[37m[39;49;00m$
  1107	[37m              [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m[37m [39;49;00m[33m'*[39;49;00m)[37m[39;49;00m$
  1108	[37m                [39;49;00m[33m'VECTOR[39;49;00m[37m[39;49;00m$
  1109	[37m                [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31meltype[39;49;00m[37m [39;49;00m([36mupgraded-array-element-type[39;49;00m[37m [39;49;00m[31mel-type[39;49;00m)))[37m[39;49;00m$
  1110	[37m                  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1111	[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m$
  1112	[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'BIT[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m$
  1113	[37m                        [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m[33m'UNSIGNED-BYTE[39;49;00m))[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31meltype[39;49;00m))[37m[39;49;00m$
  1114	[37m                        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m$
  1115	[37m                        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S is not up-to-date with ~S for element type ~S"[39;49;00m)[37m[39;49;00m$
  1116	[37m                                  [39;49;00m[33m'subtypep-sequence[39;49;00m[37m [39;49;00m[33m'upgraded-array-element-type[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)))))))[37m[39;49;00m$
  1117	[37m           [39;49;00m(([31mCONS[39;49;00m)[37m [39;49;00m[37m; (CONS &optional cartype cdrtype)[39;49;00m[37m[39;49;00m$
  1118	[37m            [39;49;00m([36mwhen[39;49;00m[37m [39;49;00m([36mcdddr[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1119	[37m              [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'subtypep[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1120	[37m            [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m$
  1121	[37m           [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m$
  1122	[37m        [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1123	[37m         [39;49;00m([34mif[39;49;00m[37m [39;49;00m([36mand[39;49;00m[37m [39;49;00m([31mclos::built-in-class-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1124	[37m                  [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m [39;49;00m[33m'CLOS::CLOSCLASS[39;49;00m)[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1125	[37m           [39;49;00m([31msubtype-sequence[39;49;00m[37m [39;49;00m([31mclos:class-name[39;49;00m[37m [39;49;00m[34mtype[39;49;00m))[37m[39;49;00m$
  1126	[37m           [39;49;00m[33m'NIL[39;49;00m))[37m[39;49;00m$
  1127	[37m        [39;49;00m(([31mclos::eql-specializer-p[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)[37m[39;49;00m$
  1128	[37m         [39;49;00m([31mtype-of-sequence[39;49;00m[37m [39;49;00m([31mclos::eql-specializer-singleton[39;49;00m[37m [39;49;00m[34mtype[39;49;00m)))[37m[39;49;00m$
  1129	[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m$
  1130	([36mdefun[39;49;00m[37m [39;49;00m[31mtype-of-sequence[39;49;00m[37m [39;49;00m([31mx[39;49;00m)[37m[39;49;00m$
  1131	[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mlistp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m [39;49;00m[33m'LIST[39;49;00m)[37m[39;49;00m$
  1132	[37m        [39;49;00m(([36mvectorp[39;49;00m[37m [39;49;00m[31mx[39;49;00m)[37m[39;49;00m$
  1133	[37m         [39;49;00m([34mlet[39;49;00m[37m [39;49;00m(([31meltype[39;49;00m[37m [39;49;00m([36marray-element-type[39;49;00m[37m [39;49;00m[31mx[39;49;00m)))[37m[39;49;00m$
  1134	[37m           [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'T[39;49;00m)[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1135	[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'CHARACTER[39;49;00m)[37m [39;49;00m[33m'STRING[39;49;00m)[37m[39;49;00m$
  1136	[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'BIT[39;49;00m)[37m [39;49;00m[33m'1[39;49;00m)[37m[39;49;00m$
  1137	[37m                 [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)[37m [39;49;00m[33m'UNSIGNED-BYTE[39;49;00m))[37m [39;49;00m([36msecond[39;49;00m[37m [39;49;00m[31meltype[39;49;00m))[37m[39;49;00m$
  1138	[37m                 [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31meltype[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m$
  1139	[37m                 [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36merror[39;49;00m[37m [39;49;00m([31mTEXT[39;49;00m[37m [39;49;00m[33m"~S is not up-to-date with ~S for element type ~S"[39;49;00m)[37m[39;49;00m$
  1140	[37m                           [39;49;00m[33m'type-of-sequence[39;49;00m[37m [39;49;00m[33m'array-element-type[39;49;00m[37m [39;49;00m[31meltype[39;49;00m)))))[37m[39;49;00m$
  1141	[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)))[37m[39;49;00m$
  1142	([36mdefun[39;49;00m[37m [39;49;00m[31msequence-type-union[39;49;00m[37m [39;49;00m([31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1143	[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m[37m; Simple general rules.[39;49;00m[37m[39;49;00m$
  1144	[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1145	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1146	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1147	[37m        [39;49;00m[37m; Now the union of two different types.[39;49;00m[37m[39;49;00m$
  1148	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m))[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m$
  1149	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m))[37m[39;49;00m$
  1150	[37m         [39;49;00m[37m; union of LIST and a vector type[39;49;00m[37m[39;49;00m$
  1151	[37m         [39;49;00m[33m'SEQUENCE[39;49;00m)[37m[39;49;00m$
  1152	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m))[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1153	[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1154	[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1155	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m))[37m[39;49;00m$
  1156	[37m         [39;49;00m[37m; union of STRING and an integer-vector type[39;49;00m[37m[39;49;00m$
  1157	[37m         [39;49;00m[33m'VECTOR[39;49;00m)[37m[39;49;00m$
  1158	[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mmax[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m))))[37m[39;49;00m$
  1159	([36mdefun[39;49;00m[37m [39;49;00m[31msequence-type-intersection[39;49;00m[37m [39;49;00m([31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1160	[37m  [39;49;00m([36mcond[39;49;00m[37m [39;49;00m[37m; Simple general rules.[39;49;00m[37m[39;49;00m$
  1161	[37m        [39;49;00m(([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1162	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'NIL[39;49;00m))[37m [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m$
  1163	[37m        [39;49;00m[37m; Now the intersection of two different types.[39;49;00m[37m[39;49;00m$
  1164	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1165	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'SEQUENCE[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1166	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'LIST[39;49;00m))[37m[39;49;00m$
  1167	[37m         [39;49;00m[37m; intersection of LIST and a vector type[39;49;00m[37m[39;49;00m$
  1168	[37m         [39;49;00m[33m'NIL[39;49;00m)[37m[39;49;00m$
  1169	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m[31mt2[39;49;00m)[37m[39;49;00m$
  1170	[37m        [39;49;00m(([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'VECTOR[39;49;00m)[37m [39;49;00m[31mt1[39;49;00m)[37m[39;49;00m$
  1171	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[34m0[39;49;00m)[37m [39;49;00m([36meql[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[34m0[39;49;00m))[37m [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m$
  1172	[37m        [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m)[37m [39;49;00m([36meq[39;49;00m[37m [39;49;00m[31mt2[39;49;00m[37m [39;49;00m[33m'STRING[39;49;00m))[37m[39;49;00m$
  1173	[37m         [39;49;00m[37m; intersection of STRING and an integer-vector type[39;49;00m[37m[39;49;00m$
  1174	[37m         [39;49;00m[33m'0[39;49;00m)[37m[39;49;00m$
  1175	[37m        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mmin[39;49;00m[37m [39;49;00m[31mt1[39;49;00m[37m [39;49;00m[31mt2[39;49;00m))))[37m[39;49;00m$
  1176	[37m[39;49;00m$
  1177	[37m;; ============================================================================[39;49;00m[37m[39;49;00m$
  1178	[37m[39;49;00m$
  1179	([36mdefun[39;49;00m[37m [39;49;00m[31mtype-expand[39;49;00m[37m [39;49;00m([31mtypespec[39;49;00m[37m [39;49;00m[34m&optional[39;49;00m[37m [39;49;00m[31monce-p[39;49;00m)[37m[39;49;00m$
  1180	[37m  [39;49;00m([36mmultiple-value-bind[39;49;00m[37m [39;49;00m([31mexpanded[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m)[37m[39;49;00m$
  1181	[37m      [39;49;00m([31mexpand-deftype[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31monce-p[39;49;00m)[37m[39;49;00m$
  1182	[37m    [39;49;00m([34mif[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mexpanded[39;49;00m[37m [39;49;00m[31muser-defined-p[39;49;00m)[37m[39;49;00m$
  1183	[37m      [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36msymbolp[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m[39;49;00m$
  1184	[37m             [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'TYPE-SYMBOL[39;49;00m)[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'TYPE-LIST[39;49;00m))[37m[39;49;00m$
  1185	[37m                    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
  1186	[37m                   [39;49;00m(([36mor[39;49;00m[37m [39;49;00m([36mget[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[33m'DEFSTRUCT-DESCRIPTION[39;49;00m)[37m[39;49;00m$
  1187	[37m                        [39;49;00m([31mclos-class[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))[37m[39;49;00m$
  1188	[37m                    [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
  1189	[37m                   [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))[37m[39;49;00m$
  1190	[37m            [39;49;00m(([36mand[39;49;00m[37m [39;49;00m([36mconsp[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m([36msymbolp[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)))[37m[39;49;00m$
  1191	[37m             [39;49;00m([36mcase[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m[39;49;00m$
  1192	[37m               [39;49;00m(([31mSATISFIES[39;49;00m[37m [39;49;00m[31mMEMBER[39;49;00m[37m [39;49;00m[31mEQL[39;49;00m[37m [39;49;00m[31mNOT[39;49;00m[37m [39;49;00m[31mAND[39;49;00m[37m [39;49;00m[31mOR[39;49;00m)[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
  1193	[37m               [39;49;00m([31mt[39;49;00m[37m [39;49;00m([36mcond[39;49;00m[37m [39;49;00m(([36mget[39;49;00m[37m [39;49;00m([36mfirst[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m[33m'TYPE-LIST[39;49;00m)[37m[39;49;00m$
  1194	[37m                         [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
  1195	[37m                        [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))))[37m[39;49;00m$
  1196	[37m            [39;49;00m(([31mclos::defined-class-p[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m)[37m [39;49;00m([36mvalues[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m[37m [39;49;00m[31mnil[39;49;00m))[37m[39;49;00m$
  1197	[37m            [39;49;00m([31mt[39;49;00m[37m [39;49;00m([31mtypespec-error[39;49;00m[37m [39;49;00m[33m'type-expand[39;49;00m[37m [39;49;00m[31mtypespec[39;49;00m))))))[37m[39;49;00m$
  1198	[37m[39;49;00m$
  1199	[37m;; ============================================================================[39;49;00m[37m[39;49;00m$
  1200	[37m[39;49;00m$
  1201	([36munless[39;49;00m[37m [39;49;00m([31mclos::funcallable-instance-p[39;49;00m[37m [39;49;00m[32m#'[39;49;00m[31mclos::class-name[39;49;00m)[37m[39;49;00m$
  1202	[37m  [39;49;00m([36mfmakunbound[39;49;00m[37m [39;49;00m[33m'clos::class-name[39;49;00m))[37m[39;49;00m$
  1203	[37m[39;49;00m$
  1204	[37m[39;49;00m$
  1205	([36mkeywordp[39;49;00m[37m [39;49;00m[33m:junk[39;49;00m)[37m[39;49;00m$
  1206	[37m  [39;49;00m[31mT[39;49;00m[37m[39;49;00m$
  1207	[37m[39;49;00m$
  1208	([36mkeywordp[39;49;00m[37m [39;49;00m[33m::junk[39;49;00m)[37m[39;49;00m$
  1209	[37m  [39;49;00m[31mT[39;49;00m[37m[39;49;00m$
  1210	[37m[39;49;00m$
  1211	([36msymbol-name[39;49;00m[37m [39;49;00m[33m::junk[39;49;00m)[37m[39;49;00m$
  1212	[37m  [39;49;00m[33m"JUNK"[39;49;00m[37m[39;49;00m$
  1213	[37m[39;49;00m$
  1214	([36msymbol-name[39;49;00m[37m [39;49;00m[33m:#junk[39;49;00m)[37m[39;49;00m$
  1215	[37m  [39;49;00m[33m"#JUNK"[39;49;00m[37m[39;49;00m$
  1216	[37m[39;49;00m$
  1217	([36msymbol-name[39;49;00m[37m [39;49;00m[33m:#.junk[39;49;00m)[37m[39;49;00m$
  1218	[37m  [39;49;00m[33m"#.JUNK"[39;49;00m$
